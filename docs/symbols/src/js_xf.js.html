<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="WHIT">	</span><span class="COMM">/* jQuery hooks */</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_oldhide</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$.fn.hide</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="WHIT">	</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="WHIT">	</span><span class="NAME">$.fn.hide</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">speed</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_oldhide.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="STRN">'hide'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_oldshow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$.fn.show</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 14</span> </span><span class="WHIT">	</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="WHIT">	</span><span class="NAME">$.fn.show</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">speed</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_oldshow.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="STRN">'show'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_oldhtml</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$.fn.html</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="WHIT">	</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="WHIT">	</span><span class="NAME">$.fn.html</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 24</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_oldhtml.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 25</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="STRN">'show'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 26</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="STRN">'html'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 27</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_oldappend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$.fn.append</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="WHIT">	</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="WHIT">	</span><span class="NAME">$.fn.append</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_oldappend.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="STRN">'append'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_oldprepend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$.fn.prepend</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 39</span> </span><span class="WHIT">	</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'> 40</span> </span><span class="WHIT">	</span><span class="NAME">$.fn.prepend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 41</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_oldprepend.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 42</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="STRN">'prepend'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 44</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_olddetach</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$.fn.detach</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 47</span> </span><span class="WHIT">	</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'> 48</span> </span><span class="WHIT">	</span><span class="NAME">$.fn.detach</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_olddetach.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="WHIT">		</span><span class="NAME">parent.trigger</span><span class="PUNC">(</span><span class="STRN">'detach'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 52</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 53</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 54</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 55</span> </span><span class="WHIT">	</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'> 56</span> </span><span class="WHIT">	</span><span class="NAME">$.fn.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 57</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="WHIT">		</span><span class="NAME">outerHtml</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">replacement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'> 60</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">replacement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 61</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 62</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replaceWith</span><span class="PUNC">(</span><span class="NAME">replacement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 63</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 64</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 65</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'> 66</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tmp_node</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">markup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tmp_node.html</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="WHIT">			</span><span class="NAME">tmp_node.remove</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">markup</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 71</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 72</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'> 77</span> 		@namespace Holds visible functionality of the framework
<span class='line'> 78</span> 	*/</span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 79</span> </span><span class="WHIT">	</span><span class="NAME">XF</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.XF</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.XF</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 80</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 81</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 82</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'> 83</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 84</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 85</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'> 86</span> 		@function
<span class='line'> 87</span> 		@public
<span class='line'> 88</span> 		@param {Object} options
<span class='line'> 89</span> 		@param {Object} options.settings User-defined settings which would override {@link XF.Settings}
<span class='line'> 90</span> 		@param {Object} options.router Options required for {@link XF.Router}
<span class='line'> 91</span> 		@param {Object} options.router.routes list of routes for {@link XF.Router}
<span class='line'> 92</span> 		@param {Object} options.router.handlers list of route handlers for {@link XF.Router}
<span class='line'> 93</span> 		@description Launches the app with specified options
<span class='line'> 94</span> 	*/</span><span class="WHIT">
<span class='line'> 95</span> </span><span class="WHIT">	</span><span class="NAME">XF.start</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 96</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 97</span> </span><span class="WHIT">		</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 98</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="WHIT">		</span><span class="COMM">// Creating static singletones</span><span class="WHIT">
<span class='line'>100</span> </span><span class="WHIT">		</span><span class="NAME">XF.Settings</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.SettingsClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>101</span> </span><span class="WHIT">		</span><span class="NAME">XF.Cache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.CacheClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>102</span> </span><span class="WHIT">		</span><span class="NAME">XF.Controller</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.ControllerClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>103</span> </span><span class="WHIT">		</span><span class="NAME">XF.Device</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.DeviceClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>104</span> </span><span class="WHIT">		</span><span class="NAME">XF.PageSwitcher</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.PageSwitcherClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>105</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>106</span> </span><span class="WHIT">		</span><span class="COMM">// options.settings</span><span class="WHIT">
<span class='line'>107</span> </span><span class="WHIT">		</span><span class="NAME">XF.Settings.bulkSet</span><span class="PUNC">(</span><span class="NAME">options.settings</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>108</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>109</span> </span><span class="WHIT">		</span><span class="COMM">// initializing XF.Cache</span><span class="WHIT">
<span class='line'>110</span> </span><span class="WHIT">		</span><span class="NAME">XF.Cache.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>111</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>112</span> </span><span class="WHIT">		</span><span class="COMM">// initializing XF.Device</span><span class="WHIT">
<span class='line'>113</span> </span><span class="WHIT">		</span><span class="NAME">options.device</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">options.device</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>114</span> </span><span class="WHIT">		</span><span class="NAME">XF.Device.init</span><span class="PUNC">(</span><span class="NAME">options.device.types</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>115</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>116</span> </span><span class="WHIT">		</span><span class="COMM">// options.router</span><span class="WHIT">
<span class='line'>117</span> </span><span class="WHIT">		</span><span class="NAME">options.router</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">options.router</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>118</span> </span><span class="WHIT">		</span><span class="NAME">createRouter</span><span class="PUNC">(</span><span class="NAME">options.router.routes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options.router.handlers</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>119</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>120</span> </span><span class="WHIT">		</span><span class="NAME">placeAnchorHooks</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>121</span> </span><span class="WHIT">		</span><span class="NAME">bindHideShowListeners</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>122</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>123</span> </span><span class="WHIT">		</span><span class="COMM">// options.root</span><span class="WHIT">
<span class='line'>124</span> </span><span class="WHIT">		</span><span class="NAME">rootDOMObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">options.root</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>125</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">rootDOMObject</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>126</span> </span><span class="WHIT">			</span><span class="NAME">rootDOMObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'body'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>127</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>128</span> </span><span class="WHIT">		</span><span class="NAME">loadChildComponents</span><span class="PUNC">(</span><span class="NAME">rootDOMObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>129</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>130</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>131</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>132</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>133</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>134</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>135</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>136</span> 		The self-propagating extend function that XF classes use.
<span class='line'>137</span> 		@memberOf XF
<span class='line'>138</span> 		@private
<span class='line'>139</span> 		@param {Object} protoProps Prototype extending properties
<span class='line'>140</span> 		@param {Object} staticProps Static extending properties
<span class='line'>141</span> 	*/</span><span class="WHIT">
<span class='line'>142</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">protoProps</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">classProps</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>143</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">inherits</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">protoProps</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">classProps</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>144</span> </span><span class="WHIT">		</span><span class="NAME">child.extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.extend</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>145</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">child</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>146</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>147</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>148</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>149</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>150</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>151</span> 		Helper function to correctly set up the prototype chain, for subclasses. Similar to 'goog.inherits', but uses a hash of prototype properties and class properties to be extended.
<span class='line'>152</span> 		@memberOf XF
<span class='line'>153</span> 		@private
<span class='line'>154</span> 		@param {Object} parent Class to be extended
<span class='line'>155</span> 		@param {Object} protoProps Prototype extending properties
<span class='line'>156</span> 		@param {Object} staticProps Static extending properties
<span class='line'>157</span> 	*/</span><span class="WHIT">
<span class='line'>158</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">inherits</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">protoProps</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">staticProps</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>159</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">child</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>160</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">protoProps</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">protoProps.hasOwnProperty</span><span class="PUNC">(</span><span class="STRN">'constructor'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>161</span> </span><span class="WHIT">			</span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">protoProps.constructor</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>162</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>163</span> </span><span class="WHIT">			</span><span class="NAME">child</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>164</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>165</span> </span><span class="WHIT">		</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>166</span> </span><span class="WHIT">		</span><span class="NAME">ctor.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>167</span> </span><span class="WHIT">		</span><span class="NAME">child.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ctor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>168</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">protoProps</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">child.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">protoProps</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>169</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">staticProps</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">staticProps</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>170</span> </span><span class="WHIT">		</span><span class="NAME">child.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">child</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>171</span> </span><span class="WHIT">		</span><span class="NAME">child.__super__</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>172</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>173</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">child</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>174</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>175</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>176</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>177</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>178</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>179</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>180</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>181</span> 		@namespace Holds all the reusable util functions
<span class='line'>182</span> 	*/</span><span class="WHIT">
<span class='line'>183</span> </span><span class="WHIT">	</span><span class="NAME">XF.Utils</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>184</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>185</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>186</span> 		@namespace Holds all the reusable util functions related to Adress Bar
<span class='line'>187</span> 	*/</span><span class="WHIT">
<span class='line'>188</span> </span><span class="WHIT">	</span><span class="NAME">XF.Utils.AddressBar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>189</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>190</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.Utils.AddressBar</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.Utils.AddressBar */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>191</span> </span><span class="WHIT">		</span><span class="NAME">isMobile</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>192</span> 
<span class='line'>193</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>194</span> 			Saves scroll value in order to not re-calibrate everytime we call the hide url bar
<span class='line'>195</span> 			@type Boolean
<span class='line'>196</span> 			@private
<span class='line'>197</span> 		*/</span><span class="WHIT">
<span class='line'>198</span> </span><span class="WHIT">		</span><span class="NAME">BODY_SCROLL_TOP</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>199</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>200</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>201</span> 			Calculates current scroll value
<span class='line'>202</span> 			@return Number
<span class='line'>203</span> 			@private
<span class='line'>204</span> 		*/</span><span class="WHIT">
<span class='line'>205</span> </span><span class="WHIT">		</span><span class="NAME">getScrollTop</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>206</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">win</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>207</span> </span><span class="WHIT">			</span><span class="NAME">doc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>208</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>209</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">win.pageYOffset</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">doc.compatMode</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'CSS1Compat'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">doc.documentElement.scrollTop</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">doc.body.scrollTop</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>210</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>211</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>212</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>213</span> 			Hides adress bar
<span class='line'>214</span> 		*/</span><span class="WHIT">
<span class='line'>215</span> </span><span class="WHIT">		</span><span class="NAME">hide</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>216</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF :: Utils :: AddressBar :: hide'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>217</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">win</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>218</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>219</span> </span><span class="WHIT">			</span><span class="COMM">// if there is a hash, or XF.Utils.AddressBar.BODY_SCROLL_TOP hasn't been set yet, wait till that happens</span><span class="WHIT">
<span class='line'>220</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">location.hash</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">XF.Utils.AddressBar.BODY_SCROLL_TOP</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>221</span> </span><span class="WHIT">				</span><span class="NAME">win.scrollTo</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Utils.AddressBar.BODY_SCROLL_TOP</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>222</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>223</span> 
<span class='line'>224</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>225</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isMobile</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>226</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">css</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.documentElement.style</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>227</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>228</span> </span><span class="WHIT">				</span><span class="NAME">css.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'200%'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>229</span> </span><span class="WHIT">				</span><span class="NAME">css.overflow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'visible'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>230</span> 
<span class='line'>231</span> </span><span class="WHIT">				</span><span class="NAME">window.scrollTo</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>232</span> 
<span class='line'>233</span> </span><span class="WHIT">				</span><span class="NAME">css.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.innerHeight</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>234</span> 
<span class='line'>235</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>236</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>237</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>238</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>239</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>240</span> 			Hides adress bar on page load
<span class='line'>241</span> 		*/</span><span class="WHIT">
<span class='line'>242</span> </span><span class="WHIT">		</span><span class="NAME">hideOnLoad</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>243</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF :: Utils :: AddressBar :: hideOnLoad'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>244</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">win</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>245</span> </span><span class="WHIT">			</span><span class="NAME">doc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">win.document</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>246</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>247</span> </span><span class="WHIT">			</span><span class="COMM">// If there's a hash, or addEventListener is undefined, stop here</span><span class="WHIT">
<span class='line'>248</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">location.hash</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">win.addEventListener</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>250</span> </span><span class="WHIT">				</span><span class="COMM">//scroll to 1</span><span class="WHIT">
<span class='line'>251</span> </span><span class="WHIT">				</span><span class="NAME">window.scrollTo</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>252</span> </span><span class="WHIT">				</span><span class="NAME">XF.Utils.AddressBar.BODY_SCROLL_TOP</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>253</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>254</span> </span><span class="WHIT">				</span><span class="COMM">//reset to 0 on bodyready, if needed</span><span class="WHIT">
<span class='line'>255</span> </span><span class="WHIT">				</span><span class="NAME">bodycheck</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">setInterval</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>256</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">doc.body</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>257</span> </span><span class="WHIT">						</span><span class="NAME">clearInterval</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">bodycheck</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>258</span> </span><span class="WHIT">						</span><span class="NAME">XF.Utils.AddressBar.BODY_SCROLL_TOP</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Utils.AddressBar.getScrollTop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>259</span> </span><span class="WHIT">						</span><span class="NAME">XF.Utils.AddressBar.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>260</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>261</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">15</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>262</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>263</span> </span><span class="WHIT">				</span><span class="NAME">win.addEventListener</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="STRN">'load'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>264</span> </span><span class="WHIT">					</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>265</span> </span><span class="WHIT">						</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">							</span><span class="COMM">//at load, if user hasn't scrolled more than 20 or so...</span><span class="WHIT">
<span class='line'>267</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">XF.Utils.AddressBar.getScrollTop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">20</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>268</span> </span><span class="WHIT">								</span><span class="COMM">//reset to hide addr bar at onload</span><span class="WHIT">
<span class='line'>269</span> </span><span class="WHIT">								</span><span class="NAME">XF.Utils.AddressBar.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>270</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>271</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>272</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>273</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>274</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>275</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>276</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>277</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>278</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>279</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>280</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>281</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>282</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>283</span> 		@namespace Holds all the logic related to UI elements enhancement
<span class='line'>284</span> 	*/</span><span class="WHIT">
<span class='line'>285</span> </span><span class="WHIT">	</span><span class="NAME">XF.UIElements</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>286</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>287</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.UIElements</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.UIElements */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>288</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>289</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>290</span> 			Reworks markup of a givven jQuery object
<span class='line'>291</span> 			@param jqObj jQuery item
<span class='line'>292</span> 		*/</span><span class="WHIT">
<span class='line'>293</span> </span><span class="WHIT">		</span><span class="NAME">enhanceView</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jqObj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>294</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>295</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">jqObj</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>296</span> </span><span class="WHIT">				</span><span class="NAME">jqObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">jqObj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>297</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">jqObj</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>298</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>299</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>300</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>301</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>302</span> </span><span class="WHIT">			</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.enhancementList</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">enhancement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">enhancementList</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">				</span><span class="NAME">jqObj.find</span><span class="PUNC">(</span><span class="NAME">enhancement.selector</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">not</span><span class="PUNC">(</span><span class="STRN">'[data-skip-enhance=true]'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">skip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> </span><span class="WHIT">					</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.enhanced.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">enhancementList</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>306</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.enhanced</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">							</span><span class="NAME">skip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>308</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>309</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>310</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">skip</span><span class="WHIT"> </span><span class="PUNC">&</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>311</span> </span><span class="WHIT">						</span><span class="NAME">XF.UIElements.enhanced.push</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>312</span> </span><span class="WHIT">						</span><span class="NAME">XF.UIElements</span><span class="PUNC">[</span><span class="NAME">enhancement.enhanceMethod</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>313</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>316</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>317</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>318</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>319</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>320</span> 			A list of all the enhancements that whould be done of every jQuery object givven
<span class='line'>321</span> 			@type Object
<span class='line'>322</span> 			@private
<span class='line'>323</span> 		*/</span><span class="WHIT">
<span class='line'>324</span> </span><span class="WHIT">		</span><span class="NAME">enhancementList</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>325</span> </span><span class="WHIT">			</span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>326</span> </span><span class="WHIT">				</span><span class="NAME">selector</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'A[data-role=button], BUTTON, INPUT[type=submit], INPUT[type=reset], INPUT[type=button] [data-appearance=backbtn]'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>327</span> </span><span class="WHIT">				</span><span class="NAME">enhanceMethod</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'enhanceButton'</span><span class="WHIT">
<span class='line'>328</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>329</span> </span><span class="WHIT">			</span><span class="NAME">textinput</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>330</span> </span><span class="WHIT">				</span><span class="NAME">selector</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'INPUT[type=text], INPUT[type=search], INPUT[type=tel], '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>331</span> </span><span class="WHIT">							</span><span class="STRN">'INPUT[type=url], INPUT[type=email], INPUT[type=password], INPUT[type=datetime], '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>332</span> </span><span class="WHIT">							</span><span class="STRN">'INPUT[type=date], INPUT[type=month], INPUT[type=week], INPUT[type=time], '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>333</span> </span><span class="WHIT">							</span><span class="STRN">'INPUT[type=datetime-local], INPUT[type=number], INPUT[type=color], TEXTAREA, '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>334</span> </span><span class="WHIT">							</span><span class="COMM">//</span><span class="WHIT">
<span class='line'>335</span> </span><span class="WHIT">							</span><span class="STRN">'INPUT[type=range], INPUT[type=search]'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>336</span> </span><span class="WHIT">				</span><span class="NAME">enhanceMethod</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'enhanceTextInput'</span><span class="WHIT">
<span class='line'>337</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>338</span> </span><span class="WHIT">			</span><span class="NAME">checkboxRadio</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>339</span> </span><span class="WHIT">				</span><span class="NAME">selector</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'INPUT[type=checkbox], INPUT[type=radio]'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>340</span> </span><span class="WHIT">				</span><span class="NAME">enhanceMethod</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'enhanceCheckboxRadio'</span><span class="WHIT">
<span class='line'>341</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>342</span> </span><span class="WHIT">			</span><span class="NAME">fieldset</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>343</span> </span><span class="WHIT">				</span><span class="NAME">selector</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'fieldset[data-role=controlgroup]'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>344</span> </span><span class="WHIT">				</span><span class="NAME">enhanceMethod</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'enhanceFieldset'</span><span class="WHIT">
<span class='line'>345</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>346</span> </span><span class="WHIT">			</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>347</span> </span><span class="WHIT">				</span><span class="NAME">selector</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'UL[data-role=listview], OL[data-role=listview]'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>348</span> </span><span class="WHIT">				</span><span class="NAME">enhanceMethod</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'enhanceList'</span><span class="WHIT">
<span class='line'>349</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>350</span> </span><span class="WHIT">			</span><span class="NAME">scrollable</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>351</span> </span><span class="WHIT">				</span><span class="NAME">selector</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'[data-scrollable=true]'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>352</span> </span><span class="WHIT">				</span><span class="NAME">enhanceMethod</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'enhanceScrollable'</span><span class="WHIT">
<span class='line'>353</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>354</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>355</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>356</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>357</span> 			A list of objects already enhanced (used to skip them while iterating through DOM)
<span class='line'>358</span> 			@type Array
<span class='line'>359</span> 			@private
<span class='line'>360</span> 		*/</span><span class="WHIT">
<span class='line'>361</span> </span><span class="WHIT">		</span><span class="NAME">enhanced</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>362</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>363</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>364</span> 			Make the DOM object look like a button
<span class='line'>365</span> 			@param button DOM Object
<span class='line'>366</span> 			@private
<span class='line'>367</span> 		*/</span><span class="WHIT">
<span class='line'>368</span> </span><span class="WHIT">		</span><span class="NAME">enhanceButton</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>369</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>370</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jQButton</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>371</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">jQButton</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>372</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>373</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>374</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>375</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>376</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>377</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>378</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>379</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">enhancedButton</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>380</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">innerStuff</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>381</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>382</span> </span><span class="WHIT">			</span><span class="COMM">// If it's A or BUTTON, the necessary classes are added to the element itself</span><span class="WHIT">
<span class='line'>383</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">button.nodeName</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'A'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">button.nodeName</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'BUTTON'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>384</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>385</span> </span><span class="WHIT">				</span><span class="NAME">innerStuff</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQButton.html</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>386</span> </span><span class="WHIT">				</span><span class="NAME">jQButton.html</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>387</span> </span><span class="WHIT">			</span><span class="COMM">// If it's INPUT - it's wrapped in a DIV and the necessary classes are added to the DIV.</span><span class="WHIT">
<span class='line'>388</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">button.nodeName</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'INPUT'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>389</span> </span><span class="WHIT">				</span><span class="COMM">// The input is assigned a class xf-input-hidden</span><span class="WHIT">
<span class='line'>390</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">jQButton.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-hidden'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>391</span> </span><span class="WHIT">				</span><span class="NAME">jQButton.outerHtml</span><span class="PUNC">(</span><span class="NAME">enhancedButton</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>392</span> </span><span class="WHIT">				</span><span class="NAME">innerStuff</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'value'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>393</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>394</span> </span><span class="WHIT">				</span><span class="COMM">// how did U get there? o_O</span><span class="WHIT">
<span class='line'>395</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>396</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>397</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>398</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isSmall</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-small'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-appearance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'backbtn'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>399</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>400</span> </span><span class="WHIT">			</span><span class="COMM">// The class xf-button is added to the button.</span><span class="WHIT">
<span class='line'>401</span> </span><span class="WHIT">			</span><span class="COMM">// If it has data-small="true" attribute, the class should be xf-button-small.</span><span class="WHIT">
<span class='line'>402</span> </span><span class="WHIT">			</span><span class="NAME">enhancedButton.addClass</span><span class="PUNC">(</span><span class="NAME">isSmall</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'xf-button-small'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'xf-button'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>403</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>404</span> </span><span class="WHIT">			</span><span class="COMM">// If data-appearance="backbtn" attribute is present, xf-button-back class is also added.</span><span class="WHIT">
<span class='line'>405</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-appearance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'backbtn'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-button-back'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>407</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>408</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>409</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">iconName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-icon'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>410</span> 
<span class='line'>411</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-appearance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'backbtn'</span><span class="WHIT"> </span><span class="COMM">/*&& !jQButton.attr('data-icon')*/</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>412</span> </span><span class="WHIT">                </span><span class="NAME">iconName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'left'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>413</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>414</span> 
<span class='line'>415</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">iconName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>416</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>417</span> </span><span class="WHIT">				</span><span class="COMM">// If data-icon attribute is present, a SPAN.xf-icon is added inside the button.</span><span class="WHIT">
<span class='line'>418</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">iconSpan</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;span class=xf-icon>&lt;/span>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>419</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>420</span> </span><span class="WHIT">				</span><span class="COMM">// The value of data-icon attribute is used to generate icon class: e.g. xf-icon-dots.</span><span class="WHIT">
<span class='line'>421</span> </span><span class="WHIT">				</span><span class="NAME">iconSpan.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-icon-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">iconName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>422</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>423</span> </span><span class="WHIT">				</span><span class="COMM">// If the button had data-small=true or data-appearance="backbtn" attributes,</span><span class="WHIT">
<span class='line'>424</span> </span><span class="WHIT">				</span><span class="COMM">// xf-icon-small class is also added to SPAN.xf-icon</span><span class="WHIT">
<span class='line'>425</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isSmall</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>426</span> </span><span class="WHIT">					</span><span class="NAME">iconSpan.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-icon-small'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>427</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>428</span> </span><span class="WHIT">					</span><span class="NAME">iconSpan.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-icon-big'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>429</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>430</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>431</span> </span><span class="WHIT">				</span><span class="COMM">// A class denoting icon position is also added to the button. Default: xf-iconpos-left.</span><span class="WHIT">
<span class='line'>432</span> </span><span class="WHIT">				</span><span class="COMM">// The value is taken from data-iconpos attr.</span><span class="WHIT">
<span class='line'>433</span> </span><span class="WHIT">				</span><span class="COMM">// Possible values: left, right, top, bottom.</span><span class="WHIT">
<span class='line'>434</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-iconpos'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'left'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>435</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'left'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'right'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'top'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'bottom'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>436</span> </span><span class="WHIT">					</span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'left'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>437</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>438</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-iconpos-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">iconPos</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>439</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton.append</span><span class="PUNC">(</span><span class="NAME">iconSpan</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>440</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>441</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>442</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>443</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">innerStuff</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>444</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">textSpan</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;span>&lt;/span>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">innerStuff</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>445</span> </span><span class="WHIT">				</span><span class="COMM">// The text of buttons is placed inside span.xf-button-small-text for small buttons</span><span class="WHIT">
<span class='line'>446</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isSmall</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-appearance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'backbtn'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>447</span> </span><span class="WHIT">					</span><span class="NAME">textSpan.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-button-small-text'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>448</span> </span><span class="WHIT">				</span><span class="COMM">// and span.xf-button-text for big ones.</span><span class="WHIT">
<span class='line'>449</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>450</span> </span><span class="WHIT">					</span><span class="NAME">textSpan.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-button-text'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>451</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>452</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton.append</span><span class="PUNC">(</span><span class="NAME">textSpan</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>453</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>454</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>455</span> </span><span class="WHIT">			</span><span class="COMM">// If data-special="true" attribute is present add xf-button-special class.</span><span class="WHIT">
<span class='line'>456</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-special'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>457</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-button-special'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>458</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>459</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-alert'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>460</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-button-alert'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>461</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>462</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>463</span> </span><span class="WHIT">			</span><span class="COMM">// If data-alert="true" attribute is present add xf-button-alert class.</span><span class="WHIT">
<span class='line'>464</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="STRN">'data-alert'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>465</span> </span><span class="WHIT">				</span><span class="NAME">enhancedButton.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-button-alert'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>466</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>467</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>468</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>469</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>470</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>471</span> 			Enhances text input view
<span class='line'>472</span> 			@param textInput DOM Object
<span class='line'>473</span> 			@private
<span class='line'>474</span> 		*/</span><span class="WHIT">
<span class='line'>475</span> </span><span class="WHIT">		</span><span class="NAME">enhanceTextInput</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">textInput</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>476</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>477</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jQTextInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">textInput</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>478</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">textInput</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">jQTextInput</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>479</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>480</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>481</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>482</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>483</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>484</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>485</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>486</span> </span><span class="WHIT">			</span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>487</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>488</span> </span><span class="WHIT">			</span><span class="COMM">// For inputs of types:</span><span class="WHIT">
<span class='line'>489</span> </span><span class="WHIT">			</span><span class="COMM">// 	text, search, tel, url, email, password, datetime, date, month,</span><span class="WHIT">
<span class='line'>490</span> </span><span class="WHIT">			</span><span class="COMM">// 	week, time, datetime-local, number, color and also for TEXTAREA element</span><span class="WHIT">
<span class='line'>491</span> </span><span class="WHIT">			</span><span class="COMM">// 	add class "xf-input-text".</span><span class="WHIT">
<span class='line'>492</span> </span><span class="WHIT">			</span><span class="NAME">jQTextInput.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-text'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>493</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>494</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isInputElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">textInput.nodeName</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'INPUT'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>495</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">textInputType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'type'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>496</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>497</span> </span><span class="WHIT">			</span><span class="COMM">// For inputs of types "range" and "search" change type to "text".</span><span class="WHIT">
<span class='line'>498</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textInputType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'search'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>499</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newTextInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;input type="text"/>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>500</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newTIAttrs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>501</span> </span><span class="WHIT">				</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">textInput.attributes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>502</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">attribute.name</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'type'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>503</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>504</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>505</span> </span><span class="WHIT">					</span><span class="NAME">newTIAttrs</span><span class="PUNC">[</span><span class="NAME">attribute.name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attribute.value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>506</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>507</span> </span><span class="WHIT">				</span><span class="NAME">newTextInput.attr</span><span class="PUNC">(</span><span class="NAME">newTIAttrs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>508</span> </span><span class="WHIT">				</span><span class="NAME">jQTextInput.outerHtml</span><span class="PUNC">(</span><span class="NAME">newTextInput</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>509</span> </span><span class="WHIT">				</span><span class="NAME">jQTextInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newTextInput</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>510</span> </span><span class="WHIT">				</span><span class="NAME">textInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newTextInput</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>511</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>512</span> </span><span class="WHIT">			</span><span class="COMM">/*
<span class='line'>513</span> 			&lt;div class="xf-input-number">
<span class='line'>514</span> 				&lt;button class="xf-input-number-control xf-input-number-control-decrease "
<span class='line'>515</span> 				        type="button">
<span class='line'>516</span> 					&lt;span class="xf-icon xf-icon-big xf-icon-minus-circled">&lt;/span>
<span class='line'>517</span> 				&lt;/button>
<span class='line'>518</span> 				&lt;input type="text" class="xf-input-text" min="0" max="1200" value="400">
<span class='line'>519</span> 				&lt;button class="xf-input-number-control xf-input-number-control-increase"
<span class='line'>520</span> 				        type="button">
<span class='line'>521</span> 					&lt;span class="xf-icon xf-icon-big xf-icon-plus-circled">&lt;/span>
<span class='line'>522</span> 				&lt;/button>
<span class='line'>523</span> 			&lt;/div>
<span class='line'>524</span> 			*/</span><span class="WHIT">
<span class='line'>525</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textInputType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">textInputType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'range'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>526</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>527</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'min'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>528</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'max'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>529</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'value'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>530</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">step</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'step'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>531</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>532</span> </span><span class="WHIT">				</span><span class="COMM">// For inputs of types "range" and "search" change type to "text".</span><span class="WHIT">
<span class='line'>533</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newTextInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;input type="text"/>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>534</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newTIAttrs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>535</span> </span><span class="WHIT">				</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">textInput.attributes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>536</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">attribute.name</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'type'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>537</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>538</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>539</span> </span><span class="WHIT">					</span><span class="NAME">newTIAttrs</span><span class="PUNC">[</span><span class="NAME">attribute.name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attribute.value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>540</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>541</span> </span><span class="WHIT">				</span><span class="NAME">newTextInput.attr</span><span class="PUNC">(</span><span class="NAME">newTIAttrs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>542</span> </span><span class="WHIT">				</span><span class="NAME">newTextInput.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>543</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>544</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">numberWrapper</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-number'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>545</span> </span><span class="WHIT">				</span><span class="NAME">numberWrapper.append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>546</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;button type="button">&lt;/button>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>547</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-number-control xf-input-number-control-decrease'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>548</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>549</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>550</span> </span><span class="WHIT">							</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;span>&lt;/span>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-icon xf-icon-big xf-icon-minus-circled'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>551</span> </span><span class="WHIT">						</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>552</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>553</span> </span><span class="WHIT">				</span><span class="NAME">numberWrapper.append</span><span class="PUNC">(</span><span class="NAME">newTextInput</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>554</span> </span><span class="WHIT">				</span><span class="NAME">numberWrapper.append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>555</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;button type="button">&lt;/button>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>556</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-number-control xf-input-number-control-increase'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>557</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>558</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>559</span> </span><span class="WHIT">							</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;span>&lt;/span>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-icon xf-icon-big xf-icon-plus-circled'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>560</span> </span><span class="WHIT">						</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>561</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>562</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>563</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rangeWrapper</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>564</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>565</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textInputType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>566</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>567</span> </span><span class="WHIT">					</span><span class="NAME">jQTextInput.outerHtml</span><span class="PUNC">(</span><span class="NAME">numberWrapper</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>568</span> </span><span class="WHIT">					</span><span class="NAME">jQTextInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">numberWrapper</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>569</span> </span><span class="WHIT">					</span><span class="NAME">textInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">numberWrapper</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>570</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>571</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textInputType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'range'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>572</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>573</span> </span><span class="WHIT">					</span><span class="COMM">/*
<span class='line'>574</span> 					&lt;div class="xf-input-range">
<span class='line'>575</span> 						&lt;div class="xf-range-wrap">
<span class='line'>576</span> 							&lt;div class="xf-input-range-min">0&lt;/div>
<span class='line'>577</span> 							&lt;div class="xf-input-range-slider">
<span class='line'>578</span> 								&lt;div class="xf-input-range-track">
<span class='line'>579</span> 									&lt;div class="xf-input-range-value" style="width: 30%">
<span class='line'>580</span> 										&lt;div class="xf-input-range-control" tabindex="0">
<span class='line'>581</span> 											&lt;div class="xf-input-range-thumb" title="400">&lt;/div>
<span class='line'>582</span> 										&lt;/div>
<span class='line'>583</span> 									&lt;/div>
<span class='line'>584</span> 								&lt;/div>
<span class='line'>585</span> 							&lt;/div>
<span class='line'>586</span> 							&lt;div class="xf-input-range-max">1200&lt;/div>
<span class='line'>587</span> 						&lt;/div>
<span class='line'>588</span> 					&lt;/div>
<span class='line'>589</span> 					*/</span><span class="WHIT">
<span class='line'>590</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>591</span> </span><span class="WHIT">					</span><span class="NAME">rangeWrapper</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-range'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>592</span> </span><span class="WHIT">					</span><span class="NAME">rangeWrapper.append</span><span class="PUNC">(</span><span class="NAME">numberWrapper</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>593</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>594</span> </span><span class="WHIT">					</span><span class="COMM">// If there is no either min or max attribute -- don't render the slider.</span><span class="WHIT">
<span class='line'>595</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">minValue</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>596</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>597</span> </span><span class="WHIT">						</span><span class="NAME">minValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>598</span> </span><span class="WHIT">						</span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">maxValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>599</span> </span><span class="WHIT">						</span><span class="WHIT">
<span class='line'>600</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">percValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">selValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>601</span> </span><span class="WHIT">						</span><span class="NAME">rangeWrapper.append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>602</span> </span><span class="WHIT">							</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>603</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-range'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>604</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>605</span> </span><span class="WHIT">									</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>606</span> </span><span class="WHIT">										</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-range-wrap'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>607</span> </span><span class="WHIT">										</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>608</span> </span><span class="WHIT">											</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>609</span> </span><span class="WHIT">												</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-range-min'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>610</span> </span><span class="WHIT">												</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>611</span> </span><span class="WHIT">										</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>612</span> </span><span class="WHIT">										</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>613</span> </span><span class="WHIT">											</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>614</span> </span><span class="WHIT">												</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-range-slider'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>615</span> </span><span class="WHIT">												</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>616</span> </span><span class="WHIT">													</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>617</span> </span><span class="WHIT">														</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-range-track'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>618</span> </span><span class="WHIT">														</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>619</span> </span><span class="WHIT">															</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>620</span> </span><span class="WHIT">																</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-range-value'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>621</span> </span><span class="WHIT">																</span><span class="PUNC">.</span><span class="NAME">css</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'width'</span><span class="PUNC">:</span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">percValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'%'</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>622</span> </span><span class="WHIT">																</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>623</span> </span><span class="WHIT">																	</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>624</span> </span><span class="WHIT">																		</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-range-control'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>625</span> </span><span class="WHIT">																		</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'tabindex'</span><span class="PUNC">:</span><span class="STRN">'0'</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>626</span> </span><span class="WHIT">																		</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>627</span> </span><span class="WHIT">																			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>628</span> </span><span class="WHIT">																				</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-range-thumb'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>629</span> </span><span class="WHIT">																				</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'title'</span><span class="PUNC">:</span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">selValue</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>630</span> </span><span class="WHIT">																				</span><span class="PUNC">.</span><span class="NAME">css</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'left'</span><span class="PUNC">:</span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'%'</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>631</span> </span><span class="WHIT">																		</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>632</span> </span><span class="WHIT">																</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>633</span> </span><span class="WHIT">														</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>634</span> </span><span class="WHIT">												</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>635</span> </span><span class="WHIT">										</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>636</span> </span><span class="WHIT">										</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>637</span> </span><span class="WHIT">											</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>638</span> </span><span class="WHIT">												</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-range-max'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>639</span> </span><span class="WHIT">												</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">maxValue</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>640</span> </span><span class="WHIT">										</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>641</span> </span><span class="WHIT">								</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>642</span> </span><span class="WHIT">						</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>643</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-slider'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>644</span> </span><span class="WHIT">						</span><span class="WHIT">
<span class='line'>645</span> </span><span class="WHIT">						</span><span class="NAME">jQTextInput.outerHtml</span><span class="PUNC">(</span><span class="NAME">rangeWrapper</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>646</span> </span><span class="WHIT">						</span><span class="NAME">jQTextInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rangeWrapper</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>647</span> </span><span class="WHIT">						</span><span class="NAME">textInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rangeWrapper</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>648</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>649</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>650</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>651</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>652</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">setNewValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">newValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>653</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>654</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">modulo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">%</span><span class="WHIT"> </span><span class="NAME">step</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>655</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">steppedVal</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">modulo</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>656</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">modulo</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">step</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>657</span> </span><span class="WHIT">						</span><span class="NAME">steppedVal</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">step</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>658</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>659</span> </span><span class="WHIT">					</span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">steppedVal</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>660</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>661</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">maxValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>662</span> </span><span class="WHIT">						</span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">maxValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>663</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>664</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>665</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">minValue</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>666</span> </span><span class="WHIT">						</span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>667</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>668</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>669</span> </span><span class="WHIT">					</span><span class="NAME">selValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>670</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>671</span> </span><span class="WHIT">					</span><span class="NAME">newTextInput.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'value'</span><span class="PUNC">:</span><span class="NAME">newValue</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>672</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>673</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">rangeWrapper</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>674</span> </span><span class="WHIT">						</span><span class="NAME">rangeWrapper.find</span><span class="PUNC">(</span><span class="STRN">'div.xf-input-range-thumb'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'title'</span><span class="PUNC">:</span><span class="NAME">newValue</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>675</span> </span><span class="WHIT">						</span><span class="WHIT">
<span class='line'>676</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">percValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>677</span> </span><span class="WHIT">						</span><span class="NAME">rangeWrapper.find</span><span class="PUNC">(</span><span class="STRN">'div.xf-input-range-value'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">css</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'width'</span><span class="PUNC">:</span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">percValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'%'</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>678</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>679</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>680</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>681</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>682</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">stepUp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>683</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">newTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'value'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>684</span> </span><span class="WHIT">					</span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">step</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>685</span> </span><span class="WHIT">					</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">newValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>686</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>687</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>688</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">stepDown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>689</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">newTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'value'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>690</span> </span><span class="WHIT">					</span><span class="NAME">newValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">step</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>691</span> </span><span class="WHIT">					</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">newValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>692</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>693</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>694</span> </span><span class="WHIT">				</span><span class="COMM">// initialing number stepper buttons (-) & (+) click handlers</span><span class="WHIT">
<span class='line'>695</span> </span><span class="WHIT">				</span><span class="NAME">numberWrapper.find</span><span class="PUNC">(</span><span class="STRN">'button.xf-input-number-control-decrease'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">click</span><span class="PUNC">(</span><span class="NAME">stepDown</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>696</span> </span><span class="WHIT">				</span><span class="NAME">numberWrapper.find</span><span class="PUNC">(</span><span class="STRN">'button.xf-input-number-control-increase'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">click</span><span class="PUNC">(</span><span class="NAME">stepUp</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>697</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>698</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">savedInputText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'value'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>699</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newInputText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>700</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">inputTextChange</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>701</span> </span><span class="WHIT">					</span><span class="NAME">newInputText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'value'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>702</span> </span><span class="WHIT">					</span><span class="COMM">// prevent multiple recalculations in case when several events where triggered</span><span class="WHIT">
<span class='line'>703</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">savedInputText</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">newInputText</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>704</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>705</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>706</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>707</span> </span><span class="WHIT">					</span><span class="NAME">newInputText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">newInputText</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>708</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">newInputText</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>709</span> </span><span class="WHIT">						</span><span class="NAME">newInputText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>710</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>711</span> </span><span class="WHIT">					</span><span class="NAME">savedInputText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newInputText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>712</span> </span><span class="WHIT">					</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">newInputText</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>713</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>714</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>715</span> </span><span class="WHIT">				</span><span class="NAME">newTextInput</span><span class="WHIT">
<span class='line'>716</span> </span><span class="WHIT">					</span><span class="PUNC">.</span><span class="NAME">change</span><span class="PUNC">(</span><span class="NAME">inputTextChange</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>717</span> </span><span class="WHIT">					</span><span class="COMM">//.keyup(inputTextChange)</span><span class="WHIT">
<span class='line'>718</span> </span><span class="WHIT">					</span><span class="COMM">//.keydown(inputTextChange)</span><span class="WHIT">
<span class='line'>719</span> </span><span class="WHIT">					</span><span class="PUNC">.</span><span class="NAME">focus</span><span class="PUNC">(</span><span class="NAME">inputTextChange</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>720</span> </span><span class="WHIT">					</span><span class="PUNC">.</span><span class="NAME">focusout</span><span class="PUNC">(</span><span class="NAME">inputTextChange</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>721</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>722</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">rangeWrapper</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>723</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>724</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">trackW</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>725</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">savedVal</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>726</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">valueDiff</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>727</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mousePrevX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>728</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mouseNewX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>729</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mouseDiff</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>730</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>731</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">trackDiffToValueDiff</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">trackDiff</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>732</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">trackW</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>733</span> </span><span class="WHIT">							 </span><span class="NAME">trackW</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rangeWrapper.find</span><span class="PUNC">(</span><span class="STRN">'div.xf-input-range-track'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clientWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>734</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>735</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">trackDiff</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">trackW</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">maxValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>736</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>737</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>738</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">trackPointToValuePoint</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">trackPoint</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>739</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">trackDiffToValueDiff</span><span class="PUNC">(</span><span class="NAME">trackPoint</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>740</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>741</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>742</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">startThumbDrag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>743</span> </span><span class="WHIT">						</span><span class="NAME">mousePrevX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.pageX</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">event.clientX</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">layerX</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">event.screenX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>744</span> </span><span class="WHIT">						</span><span class="NAME">savedVal</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">selValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>745</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">stopThumbDrag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>746</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">doThumbDrag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>747</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>748</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>749</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">doThumbDrag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>750</span> </span><span class="WHIT">						</span><span class="NAME">mouseNewX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.pageX</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">event.clientX</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">layerX</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">event.screenX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>751</span> </span><span class="WHIT">						</span><span class="NAME">mouseDiff</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mouseNewX</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">mousePrevX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>752</span> </span><span class="WHIT">						</span><span class="NAME">valueDiff</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">trackDiffToValueDiff</span><span class="PUNC">(</span><span class="NAME">mouseDiff</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>753</span> </span><span class="WHIT">						</span><span class="NAME">mousePrevX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mouseNewX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>754</span> </span><span class="WHIT">						</span><span class="NAME">savedVal</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">valueDiff</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>755</span> </span><span class="WHIT">						</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">savedVal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>756</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>757</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>758</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">stopThumbDrag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>759</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">unbind</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">stopThumbDrag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>760</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">unbind</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">doThumbDrag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>761</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>762</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>763</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">startThumbPress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>764</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'keydown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">doThumbPress</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>765</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>766</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>767</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">doThumbPress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>768</span> </span><span class="WHIT">						</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">event.keyCode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>769</span> </span><span class="WHIT">							</span><span class="COMM">// PG Up</span><span class="WHIT">
<span class='line'>770</span> </span><span class="WHIT">							</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">33</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>771</span> </span><span class="WHIT">								</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">selValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">step</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>772</span> </span><span class="WHIT">								</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>773</span> </span><span class="WHIT">							</span><span class="COMM">// PG Down</span><span class="WHIT">
<span class='line'>774</span> </span><span class="WHIT">							</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">34</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>775</span> </span><span class="WHIT">								</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">selValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">step</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>776</span> </span><span class="WHIT">								</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>777</span> </span><span class="WHIT">							</span><span class="COMM">// End</span><span class="WHIT">
<span class='line'>778</span> </span><span class="WHIT">							</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">35</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>779</span> </span><span class="WHIT">								</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">maxValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>780</span> </span><span class="WHIT">								</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>781</span> </span><span class="WHIT">							</span><span class="COMM">// Home</span><span class="WHIT">
<span class='line'>782</span> </span><span class="WHIT">							</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">36</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>783</span> </span><span class="WHIT">								</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">minValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>784</span> </span><span class="WHIT">								</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>785</span> </span><span class="WHIT">							</span><span class="COMM">// arrow up</span><span class="WHIT">
<span class='line'>786</span> </span><span class="WHIT">							</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">38</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>787</span> </span><span class="WHIT">							</span><span class="COMM">// arrow right</span><span class="WHIT">
<span class='line'>788</span> </span><span class="WHIT">							</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">39</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>789</span> </span><span class="WHIT">								</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">selValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">step</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>790</span> </span><span class="WHIT">								</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>791</span> </span><span class="WHIT">							</span><span class="COMM">// arrow left</span><span class="WHIT">
<span class='line'>792</span> </span><span class="WHIT">							</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">37</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>793</span> </span><span class="WHIT">							</span><span class="COMM">// arrow down</span><span class="WHIT">
<span class='line'>794</span> </span><span class="WHIT">							</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">40</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>795</span> </span><span class="WHIT">								</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">selValue</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">step</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>796</span> </span><span class="WHIT">								</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>797</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>798</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>799</span> </span><span class="WHIT">										</span><span class="WHIT">
<span class='line'>800</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">stopThumbPress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>801</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">unbind</span><span class="PUNC">(</span><span class="STRN">'keydown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">doThumbPress</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>802</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>803</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>804</span> </span><span class="WHIT">					</span><span class="COMM">// initialing slider thumb dragging handler</span><span class="WHIT">
<span class='line'>805</span> </span><span class="WHIT">					</span><span class="NAME">rangeWrapper.find</span><span class="PUNC">(</span><span class="STRN">'div.xf-input-range-thumb'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">startThumbDrag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>806</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>807</span> </span><span class="WHIT">					</span><span class="COMM">// initialing arrow keys press handling</span><span class="WHIT">
<span class='line'>808</span> </span><span class="WHIT">					</span><span class="NAME">rangeWrapper.find</span><span class="PUNC">(</span><span class="STRN">'div.xf-input-range-control'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>809</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'focus'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">startThumbPress</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>810</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'focusout'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">stopThumbPress</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>811</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>812</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">trackClick</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>813</span> </span><span class="WHIT">						</span><span class="COMM">// skipping events fired by thumb dragging</span><span class="WHIT">
<span class='line'>814</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">event.target</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">rangeWrapper.find</span><span class="PUNC">(</span><span class="STRN">'div.xf-input-range-thumb'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>815</span> </span><span class="WHIT">							</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>816</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>817</span> </span><span class="WHIT">						</span><span class="NAME">setNewValue</span><span class="PUNC">(</span><span class="NAME">trackPointToValuePoint</span><span class="PUNC">(</span><span class="NAME">event.offsetX</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>818</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>819</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>820</span> </span><span class="WHIT">					</span><span class="COMM">// initialing track click handler</span><span class="WHIT">
<span class='line'>821</span> </span><span class="WHIT">					</span><span class="NAME">rangeWrapper.find</span><span class="PUNC">(</span><span class="STRN">'div.xf-input-range-track'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">trackClick</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>822</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>823</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>824</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>825</span> </span><span class="WHIT">			</span><span class="COMM">// Some Text-based inputs (text, search, tel, url, email, password, datetime, date, month,</span><span class="WHIT">
<span class='line'>826</span> </span><span class="WHIT">			</span><span class="COMM">// week, time, datetime-local, color) with data-appearance="split" attribute</span><span class="WHIT">
<span class='line'>827</span> </span><span class="WHIT">			</span><span class="COMM">// are parsed specifically:</span><span class="WHIT">
<span class='line'>828</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">splitAppearance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>829</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'data-appearance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'split'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">isInputElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>830</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>831</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">applicableTypes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'text'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'search'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tel'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'url'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'email'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>832</span> </span><span class="WHIT">					</span><span class="STRN">'password'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'datetime'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'date'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'month'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'week'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'time'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'datetime-local'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'color'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>833</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>834</span> </span><span class="WHIT">				</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">applicableTypes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">applicableType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>835</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textInputType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">applicableType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>836</span> </span><span class="WHIT">						</span><span class="NAME">splitAppearance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>837</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>838</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>839</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>840</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>841</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">textInputID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQTextInput.attr</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>842</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">textInputLabel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'label[for='</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">textInputID</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>843</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>844</span> </span><span class="WHIT">			</span><span class="COMM">// If the input doesn't have an associated label, quit</span><span class="WHIT">
<span class='line'>845</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textInputLabel.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>846</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>847</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">splitAppearance</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>848</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>849</span> </span><span class="WHIT">					</span><span class="COMM">// Add class xf-input-split-input to the input</span><span class="WHIT">
<span class='line'>850</span> </span><span class="WHIT">					</span><span class="NAME">jQTextInput.removeClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-text'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-split-input'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>851</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>852</span> </span><span class="WHIT">					</span><span class="COMM">// Add class xf-input-split-label to the label</span><span class="WHIT">
<span class='line'>853</span> </span><span class="WHIT">					</span><span class="NAME">textInputLabel.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-split-label'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>854</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>855</span> </span><span class="WHIT">					</span><span class="COMM">// Wrap both in div.xf-input-split</span><span class="WHIT">
<span class='line'>856</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">splitDiv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-split'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>857</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>858</span> </span><span class="WHIT">					</span><span class="COMM">// Wrap the label in div.xf-grid-unit.xf-input-split-part1</span><span class="WHIT">
<span class='line'>859</span> </span><span class="WHIT">					</span><span class="NAME">splitDiv.append</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-grid-unit xf-input-split-part1'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">textInputLabel</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>860</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>861</span> </span><span class="WHIT">					</span><span class="COMM">// Wrap the input in div.xf-grid-unit.xf-input-split-part2</span><span class="WHIT">
<span class='line'>862</span> </span><span class="WHIT">					</span><span class="NAME">splitDiv.append</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-grid-unit xf-input-split-part2'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">jQTextInput.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>863</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>864</span> </span><span class="WHIT">					</span><span class="NAME">jQTextInput.outerHtml</span><span class="PUNC">(</span><span class="NAME">splitDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>865</span> </span><span class="WHIT">					</span><span class="NAME">jQTextInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">splitDiv</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>866</span> </span><span class="WHIT">					</span><span class="NAME">textInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">splitDiv</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>867</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>868</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>869</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>870</span> </span><span class="WHIT">					</span><span class="COMM">// If inputs of the named types and textarea have a label associated to them (with "for" attribute</span><span class="WHIT">
<span class='line'>871</span> </span><span class="WHIT">					</span><span class="COMM">// with a value equal to input "id" attribute), the label is assigned a class name of "xf-label"</span><span class="WHIT">
<span class='line'>872</span> </span><span class="WHIT">					</span><span class="NAME">textInputLabel.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-label'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>873</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>874</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>875</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>876</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>877</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>878</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>879</span> 			Enhances checkbox or radio button input view
<span class='line'>880</span> 			@param textInput DOM Object
<span class='line'>881</span> 			@private
<span class='line'>882</span> 		*/</span><span class="WHIT">
<span class='line'>883</span> </span><span class="WHIT">		</span><span class="NAME">enhanceCheckboxRadio</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">chbRbInput</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>884</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>885</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jQChbRbInput</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">chbRbInput</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>886</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">chbRbInput</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">jQChbRbInput</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>887</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>888</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>889</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>890</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQChbRbInput.attr</span><span class="PUNC">(</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>891</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>892</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>893</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>894</span> </span><span class="WHIT">			</span><span class="NAME">jQChbRbInput.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>895</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>896</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">chbRbInputID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQChbRbInput.attr</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>897</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">chbRbInputLabel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'label[for='</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">chbRbInputID</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>898</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>899</span> </span><span class="WHIT">			</span><span class="COMM">// If the input doesn't have an associated label, quit</span><span class="WHIT">
<span class='line'>900</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">chbRbInputLabel.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>901</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>902</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">typeValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQChbRbInput.attr</span><span class="PUNC">(</span><span class="STRN">'type'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>903</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isSwitch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQChbRbInput.attr</span><span class="PUNC">(</span><span class="STRN">'data-role'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'switch'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>904</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>905</span> </span><span class="WHIT">				</span><span class="COMM">/*
<span class='line'>906</span> 				&lt;div class="xf-switch">
<span class='line'>907</span> 
<span class='line'>908</span> 						&lt;label class="xf-switch-control" for="wifi-switch22">
<span class='line'>909</span> 							&lt;input class="" type="radio" name="rr" id="wifi-switch22" data-role="switch" data-skip-enhance="true">
<span class='line'>910</span> 							&lt;span class="xf-switch-track">
<span class='line'>911</span> 								&lt;span class="xf-switch-track-wrap">&lt;span class="xf-switch-thumb">&lt;/span>&lt;/span>
<span class='line'>912</span> 							&lt;/span>
<span class='line'>913</span> 						&lt;/label>
<span class='line'>914</span> 
<span class='line'>915</span> 						&lt;label class="xf-switch-label" for="wifi-switch22">On/Off Switch&lt;/label>
<span class='line'>916</span> 					&lt;/div>
<span class='line'>917</span> 				*/</span><span class="WHIT">
<span class='line'>918</span> 
<span class='line'>919</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">wrapper</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>920</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isSwitch</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>921</span> </span><span class="WHIT">					</span><span class="COMM">// An input-label pair is wrapped in a div.xf-input-radio or div.xf-input-checkbox</span><span class="WHIT">
<span class='line'>922</span> </span><span class="WHIT">					</span><span class="NAME">wrapper.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">typeValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>923</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>924</span> </span><span class="WHIT">					</span><span class="COMM">// The input is wrapped in a new label.xf-input-positioner[for=INPUT-ID]</span><span class="WHIT">
<span class='line'>925</span> </span><span class="WHIT">					</span><span class="NAME">wrapper.append</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;label class="xf-input-positioner">&lt;/label>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'for'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">chbRbInputID</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">jQChbRbInput.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>926</span> </span><span class="WHIT">					</span><span class="COMM">// The old label is assigned a class xf-input-label</span><span class="WHIT">
<span class='line'>927</span> </span><span class="WHIT">					</span><span class="NAME">wrapper.append</span><span class="PUNC">(</span><span class="NAME">chbRbInputLabel.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-input-label'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>928</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>929</span> </span><span class="WHIT">					</span><span class="NAME">wrapper.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-switch'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>930</span> </span><span class="WHIT">					</span><span class="NAME">wrapper.append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>931</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;label class="xf-switch-control">&lt;/label>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'for'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">chbRbInputID</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>932</span> </span><span class="WHIT">							</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">jQChbRbInput.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>933</span> </span><span class="WHIT">							</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>934</span> </span><span class="WHIT">								</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;span class=xf-switch-track>&lt;span class=xf-switch-track-wrap>&lt;span class=xf-switch-thumb>&lt;/span>&lt;/span>&lt;/span>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>935</span> </span><span class="WHIT">							</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>936</span> </span><span class="WHIT">					</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>937</span> </span><span class="WHIT">					</span><span class="NAME">wrapper.append</span><span class="PUNC">(</span><span class="NAME">chbRbInputLabel.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-switch-label'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>938</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>939</span> 
<span class='line'>940</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>941</span> </span><span class="WHIT">				</span><span class="NAME">jQChbRbInput.outerHtml</span><span class="PUNC">(</span><span class="NAME">wrapper</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>942</span> 
<span class='line'>943</span> </span><span class="WHIT">                </span><span class="COMM">// fix iOS bug when labels don't check radios and checkboxes</span><span class="WHIT">
<span class='line'>944</span> 
<span class='line'>945</span> </span><span class="WHIT">                </span><span class="NAME">wrapper.on</span><span class="PUNC">(</span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'label[for="'</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">chbRbInputID</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="STRN">'"]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>946</span> </span><span class="WHIT">                    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">(</span><span class="STRN">'bound'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>947</span> </span><span class="WHIT">                        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$input</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'#'</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">chbRbInputID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>948</span> </span><span class="WHIT">                        </span><span class="NAME">alert</span><span class="PUNC">(</span><span class="NAME">$input</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">checked</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>949</span> </span><span class="WHIT">                        </span><span class="NAME">$input.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">checked</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">$input</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">checked</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>950</span> </span><span class="WHIT">                        </span><span class="PUNC">!</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">(</span><span class="STRN">'bound'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>951</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>952</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>953</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>954</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>955</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>956</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>957</span> 			Enhances fieldset view
<span class='line'>958</span> 			@param textInput DOM Object
<span class='line'>959</span> 			@private
<span class='line'>960</span> 		*/</span><span class="WHIT">
<span class='line'>961</span> </span><span class="WHIT">		</span><span class="NAME">enhanceFieldset</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fieldset</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>962</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>963</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jQFieldset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">fieldset</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>964</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">fieldset</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">jQFieldset</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>965</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>966</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>967</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>968</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQFieldset.attr</span><span class="PUNC">(</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>969</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>970</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>971</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>972</span> </span><span class="WHIT">			</span><span class="NAME">jQFieldset.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>973</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>974</span> </span><span class="WHIT">			</span><span class="COMM">// If the inputs have a parent fieldset[data-role=controlgroup], the fieldset</span><span class="WHIT">
<span class='line'>975</span> </span><span class="WHIT">			</span><span class="COMM">// is assigned a class xf-controlgroup,</span><span class="WHIT">
<span class='line'>976</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>977</span> </span><span class="WHIT">			</span><span class="NAME">jQFieldset.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-controlgroup'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>978</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>979</span> </span><span class="WHIT">			</span><span class="COMM">// If there's a legend element inside the fieldset, it becomes div.xf-label</span><span class="WHIT">
<span class='line'>980</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">legend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQFieldset.children</span><span class="PUNC">(</span><span class="STRN">'legend'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">detach</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>981</span> 
<span class='line'>982</span> </span><span class="WHIT">            </span><span class="COMM">// the inputs are also wrapped in a div.xf-controlgroup-controls</span><span class="WHIT">
<span class='line'>983</span> </span><span class="WHIT">            </span><span class="NAME">jQFieldset.wrapInner</span><span class="PUNC">(</span><span class="STRN">'&lt;div class=xf-controlgroup-controls>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>984</span> </span><span class="WHIT">            </span><span class="NAME">jQFieldset.prepend</span><span class="PUNC">(</span><span class="NAME">legend</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>985</span> 
<span class='line'>986</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">legend.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>987</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">legendDiv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>988</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newLegendAttrs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>989</span> </span><span class="WHIT">				</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">legend</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">attributes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>990</span> </span><span class="WHIT">					</span><span class="NAME">newLegendAttrs</span><span class="PUNC">[</span><span class="NAME">attribute.name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attribute.value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>991</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>992</span> </span><span class="WHIT">				</span><span class="NAME">legendDiv.attr</span><span class="PUNC">(</span><span class="NAME">newLegendAttrs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>993</span> </span><span class="WHIT">				</span><span class="NAME">legendDiv.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-label'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>994</span> </span><span class="WHIT">				</span><span class="NAME">legendDiv.html</span><span class="PUNC">(</span><span class="NAME">legend.html</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>995</span> </span><span class="WHIT">				</span><span class="NAME">legend.outerHtml</span><span class="PUNC">(</span><span class="NAME">legendDiv.outerHtml</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>996</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>997</span> 
<span class='line'>998</span> 
<span class='line'>999</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1000</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1001</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1002</span> 			Enhances ul/ol lists view
<span class='line'>1003</span> 			@param list DOM Object
<span class='line'>1004</span> 			@private
<span class='line'>1005</span> 		*/</span><span class="WHIT">
<span class='line'>1006</span> </span><span class="WHIT">		</span><span class="NAME">enhanceList</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1007</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1008</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jQList</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1009</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">jQList</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1010</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1011</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1012</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1013</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQList.attr</span><span class="PUNC">(</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1014</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1015</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1016</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1017</span> </span><span class="WHIT">			</span><span class="NAME">jQList.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1018</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1019</span> </span><span class="WHIT">			</span><span class="NAME">jQList.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-listview'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1020</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1021</span> </span><span class="WHIT">			</span><span class="COMM">// If the list has data-fullwidth="true" attribute add xf-listview-fullwidth class to it</span><span class="WHIT">
<span class='line'>1022</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQList.attr</span><span class="PUNC">(</span><span class="STRN">'data-fullwidth'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1023</span> </span><span class="WHIT">				</span><span class="NAME">jQList.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-listview-fullwidth'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1024</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1025</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1026</span> </span><span class="WHIT">			</span><span class="COMM">// Add xf-li class to all LIs inside</span><span class="WHIT">
<span class='line'>1027</span> </span><span class="WHIT">			</span><span class="NAME">jQList.children</span><span class="PUNC">(</span><span class="STRN">'li'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1028</span> </span><span class="WHIT">			</span><span class="COMM">// If a LI has data-role="divider" attribute add xf-li-divider class to the LI</span><span class="WHIT">
<span class='line'>1029</span> </span><span class="WHIT">			</span><span class="NAME">jQList.children</span><span class="PUNC">(</span><span class="STRN">'li[data-role=divider]'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-divider'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1030</span> 
<span class='line'>1031</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lis</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQList.children</span><span class="PUNC">(</span><span class="STRN">'li'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1032</span> 
<span class='line'>1033</span> </span><span class="WHIT">            </span><span class="COMM">// If there's an A element directly inside the LI, add xf-li-btn class to the A</span><span class="WHIT">
<span class='line'>1034</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">anchors</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lis.children</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1035</span> 
<span class='line'>1036</span> </span><span class="WHIT">            </span><span class="NAME">anchors.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-btn'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1037</span> </span><span class="WHIT">			</span><span class="COMM">// If there's _no_ A element directly inside the LI, add xf-li-static class to it.</span><span class="WHIT">
<span class='line'>1038</span> </span><span class="WHIT">			</span><span class="COMM">// Don't add xf-li-static class to LIs with data-role="divider"</span><span class="WHIT">
<span class='line'>1039</span> </span><span class="WHIT">			</span><span class="NAME">lis.not</span><span class="PUNC">(</span><span class="NAME">anchors.parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">not</span><span class="PUNC">(</span><span class="STRN">'[data-role=divider]'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-static'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1040</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1041</span> </span><span class="WHIT">			</span><span class="COMM">// If there's a data-icon attribute on LI:</span><span class="WHIT">
<span class='line'>1042</span> </span><span class="WHIT">			</span><span class="COMM">// Append SPAN.xf-icon.xf-icon-big.xf-icon-ICONNAME inside the A</span><span class="WHIT">
<span class='line'>1043</span> </span><span class="WHIT">			</span><span class="COMM">// If parent LI had no data-iconpos attribute or had data-iconpos="right" attr,</span><span class="WHIT">
<span class='line'>1044</span> </span><span class="WHIT">			</span><span class="COMM">// add xf-li-with-icon-right class to the A, otherwise add class xf-li-with-icon-left</span><span class="WHIT">
<span class='line'>1045</span> </span><span class="WHIT">			</span><span class="NAME">jQList.children</span><span class="PUNC">(</span><span class="STRN">'li[data-icon]'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1046</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqAnchor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1047</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">icon</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqAnchor.parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-icon'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1048</span> </span><span class="WHIT">				</span><span class="NAME">jqAnchor.append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1049</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;span>&lt;/span>'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-icon xf-icon-big xf-icon-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">icon</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1050</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1051</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqAnchor.parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-iconpos'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1052</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'left'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'right'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1053</span> </span><span class="WHIT">					</span><span class="NAME">iconPos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'right'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1054</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1055</span> </span><span class="WHIT">				</span><span class="NAME">jqAnchor.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-with-icon-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">iconPos</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1056</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1057</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1058</span> </span><span class="WHIT">			</span><span class="COMM">// If there's an element with class xf-count-bubble inside the A, add xf-li-has-count to the A</span><span class="WHIT">
<span class='line'>1059</span> </span><span class="WHIT">			</span><span class="NAME">anchors.children</span><span class="PUNC">(</span><span class="STRN">'.xf-count-bubble'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-has-count'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1060</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1061</span> </span><span class="WHIT">			</span><span class="COMM">// If there's an IMG directly inside the A, add xf-li-with-thumb-left class to the A,</span><span class="WHIT">
<span class='line'>1062</span> </span><span class="WHIT">			</span><span class="COMM">// and xf-li-thumb & xf-li-thumb-left classes to the IMG.</span><span class="WHIT">
<span class='line'>1063</span> </span><span class="WHIT">			</span><span class="COMM">// If there was data-thumbpos="right" attr, the classes must be</span><span class="WHIT">
<span class='line'>1064</span> </span><span class="WHIT">			</span><span class="COMM">// xf-li-with-thumb-right & xf-li-thumb-right</span><span class="WHIT">
<span class='line'>1065</span> </span><span class="WHIT">			</span><span class="NAME">anchors.children</span><span class="PUNC">(</span><span class="STRN">'img'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1066</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqAnchor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1067</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">thumbPos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqAnchor.parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-thumbpos'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1068</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">thumbPos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'right'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">thumbPos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'left'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1069</span> </span><span class="WHIT">					</span><span class="NAME">thumbPos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'left'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1070</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1071</span> </span><span class="WHIT">				</span><span class="NAME">jqAnchor.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-with-thumb-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">thumbPos</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1072</span> </span><span class="WHIT">				</span><span class="NAME">jqAnchor.children</span><span class="PUNC">(</span><span class="STRN">'img'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-thumb xf-li-thumb-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">thumbPos</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1073</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1074</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1075</span> </span><span class="WHIT">			</span><span class="COMM">// Inside the A, wrap all contents except the icon, count-bubble and the thumbnail</span><span class="WHIT">
<span class='line'>1076</span> </span><span class="WHIT">			</span><span class="COMM">// in one .xf-btn-text div.</span><span class="WHIT">
<span class='line'>1077</span> </span><span class="WHIT">			</span><span class="NAME">anchors.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1078</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqAnchor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1079</span> </span><span class="WHIT">				</span><span class="NAME">jqAnchor.append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1080</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div class=xf-btn-text>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1081</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1082</span> </span><span class="WHIT">							</span><span class="NAME">jqAnchor.contents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">not</span><span class="PUNC">(</span><span class="STRN">'.xf-icon, .xf-count-bubble, .xf-li-thumb'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1083</span> </span><span class="WHIT">						</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1084</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1085</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1086</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1087</span> </span><span class="WHIT">			</span><span class="COMM">// To all H1-h6 elements inside the A add xf-li-header class</span><span class="WHIT">
<span class='line'>1088</span> </span><span class="WHIT">            </span><span class="NAME">lis.find</span><span class="PUNC">(</span><span class="STRN">'h1, h2, h3, h4, h5, h6'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-header'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1089</span> </span><span class="WHIT">			</span><span class="COMM">// To all P elements inside the A add xf-li-desc class</span><span class="WHIT">
<span class='line'>1090</span> </span><span class="WHIT">            </span><span class="NAME">lis.find</span><span class="PUNC">(</span><span class="STRN">'p'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-li-desc'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1091</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1092</span> </span><span class="WHIT">			</span><span class="COMM">// Wrap LI.xf-li-static inside with DIV.xf-li-wrap</span><span class="WHIT">
<span class='line'>1093</span> </span><span class="WHIT">			</span><span class="NAME">lis.filter</span><span class="PUNC">(</span><span class="STRN">'.xf-li-static'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1094</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">wrapInner</span><span class="PUNC">(</span><span class="STRN">'&lt;div class=xf-li-wrap />'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1095</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1096</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1097</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1098</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1099</span> 	     Adds scrolling functionality
<span class='line'>1100</span> 	     @param scrollable DOM Object
<span class='line'>1101</span> 	     @private
<span class='line'>1102</span> 	     */</span><span class="WHIT">
<span class='line'>1103</span> </span><span class="WHIT">	    </span><span class="NAME">enhanceScrollable</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">scrollable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1104</span> 
<span class='line'>1105</span> </span><span class="WHIT">	        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jQScrollable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">scrollable</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1106</span> </span><span class="WHIT">	        </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">scrollable</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">jQScrollable</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1107</span> </span><span class="WHIT">	            </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1108</span> </span><span class="WHIT">	        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1109</span> 
<span class='line'>1110</span> </span><span class="WHIT">	        </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQScrollable.attr</span><span class="PUNC">(</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1111</span> </span><span class="WHIT">	            </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1112</span> </span><span class="WHIT">	        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1113</span> 
<span class='line'>1114</span> </span><span class="WHIT">	        </span><span class="NAME">jQScrollable.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'data-skip-enhance'</span><span class="PUNC">:</span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1115</span> 
<span class='line'>1116</span> </span><span class="WHIT">	        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">children</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQScrollable.children</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1117</span> </span><span class="WHIT">	        </span><span class="COMM">// always create wrapper</span><span class="WHIT">
<span class='line'>1118</span> </span><span class="WHIT">	        </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">children.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1119</span> </span><span class="WHIT">	            </span><span class="NAME">children.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-scrollable-content'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1120</span> </span><span class="WHIT">	        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1121</span> </span><span class="WHIT">	            </span><span class="NAME">jQScrollable.append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1122</span> </span><span class="WHIT">	                </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1123</span> </span><span class="WHIT">	                    </span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-scrollable-content'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1124</span> </span><span class="WHIT">	                    </span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">children</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1125</span> </span><span class="WHIT">	            </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1126</span> </span><span class="WHIT">	        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1127</span> 
<span class='line'>1128</span> </span><span class="WHIT">	        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">wrapperId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQScrollable.attr</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1129</span> </span><span class="WHIT">	        </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">wrapperId</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">wrapperId</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1130</span> </span><span class="WHIT">	            </span><span class="NAME">wrapperId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'xf_scrollable_'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1131</span> </span><span class="WHIT">	            </span><span class="NAME">jQScrollable.attr</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="STRN">'id'</span><span class="PUNC">:</span><span class="NAME">wrapperId</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1132</span> </span><span class="WHIT">	        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1133</span> 
<span class='line'>1134</span> </span><span class="WHIT">	        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ISItem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jQScrollable.data</span><span class="PUNC">(</span><span class="STRN">'iscroll'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">iScroll</span><span class="PUNC">(</span><span class="NAME">wrapperId</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1135</span> </span><span class="WHIT">	        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">wrapperChanged</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1136</span> </span><span class="WHIT">	        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">doRefreshIScroll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1137</span> </span><span class="WHIT">	            </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">wrapperChanged</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1138</span> </span><span class="WHIT">	                </span><span class="NAME">wrapperChanged</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1139</span> </span><span class="WHIT">	                </span><span class="NAME">ISItem.data</span><span class="PUNC">(</span><span class="STRN">'iscroll'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">refresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1140</span> </span><span class="WHIT">	                </span><span class="NAME">bindHanlders</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1141</span> </span><span class="WHIT">	            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1142</span> </span><span class="WHIT">	        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1143</span> </span><span class="WHIT">	        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">needRefreshIScroll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1144</span> </span><span class="WHIT">	            </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jQuery.contains</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'#'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">wrapperId</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1145</span> </span><span class="WHIT">	                </span><span class="NAME">wrapperChanged</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1146</span> </span><span class="WHIT">	                </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">doRefreshIScroll</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1147</span> </span><span class="WHIT">	            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1148</span> </span><span class="WHIT">	        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1149</span> 
<span class='line'>1150</span> </span><span class="WHIT">	        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bindHanlders</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1151</span> </span><span class="WHIT">	            </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'#'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">wrapperId</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' *'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1152</span> </span><span class="WHIT">	                </span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'detach'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">needRefreshIScroll</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1153</span> </span><span class="WHIT">	                </span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'hide'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">needRefreshIScroll</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1154</span> </span><span class="WHIT">	                </span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'show'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">needRefreshIScroll</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1155</span> </span><span class="WHIT">	                </span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'append'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">needRefreshIScroll</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1156</span> </span><span class="WHIT">	                </span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'prepend'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">needRefreshIScroll</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1157</span> </span><span class="WHIT">	                </span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'html'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">needRefreshIScroll</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1158</span> </span><span class="WHIT">	                </span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'resize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">needRefreshIScroll</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1159</span> </span><span class="WHIT">	        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1160</span> 
<span class='line'>1161</span> </span><span class="WHIT">	        </span><span class="NAME">bindHanlders</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1162</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1163</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1164</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1165</span> 			Generates and enhances button
<span class='line'>1166</span> 			@param buttonDescr Object
<span class='line'>1167</span> 			@return jQuery
<span class='line'>1168</span> 		*/</span><span class="WHIT">
<span class='line'>1169</span> </span><span class="WHIT">		</span><span class="NAME">createButton</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">buttonDescr</span><span class="PUNC">)</span><span class="WHIT">  </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1170</span> </span><span class="WHIT">			</span><span class="COMM">/*
<span class='line'>1171</span> 				buttonDescr = {
<span class='line'>1172</span> 					text,
<span class='line'>1173</span> 					icon,
<span class='line'>1174</span> 					iconpos,
<span class='line'>1175</span> 					small,
<span class='line'>1176</span> 					appearance,
<span class='line'>1177</span> 					special,
<span class='line'>1178</span> 					alert,
<span class='line'>1179</span> 					handler
<span class='line'>1180</span> 				}
<span class='line'>1181</span> 			*/</span><span class="WHIT">
<span class='line'>1182</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jQButton</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;button>&lt;/button>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1183</span> </span><span class="WHIT">			</span><span class="NAME">jQButton.html</span><span class="PUNC">(</span><span class="NAME">buttonDescr.text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1184</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1185</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">buttonDescr.icon</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">buttonDescr.icon</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1186</span> </span><span class="WHIT">				</span><span class="NAME">attrs</span><span class="PUNC">[</span><span class="STRN">'data-icon'</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttonDescr.icon</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1187</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1188</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">buttonDescr.iconpos</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">buttonDescr.iconpos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1189</span> </span><span class="WHIT">				</span><span class="NAME">attrs</span><span class="PUNC">[</span><span class="STRN">'data-iconpos'</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttonDescr.iconpos</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1190</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1191</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">buttonDescr.small</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">buttonDescr.small</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1192</span> </span><span class="WHIT">				</span><span class="NAME">attrs</span><span class="PUNC">[</span><span class="STRN">'data-small'</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttonDescr.small</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1193</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1194</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">buttonDescr.appearance</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">buttonDescr.appearance</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1195</span> </span><span class="WHIT">				</span><span class="NAME">attrs</span><span class="PUNC">[</span><span class="STRN">'data-appearance'</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttonDescr.appearance</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1196</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1197</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">buttonDescr.special</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">buttonDescr.special</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1198</span> </span><span class="WHIT">				</span><span class="NAME">attrs</span><span class="PUNC">[</span><span class="STRN">'data-special'</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttonDescr.special</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1199</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1200</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">buttonDescr.alert</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">buttonDescr.alert</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1201</span> </span><span class="WHIT">				</span><span class="NAME">attrs</span><span class="PUNC">[</span><span class="STRN">'data-alert'</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttonDescr.alert</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1202</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1203</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_.isFunction</span><span class="PUNC">(</span><span class="NAME">buttonDescr.handler</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1204</span> </span><span class="WHIT">                </span><span class="NAME">jQButton.click</span><span class="PUNC">(</span><span class="NAME">buttonDescr.handler</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1205</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1206</span> 
<span class='line'>1207</span> 
<span class='line'>1208</span> </span><span class="WHIT">			</span><span class="NAME">jQButton.attr</span><span class="PUNC">(</span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1209</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1210</span> </span><span class="WHIT">			</span><span class="NAME">XF.UIElements.enhanceButton</span><span class="PUNC">(</span><span class="NAME">jQButton</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1211</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1212</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">jQButton</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1213</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1214</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1215</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1216</span> 			Generates basic popup container
<span class='line'>1217</span> 			@return jQuery
<span class='line'>1218</span> 			@private
<span class='line'>1219</span> 		*/</span><span class="WHIT">
<span class='line'>1220</span> </span><span class="WHIT">		</span><span class="NAME">createPopup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1221</span> </span><span class="WHIT">			</span><span class="COMM">/*
<span class='line'>1222</span> 				&lt;div class="xf-dialog ">&lt;div class="xf-dialog-content">&lt;/div>&lt;/div>
<span class='line'>1223</span> 			*/</span><span class="WHIT">
<span class='line'>1224</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqPopup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>1225</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div class="xf-dialog ">&lt;div class="xf-dialog-content">&lt;/div>&lt;/div>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1226</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">jqPopup</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1227</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1228</span> 
<span class='line'>1229</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='line'>1230</span>             Shorthand to show dialogs
<span class='line'>1231</span>          @param headerText String to show in dialog header
<span class='line'>1232</span>          @param messageText String to show in dialog body
<span class='line'>1233</span>          @param buttons Array of buttons to show (jQuery objects or objects with button description for createButton() method)
<span class='line'>1234</span>         */</span><span class="WHIT">
<span class='line'>1235</span> </span><span class="WHIT">        </span><span class="NAME">showDialog</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">headerText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">messageText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1236</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">popup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.UIElements.createDialog</span><span class="PUNC">(</span><span class="NAME">headerText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">messageText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1237</span> </span><span class="WHIT">            </span><span class="NAME">XF.UIElements.showPopup</span><span class="PUNC">(</span><span class="NAME">popup</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1238</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1239</span> 
<span class='line'>1240</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1241</span> 			Attaches popup (dialog/notification/etc.) to the page
<span class='line'>1242</span> 			@param jqPopup jQuery object representing popup
<span class='line'>1243</span> 		*/</span><span class="WHIT">
<span class='line'>1244</span> </span><span class="WHIT">		</span><span class="NAME">showPopup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jqPopup</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1245</span> </span><span class="WHIT">			</span><span class="NAME">XF.Device.getViewport</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">jqPopup</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1246</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1247</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1248</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1249</span> 			Detaches popup (dialog/notification/etc.) from the page
<span class='line'>1250</span> 			@param jqPopup jQuery object representing popup
<span class='line'>1251</span> 		*/</span><span class="WHIT">
<span class='line'>1252</span> </span><span class="WHIT">		</span><span class="NAME">hidePopup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jqPopup</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1253</span> </span><span class="WHIT">			</span><span class="NAME">jqPopup.detach</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1254</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1255</span> 
<span class='line'>1256</span> 
<span class='line'>1257</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1258</span> 			Generates a dialog with header, message and buttons
<span class='line'>1259</span> 			@param headerText String to show in dialog header
<span class='line'>1260</span> 			@param messageText String to show in dialog body
<span class='line'>1261</span> 			@param buttons Array of buttons to show (jQuery objects or objects with button description for createButton() method)
<span class='line'>1262</span>             @param modal Boolean Flag which indicates whether the dialog is modal
<span class='line'>1263</span> 			@return jQuery Dialog object
<span class='line'>1264</span> 		*/</span><span class="WHIT">
<span class='line'>1265</span> </span><span class="WHIT">		</span><span class="NAME">createDialog</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">headerText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">messageText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1266</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1267</span> </span><span class="WHIT">			</span><span class="COMM">/*
<span class='line'>1268</span> 				&lt;div class="xf-dialog-box">
<span class='line'>1269</span> 					&lt;div class="xf-dialog-box-header">
<span class='line'>1270</span> 						&lt;h3>Impossible! &lt;!-- Header text here --> &lt;/h3>
<span class='line'>1271</span> 					&lt;/div>
<span class='line'>1272</span> 					&lt;div class="xf-dialog-box-content">
<span class='line'>1273</span> 						&lt;!-- Message text here -->
<span class='line'>1274</span> 						Youre the smartest guy I've ever known.
<span class='line'>1275</span> 					&lt;/div>
<span class='line'>1276</span> 					&lt;div class="xf-dialog-box-footer clearfix">
<span class='line'>1277</span> 						&lt;!-- Buttons here -->
<span class='line'>1278</span> 						&lt;div class="xf-grid-unit xf-grid-unit-1of2">
<span class='line'>1279</span> 							&lt;button class="xf-button xf-button-small">
<span class='line'>1280</span> 								&lt;span class="xf-button-text">Cancel&lt;/span>
<span class='line'>1281</span> 							&lt;/button>
<span class='line'>1282</span> 						&lt;/div>
<span class='line'>1283</span> 						&lt;div class="xf-grid-unit xf-grid-unit-1of2">
<span class='line'>1284</span> 							&lt;button class="xf-button xf-button-small xf-button-special">
<span class='line'>1285</span> 								&lt;span class="xf-button-text">OK&lt;/span>
<span class='line'>1286</span> 							&lt;/button>
<span class='line'>1287</span> 						&lt;/div>
<span class='line'>1288</span> 					&lt;/div>
<span class='line'>1289</span> 				&lt;/div>
<span class='line'>1290</span> 			*/</span><span class="WHIT">
<span class='line'>1291</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1292</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqDialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.UIElements.createPopup</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1293</span> </span><span class="WHIT">			</span><span class="NAME">jqDialog.find</span><span class="PUNC">(</span><span class="STRN">'.xf-dialog-content'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1294</span> </span><span class="WHIT">				</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1295</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1296</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-dialog-box'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1297</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1298</span> </span><span class="WHIT">							</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1299</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-dialog-box-header'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1300</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1301</span> </span><span class="WHIT">									</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;h3>&lt;/h3>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1302</span> </span><span class="WHIT">										</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">headerText</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1303</span> </span><span class="WHIT">								</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1304</span> </span><span class="WHIT">						</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1305</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1306</span> </span><span class="WHIT">							</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1307</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-dialog-box-content'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1308</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">messageText</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1309</span> </span><span class="WHIT">						</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1310</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1311</span> </span><span class="WHIT">							</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1312</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-dialog-box-footer clearfix'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1313</span> </span><span class="WHIT">						</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1314</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1315</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1316</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqBtnContainer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqDialog.find</span><span class="PUNC">(</span><span class="STRN">'.xf-dialog-box-footer'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1317</span> 
<span class='line'>1318</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1319</span> </span><span class="WHIT">                </span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1320</span> </span><span class="WHIT">                    </span><span class="NAME">text</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'OK'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1321</span> </span><span class="WHIT">                    </span><span class="NAME">handler</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1322</span> </span><span class="WHIT">                        </span><span class="NAME">XF.UIElements.hidePopup</span><span class="PUNC">(</span><span class="NAME">jqDialog</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1323</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1324</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>1325</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1326</span> 
<span class='line'>1327</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1328</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">btnCount</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttons.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1329</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>1330</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqBtn</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1331</span> </span><span class="WHIT">				</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">buttons</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">btn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1332</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">btn</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1333</span> </span><span class="WHIT">						</span><span class="NAME">jqBtn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">btn</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1334</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1335</span> </span><span class="WHIT">						</span><span class="NAME">jqBtn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.UIElements.createButton</span><span class="PUNC">(</span><span class="NAME">btn</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1336</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1337</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>1338</span> </span><span class="WHIT">					</span><span class="NAME">jqBtnContainer.append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1339</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1340</span> </span><span class="WHIT">							</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-grid-unit xf-grid-unit-1of'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">btnCount</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1341</span> </span><span class="WHIT">							</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="NAME">jqBtn</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1342</span> </span><span class="WHIT">					</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1343</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1344</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1345</span> </span><span class="WHIT">			</span><span class="NAME">XF.UIElements.dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqDialog</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1346</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">jqDialog</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1347</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1348</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1349</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1350</span> 			Generates a notification with text and icon
<span class='line'>1351</span> 			@param messageText String to show in dialog body
<span class='line'>1352</span> 			@param iconName Icon name (optional)
<span class='line'>1353</span> 			@return jQuery Notification object
<span class='line'>1354</span> 		*/</span><span class="WHIT">
<span class='line'>1355</span> </span><span class="WHIT">		</span><span class="NAME">createNotification</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">messageText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">iconName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1356</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1357</span> </span><span class="WHIT">			</span><span class="COMM">/*
<span class='line'>1358</span> 				&lt;div class="xf-notification">
<span class='line'>1359</span> 					&lt;div class="xf-notification-wrap">
<span class='line'>1360</span> 						&lt;div class="xf-notification-icon">
<span class='line'>1361</span> 							&lt;span class="xf-icon xf-icon-xl xf-icon-dots">&lt;/span>
<span class='line'>1362</span> 						&lt;/div>
<span class='line'>1363</span> 						&lt;div class="xf-notification-text">
<span class='line'>1364</span> 							Loading...
<span class='line'>1365</span> 						&lt;/div>
<span class='line'>1366</span> 					&lt;/div>
<span class='line'>1367</span> 				&lt;/div>
<span class='line'>1368</span> 			*/</span><span class="WHIT">
<span class='line'>1369</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1370</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqNotification</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.UIElements.createPopup</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-dialog-notification'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1371</span> </span><span class="WHIT">			</span><span class="NAME">jqNotification.find</span><span class="PUNC">(</span><span class="STRN">'.xf-dialog-content'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1372</span> </span><span class="WHIT">				</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1373</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1374</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-notification'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1375</span> </span><span class="WHIT">						</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1376</span> </span><span class="WHIT">							</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1377</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-notification-wrap'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1378</span> </span><span class="WHIT">								</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1379</span> </span><span class="WHIT">									</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1380</span> </span><span class="WHIT">										</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-notification-text'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1381</span> </span><span class="WHIT">										</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">messageText</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1382</span> </span><span class="WHIT">								</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1383</span> </span><span class="WHIT">						</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1384</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1385</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1386</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">iconName</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">iconName</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1387</span> </span><span class="WHIT">				</span><span class="NAME">jqNotification.find</span><span class="PUNC">(</span><span class="STRN">'.xf-notification-wrap'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1388</span> </span><span class="WHIT">					</span><span class="PUNC">.</span><span class="NAME">prepend</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1389</span> </span><span class="WHIT">						</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;div>&lt;/div>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1390</span> </span><span class="WHIT">							</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-notification-icon'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1391</span> </span><span class="WHIT">							</span><span class="PUNC">.</span><span class="NAME">append</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1392</span> </span><span class="WHIT">								</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;span>&lt;/span>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1393</span> </span><span class="WHIT">									</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-icon xf-icon-xl xf-icon-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">iconName</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1394</span> </span><span class="WHIT">							</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1395</span> </span><span class="WHIT">					</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1396</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1397</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1398</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">jqNotification</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1399</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1400</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1401</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1402</span> 			Stores loading notification object
<span class='line'>1403</span> 			@type jQuery
<span class='line'>1404</span> 			@private
<span class='line'>1405</span> 		*/</span><span class="WHIT">
<span class='line'>1406</span> </span><span class="WHIT">		</span><span class="NAME">loadingNotification</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1407</span> 
<span class='line'>1408</span> 
<span class='line'>1409</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1410</span> 			Stores dialog object
<span class='line'>1411</span> 			@type jQuery
<span class='line'>1412</span> 			@private
<span class='line'>1413</span> 		*/</span><span class="WHIT">
<span class='line'>1414</span> </span><span class="WHIT">		</span><span class="NAME">dialog</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1415</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1416</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1417</span> 			Saves passed popup as default loading notification
<span class='line'>1418</span> 			@param jqPopup jQuery object representing popup
<span class='line'>1419</span> 		*/</span><span class="WHIT">
<span class='line'>1420</span> </span><span class="WHIT">		</span><span class="NAME">setLoadingNotification</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jqPopup</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1421</span> </span><span class="WHIT">			</span><span class="NAME">XF.UIElements.loadingNotification</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqPopup</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1422</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1423</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1424</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1425</span> 			Shows loading notification (and generates new if params are passed)
<span class='line'>1426</span> 			@param messageText String to show in loading notification
<span class='line'>1427</span> 			@param icon Icon name (optional)
<span class='line'>1428</span> 		*/</span><span class="WHIT">
<span class='line'>1429</span> </span><span class="WHIT">		</span><span class="NAME">showLoading</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">messageText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">icon</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1430</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">messageText</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">icon</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1431</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.loadingNotification</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1432</span> </span><span class="WHIT">					</span><span class="NAME">XF.UIElements.hideLoading</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1433</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1434</span> </span><span class="WHIT">				</span><span class="NAME">XF.UIElements.setLoadingNotification</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1435</span> </span><span class="WHIT">					</span><span class="NAME">XF.UIElements.createNotification</span><span class="PUNC">(</span><span class="NAME">messageText</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">icon</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1436</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1437</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1438</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">XF.UIElements.loadingNotification</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1439</span> </span><span class="WHIT">				</span><span class="NAME">XF.UIElements.setLoadingNotification</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1440</span> </span><span class="WHIT">					</span><span class="NAME">XF.UIElements.createNotification</span><span class="PUNC">(</span><span class="STRN">'Loading...'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>1441</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1442</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1443</span> </span><span class="WHIT">			</span><span class="NAME">XF.UIElements.showPopup</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.loadingNotification</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1444</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1445</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1446</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1447</span> 			Hides loading notification
<span class='line'>1448</span> 		*/</span><span class="WHIT">
<span class='line'>1449</span> </span><span class="WHIT">		</span><span class="NAME">hideLoading</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1450</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.loadingNotification</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1451</span> </span><span class="WHIT">				</span><span class="NAME">XF.UIElements.hidePopup</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.loadingNotification</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1452</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1453</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1454</span> 
<span class='line'>1455</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1456</span> 			Hides Dialog
<span class='line'>1457</span> 		*/</span><span class="WHIT">
<span class='line'>1458</span> </span><span class="WHIT">		</span><span class="NAME">hideDialog</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1459</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.dialog</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1460</span> </span><span class="WHIT">				</span><span class="NAME">XF.UIElements.hidePopup</span><span class="PUNC">(</span><span class="NAME">XF.UIElements.dialog</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1461</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1462</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1463</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1464</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1465</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1466</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1467</span> 		Creates {@link XF.Router}
<span class='line'>1468</span> 		@memberOf XF
<span class='line'>1469</span> 		@param {Object} routes list of routes for {@link XF.Router}
<span class='line'>1470</span> 		@param {Object} handlers list of route handlers for {@link XF.Router}
<span class='line'>1471</span> 		@private
<span class='line'>1472</span> 	*/</span><span class="WHIT">
<span class='line'>1473</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">createRouter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">routes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1474</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1475</span> </span><span class="WHIT">		</span><span class="NAME">routes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">routes</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1476</span> </span><span class="WHIT">		</span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1477</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1478</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.Router</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1479</span> </span><span class="WHIT">			</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">'XF.createRouter can be called only ONCE!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1480</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1481</span> </span><span class="WHIT">			</span><span class="NAME">XF.Router</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.RouterClass</span><span class="PUNC">(</span><span class="NAME">routes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1482</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1483</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1484</span> 
<span class='line'>1485</span> 
<span class='line'>1486</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1487</span> 		Adds listeners to each 'a' tag with 'data-href' attribute on a page - all the clicks should bw delegated to {@link XF.Router}
<span class='line'>1488</span> 		@memberOf XF
<span class='line'>1489</span> 		@private
<span class='line'>1490</span> 	*/</span><span class="WHIT">
<span class='line'>1491</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">placeAnchorHooks</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1492</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'[data-href]'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">live</span><span class="PUNC">(</span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1493</span> </span><span class="WHIT">			</span><span class="NAME">XF.Router.navigate</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-href'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1494</span> </span><span class="WHIT">			</span><span class="NAME">_.delay</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">window.scrollTo</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">250</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1495</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1496</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1497</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1498</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1499</span> 		Loads component definitions for each visible component placeholder found
<span class='line'>1500</span> 		@memberOf XF
<span class='line'>1501</span> 		@param {Object} DOMObject Base object to look for components
<span class='line'>1502</span> 		@private
<span class='line'>1503</span> 	*/</span><span class="WHIT">
<span class='line'>1504</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">loadChildComponents</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">DOMObject</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1505</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">DOMObject</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">find</span><span class="PUNC">(</span><span class="STRN">'[data-component]:visible, [data-component][data-cache=true]'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ind</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1506</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">compID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-id'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1507</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">compName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-component'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1508</span> </span><span class="WHIT">			</span><span class="NAME">loadChildComponent</span><span class="PUNC">(</span><span class="NAME">compID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1509</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1510</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1511</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1512</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1513</span> 		Loads component definition and creates its instance
<span class='line'>1514</span> 		@memberOf XF
<span class='line'>1515</span> 		@param {String} compID Data-id property value of a component instance
<span class='line'>1516</span> 		@param {String} compName Name of the Component to be loaded
<span class='line'>1517</span> 		@private
<span class='line'>1518</span> 	*/</span><span class="WHIT">
<span class='line'>1519</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">loadChildComponent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">compName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1520</span> </span><span class="WHIT">		</span><span class="NAME">getComponent</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compDef</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1521</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">components</span><span class="PUNC">[</span><span class="NAME">compID</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1522</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">compInst</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">compDef</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">compID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1523</span> </span><span class="WHIT">				</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF :: loadChildComponent - created : '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">compID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1524</span> </span><span class="WHIT">				</span><span class="NAME">components</span><span class="PUNC">[</span><span class="NAME">compID</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">compInst</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1525</span> </span><span class="WHIT">				</span><span class="NAME">compInst.construct</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1526</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1527</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1528</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1529</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1530</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1531</span> 		Binds hide/show listners to each component placeholder. This listener should load component definition and create an instance of a component as soon as the placeholder would become visible
<span class='line'>1532</span> 		@memberOf XF
<span class='line'>1533</span> 		@private
<span class='line'>1534</span> 	*/</span><span class="WHIT">
<span class='line'>1535</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bindHideShowListeners</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1536</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'[data-component]'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">live</span><span class="PUNC">(</span><span class="STRN">'show'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1537</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">evt.currentTarget</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">evt.target</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1538</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">compID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-id'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1539</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">components</span><span class="PUNC">[</span><span class="NAME">compID</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1540</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">compName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">attr</span><span class="PUNC">(</span><span class="STRN">'data-component'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1541</span> </span><span class="WHIT">					</span><span class="NAME">loadChildComponent</span><span class="PUNC">(</span><span class="NAME">compID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">compName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1542</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1543</span> </span><span class="WHIT">				</span><span class="NAME">XF.UIElements.enhanceView</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1544</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1545</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1546</span> </span><span class="WHIT">		</span><span class="COMM">/*
<span class='line'>1547</span> 		var selector = null;
<span class='line'>1548</span> 		_.each(XF.UIElements.enhancementList, function(enhancement, index, enhancementList) {
<span class='line'>1549</span> 			if(!selector) {
<span class='line'>1550</span> 				selector = enhancement.selector;
<span class='line'>1551</span> 			} else {
<span class='line'>1552</span> 				selector += ', ' + enhancement.selector;
<span class='line'>1553</span> 			}
<span class='line'>1554</span> 		});
<span class='line'>1555</span> 		$(selector).live('show', function() {
<span class='line'>1556</span> 			XF.UIElements.enhanceView($(this));
<span class='line'>1557</span> 		});
<span class='line'>1558</span> 		*/</span><span class="WHIT">
<span class='line'>1559</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1560</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1561</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1562</span> 		Loads script
<span class='line'>1563</span> 		@memberOf XF
<span class='line'>1564</span> 		@param {String} url Component definition URL
<span class='line'>1565</span> 		@param {Function} callback Function to be executed when the component definition would be loaded
<span class='line'>1566</span> 		@private
<span class='line'>1567</span> 	*/</span><span class="WHIT">
<span class='line'>1568</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">loadScript</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1569</span> 
<span class='line'>1570</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">script</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'script'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1571</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1572</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">script.readyState</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">  </span><span class="COMM">//IE</span><span class="WHIT">
<span class='line'>1573</span> </span><span class="WHIT">			</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>1574</span> </span><span class="WHIT">			</span><span class="NAME">script.onreadystatechange</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1575</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">script.readyState</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'loaded'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">script.readyState</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'complete'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1576</span> </span><span class="WHIT">					</span><span class="NAME">script.onreadystatechange</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1577</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1578</span> </span><span class="WHIT">						</span><span class="NAME">callback</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1579</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1580</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1581</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1582</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">  </span><span class="COMM">//Others</span><span class="WHIT">
<span class='line'>1583</span> </span><span class="WHIT">			</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>1584</span> </span><span class="WHIT">			</span><span class="NAME">script.onload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1585</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1586</span> </span><span class="WHIT">					</span><span class="NAME">callback</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1587</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1588</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1589</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1590</span> 
<span class='line'>1591</span> </span><span class="WHIT">		</span><span class="NAME">script.src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1592</span> </span><span class="WHIT">		</span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">'head'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">appendChild</span><span class="PUNC">(</span><span class="NAME">script</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1593</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1594</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1595</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1596</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>1597</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1598</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1599</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1600</span> 		Stores instances of {@link XF.Component} and its subclasses
<span class='line'>1601</span> 		@memberOf XF
<span class='line'>1602</span> 		@private
<span class='line'>1603</span> 	*/</span><span class="WHIT">
<span class='line'>1604</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">components</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1605</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1606</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1607</span> 		Stores instances of {@link XF.ComponentStatus} - registered Components
<span class='line'>1608</span> 		@memberOf XF
<span class='line'>1609</span> 		@private
<span class='line'>1610</span> 	*/</span><span class="WHIT">
<span class='line'>1611</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">registeredComponents</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1612</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1613</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1614</span> 		Loads component definition if necessary and passes it to callback function
<span class='line'>1615</span> 		@memberOf XF
<span class='line'>1616</span> 		@param {String} compName Component definition name
<span class='line'>1617</span> 		@param {Function} callback Function to be executed when the component definition would be loaded
<span class='line'>1618</span> 		@private
<span class='line'>1619</span> 	*/</span><span class="WHIT">
<span class='line'>1620</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">getComponent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1621</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">compStatus</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1622</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">compStatus</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1623</span> </span><span class="WHIT">			</span><span class="NAME">compStatus</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.registerComponent</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'componentUrlFormatter'</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1624</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1625</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">compStatus.loaded</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1626</span> </span><span class="WHIT">			</span><span class="NAME">callback</span><span class="PUNC">(</span><span class="NAME">compStatus.compDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1627</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1628</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1629</span> 
<span class='line'>1630</span> </span><span class="WHIT">		</span><span class="NAME">compStatus.callbacks.push</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1631</span> 
<span class='line'>1632</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">compStatus.loading</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1633</span> </span><span class="WHIT">			</span><span class="NAME">compStatus.loading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1634</span> </span><span class="WHIT">			</span><span class="NAME">loadScript</span><span class="PUNC">(</span><span class="NAME">compStatus.compSrc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1635</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1636</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1637</span> 
<span class='line'>1638</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1639</span> 		Returns component instance by its id
<span class='line'>1640</span> 		@param {String} compID Component instance id
<span class='line'>1641</span> 		@returns {XF.Component} Appropriate component instance
<span class='line'>1642</span> 		@public
<span class='line'>1643</span> 	*/</span><span class="WHIT">
<span class='line'>1644</span> </span><span class="WHIT">	</span><span class="NAME">XF.getComponentByID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compID</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1645</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">components</span><span class="PUNC">[</span><span class="NAME">compID</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1646</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1647</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1648</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1649</span> 		Registers component source
<span class='line'>1650</span> 		@param {String} compName Component name
<span class='line'>1651</span> 		@param {String} compSrc Component definition source
<span class='line'>1652</span> 		@returns {XF.ComponentStatus} Component status descriptor
<span class='line'>1653</span> 		@public
<span class='line'>1654</span> 	*/</span><span class="WHIT">
<span class='line'>1655</span> </span><span class="WHIT">	</span><span class="NAME">XF.registerComponent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">compSrc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1656</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">compStatus</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1657</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">compStatus</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1658</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">compStatus</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1659</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1660</span> </span><span class="WHIT">		</span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ComponentStatus</span><span class="PUNC">(</span><span class="NAME">compSrc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1661</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1662</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1663</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1664</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1665</span> 		Defines component class and calls registered callbacks if necessary
<span class='line'>1666</span> 		@param {String} compName Component name
<span class='line'>1667</span> 		@param {Object} compDef Component definition
<span class='line'>1668</span> 		@public
<span class='line'>1669</span> 	*/</span><span class="WHIT">
<span class='line'>1670</span> </span><span class="WHIT">	</span><span class="NAME">XF.defineComponent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">compDef</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1671</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">compStatus</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1672</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">compStatus</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1673</span> </span><span class="WHIT">			</span><span class="NAME">compStatus</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ComponentStatus</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1674</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1675</span> 
<span class='line'>1676</span> </span><span class="WHIT">		</span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1677</span> </span><span class="WHIT">		</span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1678</span> </span><span class="WHIT">		</span><span class="NAME">registeredComponents</span><span class="PUNC">[</span><span class="NAME">compName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">compDef</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">compDef</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1679</span> 
<span class='line'>1680</span> </span><span class="WHIT">		</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">compStatus.callbacks.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1681</span> </span><span class="WHIT">			</span><span class="NAME">compStatus.callbacks.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">compStatus.compDef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1682</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1683</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1684</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1685</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1686</span> 		Should invoke component loading & call callback function as soon as component would be available
<span class='line'>1687</span> 		@param {String} compName Component name
<span class='line'>1688</span> 		@param {Function} callback Callback to execute when component definition is ready
<span class='line'>1689</span> 		@public
<span class='line'>1690</span> 	*/</span><span class="WHIT">
<span class='line'>1691</span> </span><span class="WHIT">	</span><span class="NAME">XF.requireComponent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1692</span> </span><span class="WHIT">		</span><span class="NAME">getComponent</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1693</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1694</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1695</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1696</span> 		Stores custom options for {@link XF.Component} or its subclasses instances
<span class='line'>1697</span> 		@memberOf XF
<span class='line'>1698</span> 		@private
<span class='line'>1699</span> 	*/</span><span class="WHIT">
<span class='line'>1700</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">componentOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1701</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1702</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1703</span> 		Defines component instance custom options
<span class='line'>1704</span> 		@param {String} compID Component instance id
<span class='line'>1705</span> 		@param {Object} options Object containing custom options for appropriate component instance
<span class='line'>1706</span> 		@public
<span class='line'>1707</span> 	*/</span><span class="WHIT">
<span class='line'>1708</span> </span><span class="WHIT">	</span><span class="NAME">XF.setOptionsByID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1709</span> </span><span class="WHIT">		</span><span class="NAME">componentOptions</span><span class="PUNC">[</span><span class="NAME">compID</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1710</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1711</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1712</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1713</span> 		Returns custom instance options by component instance ID
<span class='line'>1714</span> 		@memberOf XF
<span class='line'>1715</span> 		@param {String} compID Component instance id
<span class='line'>1716</span> 		@returns {Object} Object containing custom options for appropriate component instance
<span class='line'>1717</span> 		@private
<span class='line'>1718</span> 	*/</span><span class="WHIT">
<span class='line'>1719</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">getOptionsByID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compID</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1720</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">componentOptions</span><span class="PUNC">[</span><span class="NAME">compID</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1721</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1722</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1723</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>1724</span> 
<span class='line'>1725</span> 
<span class='line'>1726</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1727</span> 		Implements basic Events dispatching logic.
<span class='line'>1728</span> 		@class
<span class='line'>1729</span> 	 */</span><span class="WHIT">
<span class='line'>1730</span> </span><span class="WHIT">	</span><span class="NAME">XF.Events</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1731</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1732</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.Events</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.Events# */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1733</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1734</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1735</span> 			Bind an event, specified by a string name, 'ev', to a 'callback' function. Passing 'all' will bind the callback to all events fired.
<span class='line'>1736</span> 			@param {String} ev event name
<span class='line'>1737</span> 			@param {Function} callback function to be called on event trigger
<span class='line'>1738</span> 			@param {Object} context context for function call
<span class='line'>1739</span> 			@return {XF.Events}
<span class='line'>1740</span> 		*/</span><span class="WHIT">
<span class='line'>1741</span> </span><span class="WHIT">		</span><span class="NAME">bind</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1742</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">calls</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._callbacks</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._callbacks</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1743</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">calls</span><span class="PUNC">[</span><span class="NAME">ev</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">calls</span><span class="PUNC">[</span><span class="NAME">ev</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1744</span> </span><span class="WHIT">			</span><span class="NAME">list.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1745</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1746</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1747</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1748</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1749</span> 			Remove one or many callbacks. If 'callback' is null, removes all callbacks for the event. If 'ev' is null, removes all bound callbacks for all events.
<span class='line'>1750</span> 			@param {String} ev event name
<span class='line'>1751</span> 			@param {Function} callback function to be called on event trigger
<span class='line'>1752</span> 			@return {XF.Events}
<span class='line'>1753</span> 		*/</span><span class="WHIT">
<span class='line'>1754</span> </span><span class="WHIT">		</span><span class="NAME">unbind</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1755</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">calls</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1756</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1757</span> </span><span class="WHIT">				</span><span class="NAME">this._callbacks</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1758</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">calls</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._callbacks</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1759</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1760</span> </span><span class="WHIT">					</span><span class="NAME">calls</span><span class="PUNC">[</span><span class="NAME">ev</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1761</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1762</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">calls</span><span class="PUNC">[</span><span class="NAME">ev</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1763</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">list</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1764</span> </span><span class="WHIT">					</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1765</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1766</span> </span><span class="WHIT">							</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1767</span> </span><span class="WHIT">							</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1768</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1769</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1770</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1771</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1772</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1773</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1774</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1775</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1776</span> 			Trigger an event, firing all bound callbacks. Callbacks are passed the same arguments as 'trigger' is, apart from the event name. Listening for 'all' passes the true event name as the first argument.
<span class='line'>1777</span> 			@param {String} eventName event name
<span class='line'>1778</span> 			@return {XF.Events}
<span class='line'>1779</span> 		*/</span><span class="WHIT">
<span class='line'>1780</span> </span><span class="WHIT">		</span><span class="NAME">trigger</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1781</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">calls</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1782</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">both</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1783</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">calls</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._callbacks</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1784</span> </span><span class="WHIT">			</span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">both</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1785</span> </span><span class="WHIT">				</span><span class="NAME">ev</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">both</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'all'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">eventName</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1786</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">calls</span><span class="PUNC">[</span><span class="NAME">ev</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1787</span> </span><span class="WHIT">					</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">l</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1788</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1789</span> </span><span class="WHIT">							</span><span class="NAME">list.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1790</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1791</span> </span><span class="WHIT">							</span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">both</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1792</span> </span><span class="WHIT">							</span><span class="NAME">callback</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1793</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1794</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1795</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1796</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1797</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1798</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1799</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1800</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1801</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1802</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1803</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>1804</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1805</span> 
<span class='line'>1806</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1807</span> 		Instance of {@link XF.HistoryClass}
<span class='line'>1808</span> 		@static
<span class='line'>1809</span> 		@type {XF.HistoryClass}
<span class='line'>1810</span> 	*/</span><span class="WHIT">
<span class='line'>1811</span> </span><span class="WHIT">	</span><span class="NAME">XF.History</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1812</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1813</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1814</span> 		Handles cross-browser history management, based on URL fragments. If the browser does not support 'onhashchange', falls back to polling.
<span class='line'>1815</span> 		@class
<span class='line'>1816</span> 		@private
<span class='line'>1817</span> 	*/</span><span class="WHIT">
<span class='line'>1818</span> </span><span class="WHIT">	</span><span class="NAME">XF.HistoryClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1819</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1820</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1821</span> 			Contains all handlers
<span class='line'>1822</span> 			@type {Object}
<span class='line'>1823</span> 			@private
<span class='line'>1824</span> 		*/</span><span class="WHIT">
<span class='line'>1825</span> </span><span class="WHIT">		</span><span class="NAME">this.handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1826</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1827</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1828</span> 			Indicates whether the history handling has already been started
<span class='line'>1829</span> 			@type {Boolean}
<span class='line'>1830</span> 			@private
<span class='line'>1831</span> 		*/</span><span class="WHIT">
<span class='line'>1832</span> </span><span class="WHIT">		</span><span class="NAME">this.historyStarted</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1833</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1834</span> </span><span class="WHIT">		</span><span class="NAME">_.bindAll</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'checkUrl'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1835</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1836</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1837</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">hashStrip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/^#*/</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1838</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isExplorer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/msie [\w.]+/</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1839</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1840</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1841</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.HistoryClass.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.HistoryClass# */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1842</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1843</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1844</span> 			The default interval to poll for hash changes, if necessary, is twenty times a second.
<span class='line'>1845</span> 		*/</span><span class="WHIT">
<span class='line'>1846</span> </span><span class="WHIT">		</span><span class="NAME">interval</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1847</span> 
<span class='line'>1848</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1849</span> 			Property to store previous route
<span class='line'>1850</span> 		*/</span><span class="WHIT">
<span class='line'>1851</span> </span><span class="WHIT">		</span><span class="NAME">prevFragment</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1852</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1853</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1854</span> 			Get the cross-browser normalized URL fragment, either from the URL, the hash, or the override.
<span class='line'>1855</span> 			@private
<span class='line'>1856</span> 			@param {Object} fragment
<span class='line'>1857</span> 			@param {Boolean} forcePushState
<span class='line'>1858</span> 		*/</span><span class="WHIT">
<span class='line'>1859</span> </span><span class="WHIT">		</span><span class="NAME">getFragment</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">forcePushState</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1860</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1861</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._hasPushState</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">forcePushState</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1862</span> </span><span class="WHIT">					</span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.location.pathname</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1863</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">search</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.location.search</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1864</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">search</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">search</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1865</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fragment.indexOf</span><span class="PUNC">(</span><span class="NAME">this.options.root</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fragment.substr</span><span class="PUNC">(</span><span class="NAME">this.options.root.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1866</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1867</span> </span><span class="WHIT">					</span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.location.hash</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1868</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1869</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1870</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">decodeURIComponent</span><span class="PUNC">(</span><span class="NAME">fragment.replace</span><span class="PUNC">(</span><span class="NAME">hashStrip</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1871</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1872</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1873</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1874</span> 		 	Start the hash change handling, returning 'true' if the current URL matches an existing route, and 'false' otherwise.
<span class='line'>1875</span> 		 	@param
<span class='line'>1876</span> 		*/</span><span class="WHIT">
<span class='line'>1877</span> </span><span class="WHIT">		</span><span class="NAME">start</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1878</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1879</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.historyStarted</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'XF.History has already been started'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1880</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1881</span> </span><span class="WHIT">			</span><span class="NAME">this.options</span><span class="WHIT">          </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">root</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'/'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.options</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1882</span> </span><span class="WHIT">			</span><span class="NAME">this._wantsPushState</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.options.pushState</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1883</span> </span><span class="WHIT">			</span><span class="NAME">this._hasPushState</span><span class="WHIT">    </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.options.pushState</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">window.history</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">window.history.pushState</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1884</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="WHIT">          </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFragment</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1885</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">docMode</span><span class="WHIT">           </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.documentMode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1886</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldIE</span><span class="WHIT">             </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isExplorer.exec</span><span class="PUNC">(</span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">docMode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">docMode</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">7</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1887</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">oldIE</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1888</span> </span><span class="WHIT">				</span><span class="NAME">this.iframe</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'&lt;iframe src="javascript:0" tabindex="-1" />'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">appendTo</span><span class="PUNC">(</span><span class="STRN">'body'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">contentWindow</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1889</span> </span><span class="WHIT">				</span><span class="NAME">this.navigate</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1890</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1891</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1892</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._hasPushState</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1893</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'popstate'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.checkUrl</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1894</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'onhashchange'</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">window</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">oldIE</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1895</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'hashchange'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.checkUrl</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1896</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1897</span> </span><span class="WHIT">				</span><span class="NAME">setInterval</span><span class="PUNC">(</span><span class="NAME">this.checkUrl</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.interval</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1898</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1899</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1900</span> </span><span class="WHIT">			</span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1901</span> </span><span class="WHIT">			</span><span class="NAME">this.historyStarted</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1902</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.location</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1903</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">atRoot</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">loc.pathname</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this.options.root</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1904</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._wantsPushState</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this._hasPushState</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">atRoot</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1905</span> </span><span class="WHIT">				</span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFragment</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1906</span> </span><span class="WHIT">				</span><span class="NAME">window.location.replace</span><span class="PUNC">(</span><span class="NAME">this.options.root</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'#'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1907</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1908</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._wantsPushState</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._hasPushState</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">atRoot</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">loc.hash</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1909</span> </span><span class="WHIT">				</span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">loc.hash.replace</span><span class="PUNC">(</span><span class="NAME">hashStrip</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1910</span> </span><span class="WHIT">				</span><span class="NAME">window.history.replaceState</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">document.title</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">loc.protocol</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'//'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">loc.host</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.options.root</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1911</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1912</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>1913</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.options.silent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1914</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.loadUrl</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1915</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1916</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1917</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1918</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1919</span> 			Add a route to be tested when the fragment changes. Routes added later may override previous routes.
<span class='line'>1920</span> 		*/</span><span class="WHIT">
<span class='line'>1921</span> </span><span class="WHIT">		</span><span class="NAME">route</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">route</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1922</span> </span><span class="WHIT">			</span><span class="NAME">this.handlers.unshift</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">route</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">route</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1923</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1924</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1925</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1926</span> 			Checks the current URL to see if it has changed, and if it has, calls 'loadUrl', normalizing across the hidden iframe.
<span class='line'>1927</span> 			@private
<span class='line'>1928</span> 		*/</span><span class="WHIT">
<span class='line'>1929</span> </span><span class="WHIT">		</span><span class="NAME">checkUrl</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1930</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFragment</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1931</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.iframe</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFragment</span><span class="PUNC">(</span><span class="NAME">this.iframe.location.hash</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1932</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">decodeURIComponent</span><span class="PUNC">(</span><span class="NAME">this.fragment</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1933</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.iframe</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.navigate</span><span class="PUNC">(</span><span class="NAME">current</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1934</span> </span><span class="WHIT">			</span><span class="NAME">this.loadUrl</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.loadUrl</span><span class="PUNC">(</span><span class="NAME">window.location.hash</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1935</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1936</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1937</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1938</span> 			Attempt to load the current URL fragment. If a route succeeds with a match, returns 'true'. If no defined routes matches the fragment, returns 'false'.
<span class='line'>1939</span> 			@private
<span class='line'>1940</span> 		*/</span><span class="WHIT">
<span class='line'>1941</span> </span><span class="WHIT">		</span><span class="NAME">loadUrl</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fragmentOverride</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1942</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFragment</span><span class="PUNC">(</span><span class="NAME">fragmentOverride</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1943</span> 
<span class='line'>1944</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">matched</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.any</span><span class="PUNC">(</span><span class="NAME">this.handlers</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">handler</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1945</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">handler.route.test</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1946</span> </span><span class="WHIT">					</span><span class="NAME">handler.callback</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1947</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1948</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1949</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1950</span> </span><span class="WHIT">			</span><span class="NAME">XF.Utils.AddressBar.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1951</span> </span><span class="WHIT">			</span><span class="NAME">XF.Utils.AddressBar.hideOnLoad</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1952</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">matched</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1953</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1954</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1955</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1956</span> 			Save a fragment into the hash history. You are responsible for properly URL-encoding the fragment in advance. This does not trigger a 'hashchange' event.
<span class='line'>1957</span> 		*/</span><span class="WHIT">
<span class='line'>1958</span> </span><span class="WHIT">		</span><span class="NAME">navigate</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">triggerRoute</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1959</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">frag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="NAME">hashStrip</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1960</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">frag</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">decodeURIComponent</span><span class="PUNC">(</span><span class="NAME">frag</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1961</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._hasPushState</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1962</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.location</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1963</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">frag.indexOf</span><span class="PUNC">(</span><span class="NAME">this.options.root</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">frag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.options.root</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">frag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1964</span> </span><span class="WHIT">				</span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">frag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1965</span> </span><span class="WHIT">				</span><span class="NAME">window.history.pushState</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">document.title</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">loc.protocol</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'//'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">loc.host</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">frag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1966</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1967</span> </span><span class="WHIT">				</span><span class="NAME">window.location.hash</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">frag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1968</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.iframe</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">frag</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this.getFragment</span><span class="PUNC">(</span><span class="NAME">this.iframe.location.hash</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1969</span> </span><span class="WHIT">					</span><span class="NAME">this.iframe.document.open</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1970</span> </span><span class="WHIT">					</span><span class="NAME">this.iframe.location.hash</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">frag</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1971</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1972</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1973</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">triggerRoute</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.loadUrl</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1974</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1975</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>1976</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>1977</span> 			Navigates to previous page in history if possible
<span class='line'>1978</span> 		*/</span><span class="WHIT">
<span class='line'>1979</span> </span><span class="WHIT">		</span><span class="NAME">goBack</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1980</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">window.history</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">window.history.back</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1981</span> </span><span class="WHIT">				</span><span class="NAME">window.history.back</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1982</span> </span><span class="WHIT">				</span><span class="NAME">XF.Utils.AddressBar.hide</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1983</span> </span><span class="WHIT">				</span><span class="NAME">XF.Utils.AddressBar.hideOnLoad</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1984</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1985</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1986</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1987</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1988</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1989</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1990</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>1991</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1992</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>1993</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>1994</span> 		Instance of {@link XF.SettingsClass}
<span class='line'>1995</span> 		@static
<span class='line'>1996</span> 		@type {XF.SettingsClass}
<span class='line'>1997</span> 	 */</span><span class="WHIT">
<span class='line'>1998</span> </span><span class="WHIT">	</span><span class="NAME">XF.Settings</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1999</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2000</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2001</span> 		Takes care of all global application settings
<span class='line'>2002</span> 		@class
<span class='line'>2003</span> 		@private
<span class='line'>2004</span> 		@param {Object} settings Custom settings hash
<span class='line'>2005</span> 	*/</span><span class="WHIT">
<span class='line'>2006</span> </span><span class="WHIT">	</span><span class="NAME">XF.SettingsClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">settings</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2007</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2008</span> 			Contains name-value pairs of all application settings
<span class='line'>2009</span> 			@name XF.Settings#options
<span class='line'>2010</span> 			@type Object
<span class='line'>2011</span> 			@private
<span class='line'>2012</span> 		*/</span><span class="WHIT">
<span class='line'>2013</span> </span><span class="WHIT">		</span><span class="NAME">this.options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.Settings#options */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2014</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2015</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2016</span> 				Used for {@link XF.Cache} clearance when new version released
<span class='line'>2017</span> 				@memberOf XF.Settings.prototype
<span class='line'>2018</span> 				@default '1.0.0'
<span class='line'>2019</span> 				@type String
<span class='line'>2020</span> 			*/</span><span class="WHIT">
<span class='line'>2021</span> </span><span class="WHIT">			</span><span class="NAME">applicationVersion</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'1.0.0'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2022</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2023</span> 				Deactivates cache usage for the whole app (usefull for developement)
<span class='line'>2024</span> 				@memberOf XF.Settings.prototype
<span class='line'>2025</span> 				@default false
<span class='line'>2026</span> 				@type String
<span class='line'>2027</span> 			*/</span><span class="WHIT">
<span class='line'>2028</span> </span><span class="WHIT">			</span><span class="NAME">noCache</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2029</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2030</span> 				Used by default Component URL formatter: prefix + component_name + postfix
<span class='line'>2031</span> 				@memberOf XF.Settings.prototype
<span class='line'>2032</span> 				@default ''
<span class='line'>2033</span> 				@type String
<span class='line'>2034</span> 			*/</span><span class="WHIT">
<span class='line'>2035</span> </span><span class="WHIT">			</span><span class="NAME">componentUrlPrefix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2036</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2037</span> 				Used by default Component URL formatter: prefix + component_name + postfix
<span class='line'>2038</span> 				@memberOf XF.Settings.prototype
<span class='line'>2039</span> 				@default '.js'
<span class='line'>2040</span> 				@type String
<span class='line'>2041</span> 			*/</span><span class="WHIT">
<span class='line'>2042</span> </span><span class="WHIT">			</span><span class="NAME">componentUrlPostfix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'.js'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2043</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2044</span> 				Default Component URL formatter: prefix + component_name + postfix
<span class='line'>2045</span> 				@param {String} compName Component name
<span class='line'>2046</span> 				@memberOf XF.Settings.prototype
<span class='line'>2047</span> 				@returns {String} Component URL
<span class='line'>2048</span> 				@type Function
<span class='line'>2049</span> 			*/</span><span class="WHIT">
<span class='line'>2050</span> </span><span class="WHIT">			</span><span class="NAME">componentUrlFormatter</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2051</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'componentUrlPrefix'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">compName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'componentUrlPostfix'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2052</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2053</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2054</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2055</span> 				Used by default Template URL formatter: prefix + component_name + postfix
<span class='line'>2056</span> 				@memberOf XF.Settings.prototype
<span class='line'>2057</span> 				@default ''
<span class='line'>2058</span> 				@type String
<span class='line'>2059</span> 			*/</span><span class="WHIT">
<span class='line'>2060</span> </span><span class="WHIT">			</span><span class="NAME">templateUrlPrefix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2061</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2062</span> 				Used by default Template URL formatter: prefix + component_name + postfix
<span class='line'>2063</span> 				@memberOf XF.Settings.prototype
<span class='line'>2064</span> 				@default '.tmpl'
<span class='line'>2065</span> 				@type String
<span class='line'>2066</span> 			*/</span><span class="WHIT">
<span class='line'>2067</span> </span><span class="WHIT">			</span><span class="NAME">templateUrlPostfix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'.tmpl'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2068</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2069</span> 				Default Template URL formatter: prefix + component_name + postfix
<span class='line'>2070</span> 				@param {String} compName Component name
<span class='line'>2071</span> 				@returns {String} Template URL
<span class='line'>2072</span> 				@memberOf XF.Settings.prototype
<span class='line'>2073</span> 				@type Function
<span class='line'>2074</span> 			*/</span><span class="WHIT">
<span class='line'>2075</span> </span><span class="WHIT">			</span><span class="NAME">templateUrlFormatter</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">templatePath</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2076</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'templateUrlPrefix'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">templatePath</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">compName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'templateUrlPostfix'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2077</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2078</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2079</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2080</span> 				Used by default Data URL formatter: prefix + component_name + postfix
<span class='line'>2081</span> 				@memberOf XF.Settings.prototype
<span class='line'>2082</span> 				@default ''
<span class='line'>2083</span> 				@type String
<span class='line'>2084</span> 			*/</span><span class="WHIT">
<span class='line'>2085</span> </span><span class="WHIT">			</span><span class="NAME">dataUrlPrefix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2086</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2087</span> 				Used by default Data URL formatter: prefix + component_name + postfix
<span class='line'>2088</span> 				@memberOf XF.Settings.prototype
<span class='line'>2089</span> 				@default '.json'
<span class='line'>2090</span> 				@type String
<span class='line'>2091</span> 			*/</span><span class="WHIT">
<span class='line'>2092</span> </span><span class="WHIT">			</span><span class="NAME">dataUrlPostfix</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'.json'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2093</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2094</span> 				Default Data URL formatter: prefix + component_name + postfix
<span class='line'>2095</span> 				@param {String} compName Component name
<span class='line'>2096</span> 				@returns {String} Template URL
<span class='line'>2097</span> 				@memberOf XF.Settings.prototype
<span class='line'>2098</span> 				@type Function
<span class='line'>2099</span> 			*/</span><span class="WHIT">
<span class='line'>2100</span> </span><span class="WHIT">			</span><span class="NAME">dataUrlFormatter</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2101</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'dataUrlPrefix'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">compName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'dataUrlPostfix'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2102</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2103</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2104</span> 				Used by {@link XF.Touchable}
<span class='line'>2105</span> 				@memberOf XF.Settings.prototype
<span class='line'>2106</span> 				@default 100
<span class='line'>2107</span> 				@type Number
<span class='line'>2108</span> 			*/</span><span class="WHIT">
<span class='line'>2109</span> </span><span class="WHIT">			</span><span class="NAME">touchableSwipeLength</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2110</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2111</span> 				Used by {@link XF.Touchable}
<span class='line'>2112</span> 				@memberOf XF.Settings.prototype
<span class='line'>2113</span> 				@default 700
<span class='line'>2114</span> 				@type Number
<span class='line'>2115</span> 			*/</span><span class="WHIT">
<span class='line'>2116</span> </span><span class="WHIT">			</span><span class="NAME">touchableDoubleTapInterval</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">700</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2117</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2118</span> 				Used by {@link XF.Touchable}
<span class='line'>2119</span> 				@memberOf XF.Settings.prototype
<span class='line'>2120</span> 				@default 300
<span class='line'>2121</span> 				@type Number
<span class='line'>2122</span> 			*/</span><span class="WHIT">
<span class='line'>2123</span> </span><span class="WHIT">			</span><span class="NAME">touchableLongTapInterval</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">500</span><span class="WHIT">
<span class='line'>2124</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2125</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2126</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2127</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.SettingsClass.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.SettingsClass.prototype */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2128</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2129</span> 				Gives a way to set a number of options at a time
<span class='line'>2130</span> 				@param options an object containing properties which would override original ones
<span class='line'>2131</span> 			*/</span><span class="WHIT">
<span class='line'>2132</span> </span><span class="WHIT">			</span><span class="NAME">bulkSet</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2133</span> </span><span class="WHIT">				</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">this.options</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2134</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2135</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2136</span> 				Gets property value by name
<span class='line'>2137</span> 				@param {String} propName
<span class='line'>2138</span> 			*/</span><span class="WHIT">
<span class='line'>2139</span> </span><span class="WHIT">			</span><span class="NAME">getProperty</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">propName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2140</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.options</span><span class="PUNC">[</span><span class="NAME">propName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2141</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2142</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2143</span> 				Sets a new value for one property with
<span class='line'>2144</span> 				@param {String} propName
<span class='line'>2145</span> 				@param {Object} value new value of the property
<span class='line'>2146</span> 			*/</span><span class="WHIT">
<span class='line'>2147</span> </span><span class="WHIT">			</span><span class="NAME">setProperty</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">propName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2148</span> </span><span class="WHIT">				</span><span class="NAME">this.options</span><span class="PUNC">[</span><span class="NAME">propName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2149</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2150</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2151</span> 				Gets or sets property value (depending on whether the 'value' parameter was passed or not)
<span class='line'>2152</span> 				@param {String} propName
<span class='line'>2153</span> 				@param {Object} [value] new value of the property
<span class='line'>2154</span> 			*/</span><span class="WHIT">
<span class='line'>2155</span> </span><span class="WHIT">			</span><span class="NAME">property</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">propName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2156</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2157</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getProperty</span><span class="PUNC">(</span><span class="NAME">propName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2158</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2159</span> </span><span class="WHIT">					</span><span class="NAME">this.setProperty</span><span class="PUNC">(</span><span class="NAME">propName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2160</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2161</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2162</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2163</span> </span><span class="WHIT">	</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2164</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2165</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2166</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>2167</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2168</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2169</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2170</span> 		Instance of {@link XF.CacheClass}
<span class='line'>2171</span> 		@static
<span class='line'>2172</span> 		@private
<span class='line'>2173</span> 		@type {XF.CacheClass}
<span class='line'>2174</span> 	 */</span><span class="WHIT">
<span class='line'>2175</span> </span><span class="WHIT">	</span><span class="NAME">XF.Cache</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2176</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2177</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2178</span> 		Provides localStorage caching API
<span class='line'>2179</span> 		@class
<span class='line'>2180</span> 		@static
<span class='line'>2181</span> 	 */</span><span class="WHIT">
<span class='line'>2182</span> </span><span class="WHIT">	</span><span class="NAME">XF.CacheClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2183</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2184</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2185</span> 			Local reference to the localStorage
<span class='line'>2186</span> 			@type {Object}
<span class='line'>2187</span> 		*/</span><span class="WHIT">
<span class='line'>2188</span> </span><span class="WHIT">		</span><span class="NAME">this.storage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2189</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2190</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2191</span> 			Indicates whether accessibility test for localStorage was passed at launch time
<span class='line'>2192</span> 			@type {Object}
<span class='line'>2193</span> 		*/</span><span class="WHIT">
<span class='line'>2194</span> </span><span class="WHIT">		</span><span class="NAME">this.available</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2195</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2196</span> </span><span class="WHIT">	 </span><span class="WHIT">
<span class='line'>2197</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.CacheClass.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.CacheClass.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2198</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2199</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2200</span> 				Runs accessibility test for localStorage & clears it if the applicationVersion is too old
<span class='line'>2201</span> 			*/</span><span class="WHIT">
<span class='line'>2202</span> </span><span class="WHIT">			</span><span class="NAME">init</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2203</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2204</span> </span><span class="WHIT">				</span><span class="NAME">this.storage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.localStorage</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2205</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>2206</span> </span><span class="WHIT">				</span><span class="COMM">// checking availability</span><span class="WHIT">
<span class='line'>2207</span> </span><span class="WHIT">				</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2208</span> </span><span class="WHIT">					</span><span class="NAME">this.storage.setItem</span><span class="PUNC">(</span><span class="STRN">'check'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'check'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2209</span> </span><span class="WHIT">					</span><span class="NAME">this.storage.removeItem</span><span class="PUNC">(</span><span class="STRN">'check'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2210</span> </span><span class="WHIT">					</span><span class="NAME">this.available</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2211</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2212</span> </span><span class="WHIT">					</span><span class="NAME">this.available</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2213</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2214</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>2215</span> </span><span class="WHIT">				</span><span class="COMM">// clearing localStorage if stored version is different from current</span><span class="WHIT">
<span class='line'>2216</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">appVersion</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'applicationVersion'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2217</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'noCache'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2218</span> </span><span class="WHIT">					</span><span class="COMM">// cache is disable for the whole site manualy</span><span class="WHIT">
<span class='line'>2219</span> </span><span class="WHIT">					</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.Cache :: init - cache is disable for the whole app manually - clearing storage'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2220</span> </span><span class="WHIT">					</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2221</span> </span><span class="WHIT">					</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'applicationVersion'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'applicationVersion'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2222</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">appVersion</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">appVersion</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'applicationVersion'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2223</span> </span><span class="WHIT">					</span><span class="COMM">// same version is cached - useing it as much as possible</span><span class="WHIT">
<span class='line'>2224</span> </span><span class="WHIT">					</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.Cache :: init - same version is cached - useing it as much as possible'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2225</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2226</span> </span><span class="WHIT">					</span><span class="COMM">// wrong or no version cached - clearing storage</span><span class="WHIT">
<span class='line'>2227</span> </span><span class="WHIT">					</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.Cache :: init - wrong or no version cached - clearing storage'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2228</span> </span><span class="WHIT">					</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2229</span> </span><span class="WHIT">					</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'applicationVersion'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'applicationVersion'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2230</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2231</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2232</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2233</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2234</span> 				Returns a value stored in cache under appropriate key
<span class='line'>2235</span> 				@param {String} key 
<span class='line'>2236</span> 				@return {String}
<span class='line'>2237</span> 			*/</span><span class="WHIT">
<span class='line'>2238</span> </span><span class="WHIT">			</span><span class="NAME">get</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2239</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2240</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.available</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2241</span> </span><span class="WHIT">					</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2242</span> </span><span class="WHIT">						</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.storage.getItem</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2243</span> </span><span class="WHIT">						</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.Cache :: get - "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'" = "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2244</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2245</span> </span><span class="WHIT">						</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2246</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2247</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2248</span> </span><span class="WHIT">					</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2249</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2250</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2251</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2252</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2253</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2254</span> 				Sets a value stored in cache under appropriate key
<span class='line'>2255</span> 				@param {String} key 
<span class='line'>2256</span> 				@param {String} value
<span class='line'>2257</span> 				@return {Boolean} success indicator
<span class='line'>2258</span> 			*/</span><span class="WHIT">
<span class='line'>2259</span> </span><span class="WHIT">			</span><span class="NAME">set</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2260</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2261</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.available</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2262</span> </span><span class="WHIT">					</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2263</span> </span><span class="WHIT">						</span><span class="NAME">this.storage.setItem</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2264</span> </span><span class="WHIT">						</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2265</span> </span><span class="WHIT">						</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.Cache :: set - "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'" = "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2266</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2267</span> </span><span class="WHIT">						</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2268</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2269</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2270</span> </span><span class="WHIT">					</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2271</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2272</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2273</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2274</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2275</span> </span><span class="WHIT">			</span><span class="COMM">/**
<span class='line'>2276</span> 				Clears localStorage
<span class='line'>2277</span> 				@return {Boolean} success indicator
<span class='line'>2278</span> 			*/</span><span class="WHIT">
<span class='line'>2279</span> </span><span class="WHIT">			</span><span class="NAME">clear</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2280</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2281</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.available</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2282</span> </span><span class="WHIT">					</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2283</span> </span><span class="WHIT">						</span><span class="NAME">this.storage.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2284</span> </span><span class="WHIT">						</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2285</span> </span><span class="WHIT">						</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.Cache :: clear'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2286</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2287</span> </span><span class="WHIT">						</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2288</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2289</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2290</span> </span><span class="WHIT">					</span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2291</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2292</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2293</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2294</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2295</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2296</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2297</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2298</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>2299</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2300</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2301</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2302</span> 		Instance of {@link XF.ControllerClass}
<span class='line'>2303</span> 		@static
<span class='line'>2304</span> 		@type {XF.ControllerClass}
<span class='line'>2305</span> 	 */</span><span class="WHIT">
<span class='line'>2306</span> </span><span class="WHIT">	</span><span class="NAME">XF.Controller</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2307</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2308</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2309</span> 		Represents general Application settings. Extends {@link XF.Events}
<span class='line'>2310</span> 		@class
<span class='line'>2311</span> 		@static
<span class='line'>2312</span> 		@augments XF.Events
<span class='line'>2313</span> 	 */</span><span class="WHIT">
<span class='line'>2314</span> </span><span class="WHIT">	</span><span class="NAME">XF.ControllerClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2315</span> </span><span class="WHIT">	 </span><span class="WHIT">
<span class='line'>2316</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.ControllerClass.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Events</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2317</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2318</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2319</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>2320</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2321</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2322</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2323</span> 		Instance of {@link XF.RouterClass}
<span class='line'>2324</span> 		@static
<span class='line'>2325</span> 		@type {XF.Router}
<span class='line'>2326</span> 	*/</span><span class="WHIT">
<span class='line'>2327</span> </span><span class="WHIT">	</span><span class="NAME">XF.Router</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2328</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2329</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2330</span> 		Implements Routing.
<span class='line'>2331</span> 		@class
<span class='line'>2332</span> 		@static
<span class='line'>2333</span> 		@augments XF.Events
<span class='line'>2334</span> 		@param {Object} routes routes has map
<span class='line'>2335</span> 		@param {Object} handlers handlers has map
<span class='line'>2336</span> 	*/</span><span class="WHIT">
<span class='line'>2337</span> </span><span class="WHIT">	</span><span class="NAME">XF.RouterClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">routes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2338</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2339</span> 			Contains all routes definitions
<span class='line'>2340</span> 			@type {Object}
<span class='line'>2341</span> 		*/</span><span class="WHIT">
<span class='line'>2342</span> </span><span class="WHIT">		</span><span class="NAME">this.routes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">routes</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2343</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2344</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2345</span> 			Contains all routes definitions
<span class='line'>2346</span> 			@type {Object}
<span class='line'>2347</span> 		*/</span><span class="WHIT">
<span class='line'>2348</span> </span><span class="WHIT">		</span><span class="NAME">this.handlers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">handlers</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2349</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2350</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2351</span> 			Saves the latest route dispatched
<span class='line'>2352</span> 			@type Object
<span class='line'>2353</span> 			@private
<span class='line'>2354</span> 		*/</span><span class="WHIT">
<span class='line'>2355</span> </span><span class="WHIT">		</span><span class="NAME">this.mostRecentCalled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2356</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2357</span> </span><span class="WHIT">		</span><span class="NAME">this.initialize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2358</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2359</span> 
<span class='line'>2360</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">namedParam</span><span class="WHIT">    </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/:([\w\d]+)/g</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2361</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">splatParam</span><span class="WHIT">    </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/\*([\w\d]+)/g</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2362</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">escapeRegExp</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/[-[\]{}()+?.,\\^$|#\s]/g</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2363</span> 
<span class='line'>2364</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.RouterClass.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Events</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.RouterClass.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2365</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2366</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2367</span> 			Manually bind a single named route to a callback.
<span class='line'>2368</span> 			@param {String} route route pattern
<span class='line'>2369</span> 			@param {String} name route name
<span class='line'>2370</span> 			@param {Function} callback
<span class='line'>2371</span> 			@private
<span class='line'>2372</span> 		*/</span><span class="WHIT">
<span class='line'>2373</span> </span><span class="WHIT">		</span><span class="NAME">route</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">route</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2374</span> </span><span class="WHIT">			</span><span class="NAME">XF.History</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">XF.History</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.HistoryClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2375</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2376</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_.isRegExp</span><span class="PUNC">(</span><span class="NAME">route</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">route</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.routeToRegExp</span><span class="PUNC">(</span><span class="NAME">route</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2377</span> </span><span class="WHIT">			</span><span class="NAME">XF.History.route</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>2378</span> </span><span class="WHIT">				</span><span class="NAME">route</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2379</span> </span><span class="WHIT">				</span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>2380</span> </span><span class="WHIT">					</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2381</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.extractParameters</span><span class="PUNC">(</span><span class="NAME">route</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2382</span> </span><span class="WHIT">						</span><span class="NAME">callback.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2383</span> </span><span class="WHIT">						</span><span class="NAME">this.trigger.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'route:'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2384</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2385</span> </span><span class="WHIT">					</span><span class="KEYW">this</span><span class="WHIT">
<span class='line'>2386</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>2387</span> </span><span class="WHIT">			</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2388</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2389</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2390</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2391</span> 			Simple proxy to 'XF.History' to save a fragment into the history.
<span class='line'>2392</span> 			@params {Object} fragment
<span class='line'>2393</span> 			@params {Object} triggerRoute
<span class='line'>2394</span> 		*/</span><span class="WHIT">
<span class='line'>2395</span> </span><span class="WHIT">		</span><span class="NAME">navigate</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">triggerRoute</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2396</span> </span><span class="WHIT">			</span><span class="NAME">XF.History.navigate</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">triggerRoute</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2397</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2398</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2399</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2400</span> 			Convert a route string into a regular expression, suitable for matching against the current location hash.
<span class='line'>2401</span> 			@param {String} route route pattern
<span class='line'>2402</span> 			@return {RegExp}
<span class='line'>2403</span> 			@private
<span class='line'>2404</span> 		*/</span><span class="WHIT">
<span class='line'>2405</span> </span><span class="WHIT">		</span><span class="NAME">routeToRegExp</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">route</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2406</span> </span><span class="WHIT">			</span><span class="NAME">route</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">route.replace</span><span class="PUNC">(</span><span class="NAME">escapeRegExp</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'\\$&'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>2407</span> </span><span class="WHIT">			   </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="NAME">namedParam</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'([^\/]*)'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>2408</span> </span><span class="WHIT">			   </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="NAME">splatParam</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'(.*?)'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2409</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">'^'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">route</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'$'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2410</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2411</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2412</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2413</span> 			Given a route, and a URL fragment that it matches, return the array of extracted parameters.
<span class='line'>2414</span> 			@param {RegExp} route route pattern
<span class='line'>2415</span> 			@param {Object} fragment
<span class='line'>2416</span> 			@return {String}
<span class='line'>2417</span> 			@private
<span class='line'>2418</span> 		*/</span><span class="WHIT">
<span class='line'>2419</span> </span><span class="WHIT">		</span><span class="NAME">extractParameters</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">route</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2420</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">route.exec</span><span class="PUNC">(</span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2421</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2422</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2423</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2424</span> 			Initializes routers, creates handlers and proxy handlers to track {@link XF.RouterClass#mostRecentCalled}
<span class='line'>2425</span> 			@private
<span class='line'>2426</span> 		*/</span><span class="WHIT">
<span class='line'>2427</span> </span><span class="WHIT">		</span><span class="NAME">initialize</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2428</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2429</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2430</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2431</span> </span><span class="WHIT">			</span><span class="COMM">// adding 'notFound' route</span><span class="WHIT">
<span class='line'>2432</span> </span><span class="WHIT">			</span><span class="NAME">this.route</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">'.*'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'g'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'notFound'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2433</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$this</span><span class="PUNC">[</span><span class="STRN">'notFound'</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2434</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2435</span> </span><span class="WHIT">					</span><span class="NAME">callback.apply</span><span class="PUNC">(</span><span class="NAME">$this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2436</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2437</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2438</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2439</span> </span><span class="WHIT">			</span><span class="COMM">// adding rest routes</span><span class="WHIT">
<span class='line'>2440</span> </span><span class="WHIT">			</span><span class="NAME">$.each</span><span class="PUNC">(</span><span class="NAME">this.routes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">routeDef</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">routeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2441</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">proxyCallback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2442</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$this.handlers</span><span class="PUNC">[</span><span class="NAME">routeName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2443</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2444</span> </span><span class="WHIT">						</span><span class="NAME">callback.apply</span><span class="PUNC">(</span><span class="NAME">$this.handlers</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2445</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2446</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>2447</span> </span><span class="WHIT">					</span><span class="NAME">$this.mostRecentCalled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2448</span> </span><span class="WHIT">						</span><span class="NAME">name</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">routeName</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2449</span> </span><span class="WHIT">						</span><span class="NAME">args</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="WHIT">
<span class='line'>2450</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2451</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2452</span> </span><span class="WHIT">				</span><span class="NAME">$this.route</span><span class="PUNC">(</span><span class="NAME">routeDef</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">routeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">proxyCallback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2453</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2454</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2455</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2456</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2457</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2458</span> 			Initiates Rounting & history listening
<span class='line'>2459</span> 			@private
<span class='line'>2460</span> 		*/</span><span class="WHIT">
<span class='line'>2461</span> </span><span class="WHIT">		</span><span class="NAME">start</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2462</span> </span><span class="WHIT">			</span><span class="NAME">XF.History.start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2463</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2464</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2465</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2466</span> 			Binds a callback to approppriate route
<span class='line'>2467</span> 			@param {String} routeName Route name
<span class='line'>2468</span> 			@param {Function} callback A function to be called when route is visited
<span class='line'>2469</span> 		*/</span><span class="WHIT">
<span class='line'>2470</span> </span><span class="WHIT">		</span><span class="NAME">bindRoute</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">routeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2471</span> </span><span class="WHIT">			</span><span class="NAME">this.bind</span><span class="PUNC">(</span><span class="STRN">'route:'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">routeName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2472</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2473</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.mostRecentCalled</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.mostRecentCalled.name</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">routeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2474</span> </span><span class="WHIT">				</span><span class="NAME">callback</span><span class="PUNC">(</span><span class="NAME">this.mostRecentCalled.args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2475</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2476</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2477</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2478</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2479</span> 			Binds a callback to any route
<span class='line'>2480</span> 			@param {Function} callback A function to be called when any route is visited
<span class='line'>2481</span> 		*/</span><span class="WHIT">
<span class='line'>2482</span> </span><span class="WHIT">		</span><span class="NAME">bindAnyRoute</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2483</span> </span><span class="WHIT">			</span><span class="NAME">this.bind</span><span class="PUNC">(</span><span class="STRN">'all'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2484</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.mostRecentCalled</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2485</span> </span><span class="WHIT">				</span><span class="NAME">callback</span><span class="PUNC">(</span><span class="NAME">this.mostRecentCalled.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2486</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2487</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2488</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2489</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2490</span> 			Returns route string by givven router event name
<span class='line'>2491</span> 			@param String eventName
<span class='line'>2492</span> 			@return String
<span class='line'>2493</span> 		*/</span><span class="WHIT">
<span class='line'>2494</span> </span><span class="WHIT">		</span><span class="NAME">getRouteByEventName</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2495</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">eventName.replace</span><span class="PUNC">(</span><span class="STRN">'route:'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2496</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2497</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2498</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2499</span> </span><span class="WHIT">	</span><span class="NAME">XF.RouterClass.extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">extend</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2500</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2501</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2502</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>2503</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2504</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2505</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2506</span> 		Base Component.
<span class='line'>2507</span> 		@class
<span class='line'>2508</span> 		@static
<span class='line'>2509</span> 		@augments XF.Events
<span class='line'>2510</span> 		@see &lt;a href="http://documentcloud.github.com/backbone/#Events">XF.Events Documentation&lt;/a>
<span class='line'>2511</span> 		@param {String} name Name of the component
<span class='line'>2512</span> 		@param {String} id ID of the component instance
<span class='line'>2513</span> 	 */</span><span class="WHIT">
<span class='line'>2514</span> </span><span class="WHIT">	</span><span class="NAME">XF.Component</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2515</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2516</span> 			Would be dispatched once when the Component inited
<span class='line'>2517</span> 			@name XF.Component#init
<span class='line'>2518</span> 			@event
<span class='line'>2519</span> 		*/</span><span class="WHIT">
<span class='line'>2520</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2521</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2522</span> 			Would be dispatched once when the Component constructed
<span class='line'>2523</span> 			@name XF.Component#construct
<span class='line'>2524</span> 			@event
<span class='line'>2525</span> 		*/</span><span class="WHIT">
<span class='line'>2526</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2527</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2528</span> 			Would be dispatched after each render
<span class='line'>2529</span> 			@name XF.Component#refresh
<span class='line'>2530</span> 			@event
<span class='line'>2531</span> 		*/</span><span class="WHIT">
<span class='line'>2532</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2533</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2534</span> 			Name of the component.
<span class='line'>2535</span> 			@default 'default_name'
<span class='line'>2536</span> 			@type String
<span class='line'>2537</span> 		*/</span><span class="WHIT">
<span class='line'>2538</span> </span><span class="WHIT">		</span><span class="NAME">this.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'default_name'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2539</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2540</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2541</span> 			ID of the component.
<span class='line'>2542</span> 			@default 'default_id'
<span class='line'>2543</span> 			@type String
<span class='line'>2544</span> 		*/</span><span class="WHIT">
<span class='line'>2545</span> </span><span class="WHIT">		</span><span class="NAME">this.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'default_id'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2546</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2547</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2548</span> 			Flag which defines whether the component was rendered atleast once
<span class='line'>2549</span> 			@type Boolean
<span class='line'>2550</span> 		*/</span><span class="WHIT">
<span class='line'>2551</span> </span><span class="WHIT">		</span><span class="NAME">this.rendered</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2552</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2553</span> </span><span class="WHIT">		</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>2554</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">firstRender</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2555</span> </span><span class="WHIT">			</span><span class="NAME">this.unbind</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">firstRender</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2556</span> </span><span class="WHIT">			</span><span class="NAME">this.rendered</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2557</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2558</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2559</span> </span><span class="WHIT">		</span><span class="NAME">this.bind</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">firstRender</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2560</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2561</span> </span><span class="WHIT">		</span><span class="COMM">// merging defaults with custom instance options </span><span class="WHIT">
<span class='line'>2562</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">defaultOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.options</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2563</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">instanceOptions</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">getOptionsByID</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2564</span> </span><span class="WHIT">		</span><span class="NAME">this.options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.defaults</span><span class="PUNC">(</span><span class="NAME">instanceOptions</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">defaultOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2565</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2566</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2567</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2568</span> 		Component template
<span class='line'>2569</span> 		@type String
<span class='line'>2570</span> 		@static
<span class='line'>2571</span> 	 */</span><span class="WHIT">
<span class='line'>2572</span> </span><span class="WHIT">	</span><span class="NAME">XF.Component.template</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2573</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2574</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2575</span> 		The URL of template that is currently being loaded
<span class='line'>2576</span> 		@type String
<span class='line'>2577</span> 		@private
<span class='line'>2578</span> 		@static
<span class='line'>2579</span> 	 */</span><span class="WHIT">
<span class='line'>2580</span> </span><span class="WHIT">	</span><span class="NAME">XF.Component.templateURL</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2581</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2582</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2583</span> 		A flag that indiacates whether that template is currently being loaded
<span class='line'>2584</span> 		@type Boolean
<span class='line'>2585</span> 		@private
<span class='line'>2586</span> 		@static
<span class='line'>2587</span> 	 */</span><span class="WHIT">
<span class='line'>2588</span> </span><span class="WHIT">	</span><span class="NAME">XF.Component.templateLoaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2589</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2590</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2591</span> 		A flag that indiacates whether that template was successfully loaded
<span class='line'>2592</span> 		@type Boolean
<span class='line'>2593</span> 		@private
<span class='line'>2594</span> 		@static
<span class='line'>2595</span> 	 */</span><span class="WHIT">
<span class='line'>2596</span> </span><span class="WHIT">	</span><span class="NAME">XF.Component.templateLoading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2597</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2598</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2599</span> 		Compiled component template
<span class='line'>2600</span> 		@type Function
<span class='line'>2601</span> 		@static
<span class='line'>2602</span> 	 */</span><span class="WHIT">
<span class='line'>2603</span> </span><span class="WHIT">	</span><span class="NAME">XF.Component.compiledTemplate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2604</span> 
<span class='line'>2605</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.Component.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Events</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2606</span> 
<span class='line'>2607</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.Component.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.Component.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2608</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2609</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2610</span> 			Object containing has-map of component options that can be different for each instance & should be set with {@link XF.setOptionsByID}
<span class='line'>2611</span> 			@type Object
<span class='line'>2612</span> 		*/</span><span class="WHIT">
<span class='line'>2613</span> </span><span class="WHIT">		</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2614</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2615</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2616</span> 			Defenition of custom Model class extending {@link XF.Model}
<span class='line'>2617</span> 		*/</span><span class="WHIT">
<span class='line'>2618</span> </span><span class="WHIT">		</span><span class="NAME">modelClass</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">XF.Model</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2619</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2620</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2621</span> 			Instance of {@link XF.Model} or its subclass
<span class='line'>2622</span> 			@type XF.Model
<span class='line'>2623</span> 		*/</span><span class="WHIT">
<span class='line'>2624</span> </span><span class="WHIT">		</span><span class="NAME">model</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2625</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2626</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2627</span> 			Defenition of custom View class extending {@link XF.View}
<span class='line'>2628</span> 		*/</span><span class="WHIT">
<span class='line'>2629</span> </span><span class="WHIT">		</span><span class="NAME">viewClass</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">XF.View</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2630</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2631</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2632</span> 			Instance of {@link XF.View} or its subclass
<span class='line'>2633</span> 			@type XF.View
<span class='line'>2634</span> 		*/</span><span class="WHIT">
<span class='line'>2635</span> </span><span class="WHIT">		</span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2636</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2637</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2638</span> 			Constructs component instance
<span class='line'>2639</span> 			@private
<span class='line'>2640</span> 		*/</span><span class="WHIT">
<span class='line'>2641</span> </span><span class="WHIT">		</span><span class="NAME">construct</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2642</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2643</span> </span><span class="WHIT">			</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>2644</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">viewConstructed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2645</span> </span><span class="WHIT">				</span><span class="NAME">this.view.unbind</span><span class="PUNC">(</span><span class="STRN">'construct'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">viewConstructed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2646</span> </span><span class="WHIT">				</span><span class="NAME">this.afterConstructView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2647</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>2648</span> </span><span class="WHIT">				</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2649</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'init'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2650</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>2651</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'construct'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2652</span> </span><span class="WHIT">				</span><span class="NAME">XF.Controller.trigger</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">':constructed'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2653</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2654</span> </span><span class="WHIT">			</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>2655</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">modelConstructed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2656</span> </span><span class="WHIT">				</span><span class="NAME">this.model.unbind</span><span class="PUNC">(</span><span class="STRN">'construct'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">modelConstructed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2657</span> </span><span class="WHIT">				</span><span class="NAME">this.afterConstructModel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2658</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>2659</span> </span><span class="WHIT">				</span><span class="NAME">this.beforeConstructView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2660</span> </span><span class="WHIT">				</span><span class="NAME">this.constructView</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2661</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>2662</span> </span><span class="WHIT">				</span><span class="NAME">this.view.bind</span><span class="PUNC">(</span><span class="STRN">'construct'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">viewConstructed</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2663</span> </span><span class="WHIT">				</span><span class="NAME">this.view.construct</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2664</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2665</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2666</span> </span><span class="WHIT">			</span><span class="NAME">this.beforeConstructModel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2667</span> </span><span class="WHIT">			</span><span class="NAME">this.constructModel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2668</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2669</span> </span><span class="WHIT">			</span><span class="NAME">this.model.bind</span><span class="PUNC">(</span><span class="STRN">'construct'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">modelConstructed</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2670</span> </span><span class="WHIT">			</span><span class="NAME">this.model.construct</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2671</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2672</span> </span><span class="WHIT">			</span><span class="NAME">this.childComponent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2673</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2674</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2675</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2676</span> 			Returns component selector
<span class='line'>2677</span> 			@return {String} Selector string that can be used for jQuery.find() for example
<span class='line'>2678</span> 		*/</span><span class="WHIT">
<span class='line'>2679</span> </span><span class="WHIT">		</span><span class="NAME">selector</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2680</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'[data-id='</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2681</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2682</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2683</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2684</span> 			HOOK: override to add logic before view construction
<span class='line'>2685</span> 		*/</span><span class="WHIT">
<span class='line'>2686</span> </span><span class="WHIT">		</span><span class="NAME">beforeConstructView</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2687</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2688</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2689</span> 			Constructs {@link XF.View} object
<span class='line'>2690</span> 			@private
<span class='line'>2691</span> 		*/</span><span class="WHIT">
<span class='line'>2692</span> </span><span class="WHIT">		</span><span class="NAME">constructView</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2693</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.view</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.view</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">XF.View</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2694</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.viewClass</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2695</span> </span><span class="WHIT">					</span><span class="NAME">this.view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">this.viewClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2696</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.view</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">XF.View</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2697</span> </span><span class="WHIT">						</span><span class="NAME">this.view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.View</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2698</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2699</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2700</span> </span><span class="WHIT">					</span><span class="NAME">this.view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.View</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2701</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2702</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2703</span> </span><span class="WHIT">			</span><span class="NAME">this.view.component</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2704</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2705</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2706</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2707</span> 			HOOK: override to add logic after view construction
<span class='line'>2708</span> 		*/</span><span class="WHIT">
<span class='line'>2709</span> </span><span class="WHIT">		</span><span class="NAME">afterConstructView</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2710</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2711</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2712</span> 			HOOK: override to add logic before model construction
<span class='line'>2713</span> 		*/</span><span class="WHIT">
<span class='line'>2714</span> </span><span class="WHIT">		</span><span class="NAME">beforeConstructModel</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2715</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2716</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2717</span> 			Constructs {@link XF.Model} object
<span class='line'>2718</span> 			@private
<span class='line'>2719</span> 		*/</span><span class="WHIT">
<span class='line'>2720</span> </span><span class="WHIT">		</span><span class="NAME">constructModel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2721</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.model</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.model</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">XF.Model</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2722</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.modelClass</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2723</span> </span><span class="WHIT">					</span><span class="NAME">this.model</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">this.modelClass</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2724</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.model</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">XF.Model</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2725</span> </span><span class="WHIT">						</span><span class="NAME">this.model</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.Model</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2726</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2727</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2728</span> </span><span class="WHIT">					</span><span class="NAME">this.model</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.Model</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2729</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2730</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2731</span> </span><span class="WHIT">			</span><span class="NAME">this.model.component</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2732</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2733</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2734</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2735</span> 			HOOK: override to add logic after model construction
<span class='line'>2736</span> 		*/</span><span class="WHIT">
<span class='line'>2737</span> </span><span class="WHIT">		</span><span class="NAME">afterConstructModel</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2738</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2739</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2740</span> 			HOOK: override to add custom logic. Default behavior is to call {@link XF.Component#refresh}
<span class='line'>2741</span> 		*/</span><span class="WHIT">
<span class='line'>2742</span> </span><span class="WHIT">		</span><span class="NAME">init</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2743</span> </span><span class="WHIT">			</span><span class="NAME">this.refresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2744</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2745</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2746</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2747</span> 			Refreshes model data and then rerenders view
<span class='line'>2748</span> 			@private
<span class='line'>2749</span> 		*/</span><span class="WHIT">
<span class='line'>2750</span> </span><span class="WHIT">		</span><span class="NAME">refresh</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2751</span> </span><span class="WHIT">			</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>2752</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">onModelRefresh</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2753</span> </span><span class="WHIT">				</span><span class="NAME">this.model.unbind</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">onModelRefresh</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2754</span> </span><span class="WHIT">				</span><span class="NAME">this.view.refresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2755</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2756</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2757</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2758</span> </span><span class="WHIT">			</span><span class="NAME">this.model.bind</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">onModelRefresh</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2759</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>2760</span> </span><span class="WHIT">			</span><span class="NAME">this.model.refresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2761</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2762</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2763</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2764</span> 			A wrapper that allows to set some callbacks to be called after the component was first rendered
<span class='line'>2765</span> 			@param {Function} callback A callback that would be invoked right after component's first render or right after method invocation if the component has already been rendered
<span class='line'>2766</span> 		*/</span><span class="WHIT">
<span class='line'>2767</span> </span><span class="WHIT">		</span><span class="NAME">ready</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2768</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.rendered</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2769</span> </span><span class="WHIT">				</span><span class="NAME">callback</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2770</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2771</span> </span><span class="WHIT">				</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>2772</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">firstRender</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2773</span> </span><span class="WHIT">					</span><span class="NAME">this.unbind</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">firstRender</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2774</span> 
<span class='line'>2775</span> </span><span class="WHIT">					</span><span class="NAME">callback</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2776</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2777</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>2778</span> </span><span class="WHIT">				</span><span class="NAME">this.bind</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">firstRender</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2779</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2780</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2781</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2782</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2783</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2784</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2785</span> 		This method allows to extend XF.Component with saving the whole prototype chain
<span class='line'>2786</span> 		@function
<span class='line'>2787</span> 		@static
<span class='line'>2788</span> 	*/</span><span class="WHIT">
<span class='line'>2789</span> </span><span class="WHIT">	</span><span class="NAME">XF.Component.extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">extend</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2790</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2791</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2792</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>2793</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2794</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2795</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2796</span> 		Describes current component definition status
<span class='line'>2797</span> 		@class
<span class='line'>2798</span> 		@private
<span class='line'>2799</span> 		@memberOf XF
<span class='line'>2800</span> 		@param {String} compSrc Component definition source
<span class='line'>2801</span> 	*/</span><span class="WHIT">
<span class='line'>2802</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ComponentStatus</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">compSrc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2803</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2804</span> 			Component definition source
<span class='line'>2805</span> 			@private
<span class='line'>2806</span> 			@type String
<span class='line'>2807</span> 		*/</span><span class="WHIT">
<span class='line'>2808</span> </span><span class="WHIT">		</span><span class="NAME">this.compSrc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">compSrc</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2809</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2810</span> 			Component definition
<span class='line'>2811</span> 			@private
<span class='line'>2812</span> 			@type XF.Component
<span class='line'>2813</span> 		*/</span><span class="WHIT">
<span class='line'>2814</span> </span><span class="WHIT">		</span><span class="NAME">this.compDef</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2815</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2816</span> 			Flag that determines whether the component definition is currently being loaded
<span class='line'>2817</span> 			@private
<span class='line'>2818</span> 			@type Boolean
<span class='line'>2819</span> 		*/</span><span class="WHIT">
<span class='line'>2820</span> </span><span class="WHIT">		</span><span class="NAME">this.loading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2821</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2822</span> 			Flag that determines whether the component definition has already been loaded
<span class='line'>2823</span> 			@private
<span class='line'>2824</span> 			@type Boolean
<span class='line'>2825</span> 		*/</span><span class="WHIT">
<span class='line'>2826</span> </span><span class="WHIT">		</span><span class="NAME">this.loaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2827</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2828</span> 			A list of callbacks to call on component definition loading complete
<span class='line'>2829</span> 			@private
<span class='line'>2830</span> 			@type String[]
<span class='line'>2831</span> 		*/</span><span class="WHIT">
<span class='line'>2832</span> </span><span class="WHIT">		</span><span class="NAME">this.callbacks</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2833</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2834</span> 
<span class='line'>2835</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2836</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>2837</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2838</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2839</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>2840</span> 		Implements data workaround flow.
<span class='line'>2841</span> 		@class
<span class='line'>2842</span> 		@static
<span class='line'>2843</span> 		@augments XF.Events
<span class='line'>2844</span> 		@param {Object} attributes list of predefined attributes
<span class='line'>2845</span> 	 */</span><span class="WHIT">
<span class='line'>2846</span> </span><span class="WHIT">	</span><span class="NAME">XF.Model</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2847</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2848</span> 			Would be dispatched once when the Component inited
<span class='line'>2849</span> 			@name XF.Model#init
<span class='line'>2850</span> 			@event
<span class='line'>2851</span> 		*/</span><span class="WHIT">
<span class='line'>2852</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2853</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2854</span> 			Would be dispatched once when the Component constructed
<span class='line'>2855</span> 			@name XF.Model#construct
<span class='line'>2856</span> 			@event
<span class='line'>2857</span> 		*/</span><span class="WHIT">
<span class='line'>2858</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2859</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2860</span> 			Would be dispatched after each data update
<span class='line'>2861</span> 			@name XF.Model#dataLoaded
<span class='line'>2862</span> 			@event
<span class='line'>2863</span> 		*/</span><span class="WHIT">
<span class='line'>2864</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2865</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2866</span> 			Would be dispatched after each update
<span class='line'>2867</span> 			@name XF.Model#refresh
<span class='line'>2868</span> 			@event
<span class='line'>2869</span> 		*/</span><span class="WHIT">
<span class='line'>2870</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2871</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2872</span> 			Link to the {@link XF.Component} instance
<span class='line'>2873</span> 			@type XF.Component
<span class='line'>2874</span> 		*/</span><span class="WHIT">
<span class='line'>2875</span> </span><span class="WHIT">		</span><span class="NAME">this.component</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2876</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2877</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2878</span> 			Object that contains plan data recieved from server
<span class='line'>2879</span> 			@type Object
<span class='line'>2880</span> 		*/</span><span class="WHIT">
<span class='line'>2881</span> </span><span class="WHIT">		</span><span class="NAME">this.rawData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2882</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2883</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2884</span> 			Object that contains all nema-value pairs for properties created via {@link XF.Model#set} or passed to constructor
<span class='line'>2885</span> 			@type Object
<span class='line'>2886</span> 		*/</span><span class="WHIT">
<span class='line'>2887</span> </span><span class="WHIT">		</span><span class="NAME">this.attributes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2888</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2889</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2890</span> 			Object that contains a snapshot of {@link XF.Model#attributes} created before some attribute was changed
<span class='line'>2891</span> 			@type Object
<span class='line'>2892</span> 		*/</span><span class="WHIT">
<span class='line'>2893</span> </span><span class="WHIT">		</span><span class="NAME">this._previousAttributes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2894</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2895</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2896</span> 			A flag that indicates whether any of attributes has been changed
<span class='line'>2897</span> 			@type Boolean
<span class='line'>2898</span> 			@default false
<span class='line'>2899</span> 			@private
<span class='line'>2900</span> 		*/</span><span class="WHIT">
<span class='line'>2901</span> </span><span class="WHIT">		</span><span class="NAME">this._changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2902</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2903</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>2904</span> </span><span class="WHIT">		</span><span class="COMM">// getting initial attrbute values</span><span class="WHIT">
<span class='line'>2905</span> </span><span class="WHIT">		</span><span class="NAME">attributes</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attributes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2906</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">defaults</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.defaults</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2907</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">defaults</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2908</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_.isFunction</span><span class="PUNC">(</span><span class="NAME">defaults</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2909</span> </span><span class="WHIT">				</span><span class="NAME">defaults</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">defaults.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2910</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2911</span> </span><span class="WHIT">			</span><span class="NAME">attributes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">defaults</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2912</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2913</span> </span><span class="WHIT">		</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">attributes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">silent</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2914</span> </span><span class="WHIT">		</span><span class="NAME">this._changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2915</span> </span><span class="WHIT">		</span><span class="NAME">this._previousAttributes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.clone</span><span class="PUNC">(</span><span class="NAME">this.attributes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2916</span> 
<span class='line'>2917</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2918</span> 
<span class='line'>2919</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.Model.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Events</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2920</span> 
<span class='line'>2921</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.Model.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.Model.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2922</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2923</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2924</span> 			Data source URL
<span class='line'>2925</span> 			@type String
<span class='line'>2926</span> 		*/</span><span class="WHIT">
<span class='line'>2927</span> </span><span class="WHIT">		</span><span class="NAME">dataURL</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2928</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2929</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2930</span> 			Settings for jQuery AJAX data request
<span class='line'>2931</span> 			@type String
<span class='line'>2932</span> 		*/</span><span class="WHIT">
<span class='line'>2933</span> </span><span class="WHIT">		</span><span class="NAME">dataRequestSettings</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2934</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2935</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2936</span> 			Flag that determines whether the data should not be loaded at all
<span class='line'>2937</span> 			@default false
<span class='line'>2938</span> 			@type Boolean
<span class='line'>2939</span> 		*/</span><span class="WHIT">
<span class='line'>2940</span> </span><span class="WHIT">		</span><span class="NAME">isEmptyData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2941</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2942</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2943</span> 			Flag that determines whether the data should be loaded once
<span class='line'>2944</span> 			@default false
<span class='line'>2945</span> 			@type Boolean
<span class='line'>2946</span> 		*/</span><span class="WHIT">
<span class='line'>2947</span> </span><span class="WHIT">		</span><span class="NAME">isStaticData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2948</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2949</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2950</span> 			Flag that determines whether the data type is string (otherwise JSON)
<span class='line'>2951</span> 			@default false
<span class='line'>2952</span> 			@type Boolean
<span class='line'>2953</span> 		*/</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>2954</span> </span><span class="WHIT">		</span><span class="NAME">isStringData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2955</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2956</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2957</span> 			Interval in milliseconds defining how often data should be retrived from the server; use '0' to turn autoUpdate off
<span class='line'>2958</span> 			@default 0
<span class='line'>2959</span> 			@type Number
<span class='line'>2960</span> 		*/</span><span class="WHIT">
<span class='line'>2961</span> </span><span class="WHIT">		</span><span class="NAME">autoUpdateInterval</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2962</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2963</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2964</span> 			Flag that determines whether the data should be updateing (with autoUpdate) even if the component is currentyl hidden
<span class='line'>2965</span> 			@default false
<span class='line'>2966</span> 			@type Boolean
<span class='line'>2967</span> 		*/</span><span class="WHIT">
<span class='line'>2968</span> </span><span class="WHIT">		</span><span class="NAME">updateInBackground</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2969</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2970</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2971</span> 			Flag that determines whether the data should be updated each time the component becomes visible
<span class='line'>2972</span> 			@default false
<span class='line'>2973</span> 			@type Boolean
<span class='line'>2974</span> 		*/</span><span class="WHIT">
<span class='line'>2975</span> </span><span class="WHIT">		</span><span class="NAME">updateOnShow</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2976</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2977</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2978</span> 			Object that contains default values for attributes - should be overriden to be used
<span class='line'>2979</span> 			@type Object
<span class='line'>2980</span> 		*/</span><span class="WHIT">
<span class='line'>2981</span> </span><span class="WHIT">		</span><span class="NAME">defaults</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2982</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>2983</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2984</span> 			Get the value of an attribute.
<span class='line'>2985</span> 			@param {String} attribute name
<span class='line'>2986</span> 			@return {Object} attribute value
<span class='line'>2987</span> 		*/</span><span class="WHIT">
<span class='line'>2988</span> </span><span class="WHIT">		</span><span class="NAME">get</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2989</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2990</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2991</span> 
<span class='line'>2992</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>2993</span> 			Returns 'true' if the attribute contains a value that is not null or undefined.
<span class='line'>2994</span> 			@param {String} attribute name
<span class='line'>2995</span> 			@return {Boolean} existance identifier
<span class='line'>2996</span> 		*/</span><span class="WHIT">
<span class='line'>2997</span> </span><span class="WHIT">		</span><span class="NAME">has</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2998</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2999</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3000</span> 
<span class='line'>3001</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3002</span> 			Set a hash of model attributes on the object, firing 'change' unless you choose to silence it.
<span class='line'>3003</span> 			@param {Object} attributes hash (name-value pairs)
<span class='line'>3004</span> 			@param {Object} options hash (name-value pairs)
<span class='line'>3005</span> 			@return {XF.Model} object instance
<span class='line'>3006</span> 		*/</span><span class="WHIT">
<span class='line'>3007</span> </span><span class="WHIT">		</span><span class="NAME">set</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attrs</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3008</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3009</span> </span><span class="WHIT">			</span><span class="COMM">// Extract attributes and options.</span><span class="WHIT">
<span class='line'>3010</span> </span><span class="WHIT">			</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3011</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3012</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attrs.attributes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attrs.attributes</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3013</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">now</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">escaped</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._escapedAttributes</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3014</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3015</span> </span><span class="WHIT">			</span><span class="COMM">// Check for changes of 'id'.</span><span class="WHIT">
<span class='line'>3016</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.idAttribute</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">[</span><span class="NAME">this.idAttribute</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3017</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3018</span> </span><span class="WHIT">			</span><span class="COMM">// We're about to start triggering change events.</span><span class="WHIT">
<span class='line'>3019</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">alreadyChanging</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._changing</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3020</span> </span><span class="WHIT">			</span><span class="NAME">this._changing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3021</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3022</span> </span><span class="WHIT">			</span><span class="COMM">// Update attributes.</span><span class="WHIT">
<span class='line'>3023</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">attr</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3024</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3025</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_.isEqual</span><span class="PUNC">(</span><span class="NAME">now</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3026</span> </span><span class="WHIT">					</span><span class="NAME">now</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3027</span> </span><span class="WHIT">					</span><span class="NAME">this._changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3028</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.silent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'change:'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">attr</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3029</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3030</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3031</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3032</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._changed</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">options.silent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3033</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'changed'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3034</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3035</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3036</span> </span><span class="WHIT">			</span><span class="COMM">// Fire the 'change' event, if the model has been changed.</span><span class="WHIT">
<span class='line'>3037</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">alreadyChanging</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">options.silent</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._changed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.change</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3038</span> </span><span class="WHIT">			</span><span class="NAME">this._changing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3039</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3040</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3041</span> 
<span class='line'>3042</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3043</span> 			Remove an attribute from the model, firing 'change' unless you choose to silence it. 'unset' is a noop if the attribute doesn't exist.
<span class='line'>3044</span> 			@param {String} attribute name
<span class='line'>3045</span> 			@param {Object} options hash (name-value pairs)
<span class='line'>3046</span> 			@return {XF.Model} object instance
<span class='line'>3047</span> 			
<span class='line'>3048</span> 		*/</span><span class="WHIT">
<span class='line'>3049</span> </span><span class="WHIT">		</span><span class="NAME">unset</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attr</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3050</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">attr</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3051</span> </span><span class="WHIT">			</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3052</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3053</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3054</span> </span><span class="WHIT">			</span><span class="COMM">// Remove the attribute.</span><span class="WHIT">
<span class='line'>3055</span> </span><span class="WHIT">			</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3056</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attr</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this.idAttribute</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.id</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3057</span> </span><span class="WHIT">			</span><span class="NAME">this._changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3058</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.silent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3059</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'change:'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">attr</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3060</span> </span><span class="WHIT">				</span><span class="NAME">this.change</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3061</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3062</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3063</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3064</span> 
<span class='line'>3065</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3066</span> 			Clear all attributes on the model, firing 'change' unless you choose to silence it.
<span class='line'>3067</span> 			@param {Object} options hash (name-value pairs)
<span class='line'>3068</span> 			@return {XF.Model} object instance
<span class='line'>3069</span> 		*/</span><span class="WHIT">
<span class='line'>3070</span> </span><span class="WHIT">		</span><span class="NAME">clear</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3071</span> </span><span class="WHIT">			</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3072</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">attr</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3073</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">old</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3074</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3075</span> </span><span class="WHIT">			</span><span class="NAME">this.attributes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3076</span> </span><span class="WHIT">			</span><span class="NAME">this._changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3077</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">options.silent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3078</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attr</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">old</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3079</span> </span><span class="WHIT">					</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'change:'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">attr</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3080</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3081</span> </span><span class="WHIT">				</span><span class="NAME">this.change</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3082</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3083</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3084</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3085</span> 
<span class='line'>3086</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3087</span> 			Call this method to manually fire a 'change' event for this model. Calling this will cause all objects observing the model to update.
<span class='line'>3088</span> 			@param {Object} options hash (name-value pairs)
<span class='line'>3089</span> 		*/</span><span class="WHIT">
<span class='line'>3090</span> </span><span class="WHIT">		</span><span class="NAME">change</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3091</span> </span><span class="WHIT">			</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'change'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3092</span> </span><span class="WHIT">			</span><span class="NAME">this._previousAttributes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.clone</span><span class="PUNC">(</span><span class="NAME">this.attributes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3093</span> </span><span class="WHIT">			</span><span class="NAME">this._changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3094</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3095</span> 
<span class='line'>3096</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3097</span> 			Determine if the model has changed since the last 'change' event. If you specify an attribute name, determine if that attribute has changed.
<span class='line'>3098</span> 			@param {String} attribute name
<span class='line'>3099</span> 			@return {Boolean} change identifier
<span class='line'>3100</span> 		*/</span><span class="WHIT">
<span class='line'>3101</span> </span><span class="WHIT">		</span><span class="NAME">hasChanged</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3102</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._previousAttributes</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3103</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._changed</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3104</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3105</span> 
<span class='line'>3106</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3107</span> 			Return an object containing all the attributes that have changed, or false if there are no changed attributes. Useful for determining what parts of a view need to be updated and/or what attributes need to be persisted to the server.
<span class='line'>3108</span> 			@param {Object} new attribute values hash
<span class='line'>3109</span> 			@return {Object} list of changed attributes;
<span class='line'>3110</span> 			
<span class='line'>3111</span> 		*/</span><span class="WHIT">
<span class='line'>3112</span> </span><span class="WHIT">		</span><span class="NAME">changedAttributes</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">now</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3113</span> </span><span class="WHIT">			</span><span class="NAME">now</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">now</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.attributes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3114</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">old</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._previousAttributes</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3115</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3116</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">attr</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">now</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3117</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_.isEqual</span><span class="PUNC">(</span><span class="NAME">old</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">now</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3118</span> </span><span class="WHIT">					</span><span class="NAME">changed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">changed</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3119</span> </span><span class="WHIT">					</span><span class="NAME">changed</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">now</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3120</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3121</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3122</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">changed</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3123</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3124</span> 
<span class='line'>3125</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3126</span> 			Get the previous value of an attribute, recorded at the time the last 'change' event was fired.
<span class='line'>3127</span> 			@param {String} attribute name
<span class='line'>3128</span> 			@return {Object} previous attribute value
<span class='line'>3129</span> 		*/</span><span class="WHIT">
<span class='line'>3130</span> </span><span class="WHIT">		</span><span class="NAME">previous</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">attr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3131</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">attr</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this._previousAttributes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3132</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._previousAttributes</span><span class="PUNC">[</span><span class="NAME">attr</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3133</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3134</span> 
<span class='line'>3135</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3136</span> 			Get all of the attributes of the model at the time of the previous 'change' event.
<span class='line'>3137</span> 			@return {Object} previous attributes hash copy
<span class='line'>3138</span> 		*/</span><span class="WHIT">
<span class='line'>3139</span> </span><span class="WHIT">		</span><span class="NAME">previousAttributes</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3140</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_.clone</span><span class="PUNC">(</span><span class="NAME">this._previousAttributes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3141</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3142</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3143</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3144</span> 			Constructs model instance
<span class='line'>3145</span> 			@private
<span class='line'>3146</span> 		*/</span><span class="WHIT">
<span class='line'>3147</span> </span><span class="WHIT">		</span><span class="NAME">construct</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3148</span> </span><span class="WHIT">			</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3149</span> </span><span class="WHIT">			</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'init'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3150</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.autoUpdateInterval</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3151</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">autoUpdateFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3152</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">this.component.selector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">is</span><span class="PUNC">(</span><span class="STRN">':visible'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3153</span> </span><span class="WHIT">						</span><span class="NAME">this.refresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3154</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.updateInBackground</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3155</span> </span><span class="WHIT">						</span><span class="NAME">this.refresh</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3156</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3157</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3158</span> </span><span class="WHIT">				</span><span class="NAME">setInterval</span><span class="PUNC">(</span><span class="NAME">autoUpdateFunc</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.autoUpdateInterval</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3159</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3160</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.updateOnShow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3161</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">this.component.selector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'show'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="NAME">this.refresh</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3162</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3163</span> </span><span class="WHIT">			</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'construct'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3164</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3165</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3166</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3167</span> 			HOOK: override to add logic. Default behavior is noop
<span class='line'>3168</span> 		*/</span><span class="WHIT">
<span class='line'>3169</span> </span><span class="WHIT">		</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3170</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3171</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3172</span> 			Refreshes data from backend if necessary
<span class='line'>3173</span> 			@private
<span class='line'>3174</span> 		*/</span><span class="WHIT">
<span class='line'>3175</span> </span><span class="WHIT">		</span><span class="NAME">refresh</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>3176</span> </span><span class="WHIT">			</span><span class="COMM">/** ignore */</span><span class="WHIT">
<span class='line'>3177</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dataLoaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3178</span> </span><span class="WHIT">				</span><span class="NAME">this.unbind</span><span class="PUNC">(</span><span class="STRN">'dataLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dataLoaded</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3179</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">renderVersion</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.component.view.renderVersion</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3180</span> </span><span class="WHIT">				</span><span class="NAME">this.afterLoadData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3181</span> 
<span class='line'>3182</span> </span><span class="WHIT">				</span><span class="COMM">//TODO: uncomment this and try to find why 'refresh' not working for menu component</span><span class="WHIT">
<span class='line'>3183</span> </span><span class="WHIT">				</span><span class="COMM">//if(this.component.view.renderVersion == renderVersion) {</span><span class="WHIT">
<span class='line'>3184</span> </span><span class="WHIT">					</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3185</span> </span><span class="WHIT">				</span><span class="COMM">//}</span><span class="WHIT">
<span class='line'>3186</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3187</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3188</span> </span><span class="WHIT">			</span><span class="NAME">this.bind</span><span class="PUNC">(</span><span class="STRN">'dataLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dataLoaded</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3189</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3190</span> </span><span class="WHIT">			</span><span class="NAME">this.beforeLoadData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3191</span> </span><span class="WHIT">			</span><span class="NAME">this.loadData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3192</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3193</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3194</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3195</span> 			Generates data url - override if custom format is required and {@link XF.Settings} has no appropriate way to handle it
<span class='line'>3196</span> 			@private
<span class='line'>3197</span> 		*/</span><span class="WHIT">
<span class='line'>3198</span> </span><span class="WHIT">		</span><span class="NAME">getDataURL</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3199</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.dataURL</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3200</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.component</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3201</span> </span><span class="WHIT">					</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">'XF.Model "component" linkage lost'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3202</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3203</span> </span><span class="WHIT">				</span><span class="NAME">this.dataURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'dataUrlFormatter'</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">this.component.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3204</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3205</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.dataURL</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3206</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3207</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3208</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3209</span> 			Returns settings for jQuery AJAX data request or empty object is it is not set - override to add extra functionality
<span class='line'>3210</span> 			@private
<span class='line'>3211</span> 		*/</span><span class="WHIT">
<span class='line'>3212</span> </span><span class="WHIT">		</span><span class="NAME">getDataRequestSettings</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3213</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.dataRequestSettings</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3214</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3215</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3216</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3217</span> 			HOOK: override to add logic before data load
<span class='line'>3218</span> 		*/</span><span class="WHIT">
<span class='line'>3219</span> </span><span class="WHIT">		</span><span class="NAME">beforeLoadData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3220</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3221</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3222</span> 			Loads data
<span class='line'>3223</span> 			@private
<span class='line'>3224</span> 		*/</span><span class="WHIT">
<span class='line'>3225</span> </span><span class="WHIT">		</span><span class="NAME">loadData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3226</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3227</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isEmptyData</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.rawData</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.isStaticData</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.autoUpdate</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3228</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3229</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3230</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getDataURL</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3231</span> 
<span class='line'>3232</span> </span><span class="WHIT">				</span><span class="NAME">$.ajax</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>3233</span> </span><span class="WHIT">					</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3234</span> </span><span class="WHIT">					</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">this.getDataRequestSettings</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3235</span> </span><span class="WHIT">						</span><span class="NAME">complete</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jqXHR</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">textStatus</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3236</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">$this.component</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3237</span> </span><span class="WHIT">								</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">'XF.Model "component" linkage lost'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3238</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3239</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textStatus</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'success'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3240</span> </span><span class="WHIT">								</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$this.isStringData</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3241</span> </span><span class="WHIT">									</span><span class="NAME">$this.rawData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqXHR.responseText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3242</span> </span><span class="WHIT">								</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3243</span> </span><span class="WHIT">									</span><span class="NAME">$this.rawData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$.parseJSON</span><span class="PUNC">(</span><span class="NAME">jqXHR.responseText</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3244</span> </span><span class="WHIT">								</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3245</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3246</span> </span><span class="WHIT">								</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$this.isStringData</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3247</span> </span><span class="WHIT">									</span><span class="NAME">$this.rawData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3248</span> </span><span class="WHIT">								</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3249</span> </span><span class="WHIT">									</span><span class="NAME">$this.rawData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3250</span> </span><span class="WHIT">								</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3251</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3252</span> </span><span class="WHIT">							</span><span class="NAME">$this.trigger</span><span class="PUNC">(</span><span class="STRN">'dataLoaded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3253</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3254</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>3255</span> </span><span class="WHIT">				</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3256</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3257</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3258</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'dataLoaded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3259</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3260</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3261</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3262</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3263</span> 			HOOK: override to add logic after data load
<span class='line'>3264</span> 		*/</span><span class="WHIT">
<span class='line'>3265</span> </span><span class="WHIT">		</span><span class="NAME">afterLoadData</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3266</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3267</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3268</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3269</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3270</span> 		This method allows to extend XF.Model with saving the whole prototype chain
<span class='line'>3271</span> 		@function
<span class='line'>3272</span> 		@static
<span class='line'>3273</span> 	*/</span><span class="WHIT">
<span class='line'>3274</span> </span><span class="WHIT">	</span><span class="NAME">XF.Model.extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">extend</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3275</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3276</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3277</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>3278</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3279</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3280</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3281</span> 		Implements view workaround flow.
<span class='line'>3282</span> 		@class
<span class='line'>3283</span> 		@static
<span class='line'>3284</span> 		@augments XF.Events
<span class='line'>3285</span> 	 */</span><span class="WHIT">
<span class='line'>3286</span> </span><span class="WHIT">	</span><span class="NAME">XF.View</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3287</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3288</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3289</span> 		Compiles component template if necessary & executes it with current component instance model
<span class='line'>3290</span> 		@static
<span class='line'>3291</span> 	*/</span><span class="WHIT">
<span class='line'>3292</span> </span><span class="WHIT">	</span><span class="NAME">XF.View.getMarkup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3293</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.component.constructor.compiledTemplate</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3294</span> </span><span class="WHIT">			</span><span class="NAME">this.component.constructor.compiledTemplate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.template</span><span class="PUNC">(</span><span class="NAME">this.component.constructor.template</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3295</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3296</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.component.constructor.compiledTemplate</span><span class="PUNC">(</span><span class="NAME">this.component.model</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3297</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3298</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3299</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.View.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XF.Events</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3300</span> 
<span class='line'>3301</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.View.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.View.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3302</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3303</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3304</span> 			Would be dispatched once when the Component inited
<span class='line'>3305</span> 			@name XF.View#init
<span class='line'>3306</span> 			@event
<span class='line'>3307</span> 		*/</span><span class="WHIT">
<span class='line'>3308</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3309</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3310</span> 			Would be dispatched once when the Component constructed
<span class='line'>3311</span> 			@name XF.View#construct
<span class='line'>3312</span> 			@event
<span class='line'>3313</span> 		*/</span><span class="WHIT">
<span class='line'>3314</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3315</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3316</span> 			Would be dispatched once, when template is ready for use
<span class='line'>3317</span> 			@name XF.View#templateLoaded
<span class='line'>3318</span> 			@event
<span class='line'>3319</span> 		*/</span><span class="WHIT">
<span class='line'>3320</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3321</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3322</span> 			Would be dispatched after each render
<span class='line'>3323</span> 			@name XF.View#refresh
<span class='line'>3324</span> 			@event
<span class='line'>3325</span> 		*/</span><span class="WHIT">
<span class='line'>3326</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3327</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3328</span> 			Link to the {@link XF.Component} instance
<span class='line'>3329</span> 			@type XF.Component
<span class='line'>3330</span> 		*/</span><span class="WHIT">
<span class='line'>3331</span> </span><span class="WHIT">		</span><span class="NAME">component</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3332</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3333</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3334</span> 			Template URL
<span class='line'>3335</span> 			@type String
<span class='line'>3336</span> 		*/</span><span class="WHIT">
<span class='line'>3337</span> </span><span class="WHIT">		</span><span class="NAME">templateURL</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3338</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3339</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3340</span> 			Flag that determines whether the Model update should be ignored by the View (in this case you may launch {@link XF.View#refresh} manualy)
<span class='line'>3341</span> 			@default false
<span class='line'>3342</span> 			@type Boolean
<span class='line'>3343</span> 		*/</span><span class="WHIT">
<span class='line'>3344</span> </span><span class="WHIT">		</span><span class="NAME">ignoreModelUpdate</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3345</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3346</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3347</span> 			Flag that determines whether the view should be rerendered each time the component becomes visible
<span class='line'>3348</span> 			@default false
<span class='line'>3349</span> 			@type Boolean
<span class='line'>3350</span> 		*/</span><span class="WHIT">
<span class='line'>3351</span> </span><span class="WHIT">		</span><span class="NAME">updateOnShow</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3352</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3353</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3354</span> 			Flag that determines whether the template should be stored into {@link XF.Cache}
<span class='line'>3355</span> 			@default false
<span class='line'>3356</span> 			@type Boolean
<span class='line'>3357</span> 		*/</span><span class="WHIT">
<span class='line'>3358</span> </span><span class="WHIT">		</span><span class="NAME">useCache</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3359</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3360</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3361</span> 			Constructs view instance
<span class='line'>3362</span> 			@private
<span class='line'>3363</span> 		*/</span><span class="WHIT">
<span class='line'>3364</span> </span><span class="WHIT">		</span><span class="NAME">construct</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3365</span> </span><span class="WHIT">			</span><span class="COMM">/** ignore */</span><span class="WHIT">
<span class='line'>3366</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">templateLoaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3367</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3368</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.loadTemplateFailed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3369</span> </span><span class="WHIT">					</span><span class="NAME">this.unbind</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">templateLoaded</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3370</span> </span><span class="WHIT">					</span><span class="NAME">this.afterLoadTemplateFailed</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3371</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3372</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3373</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3374</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.component.constructor.templateLoaded</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3375</span> </span><span class="WHIT">					</span><span class="NAME">this.loadTemplate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3376</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3377</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3378</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3379</span> </span><span class="WHIT">				</span><span class="NAME">this.unbind</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">templateLoaded</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3380</span> </span><span class="WHIT">				</span><span class="NAME">this.afterLoadTemplate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3381</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3382</span> </span><span class="WHIT">				</span><span class="NAME">this.getMarkup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="NAME">XF.View.getMarkup</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3383</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3384</span> </span><span class="WHIT">				</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3385</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'init'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3386</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3387</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.ignoreModelUpdate</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3388</span> </span><span class="WHIT">					</span><span class="NAME">this.component.model.bind</span><span class="PUNC">(</span><span class="STRN">'changed'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.refresh</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3389</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3390</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.updateOnShow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3391</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">this.component.selector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'show'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="NAME">this.refresh</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3392</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3393</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3394</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'construct'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3395</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3396</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3397</span> </span><span class="WHIT">			</span><span class="NAME">this.bind</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">templateLoaded</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3398</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3399</span> </span><span class="WHIT">			</span><span class="NAME">this.beforeLoadTemplate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3400</span> </span><span class="WHIT">			</span><span class="NAME">this.loadTemplate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3401</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3402</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3403</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3404</span> 			Stores last device type that was used for template url generation
<span class='line'>3405</span> 			@type String
<span class='line'>3406</span> 			@private
<span class='line'>3407</span> 		*/</span><span class="WHIT">
<span class='line'>3408</span> </span><span class="WHIT">		</span><span class="NAME">lastDeviceType</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3409</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3410</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3411</span> 			Generates template url - override if custom format is required and {@link XF.Settings} has no appropriate way to handle it
<span class='line'>3412</span> 			@private
<span class='line'>3413</span> 		*/</span><span class="WHIT">
<span class='line'>3414</span> </span><span class="WHIT">		</span><span class="NAME">getTemplateURL</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3415</span> </span><span class="WHIT">			</span><span class="COMM">// clearing saved template URL - it was erroneous</span><span class="WHIT">
<span class='line'>3416</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.lastDeviceType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3417</span> </span><span class="WHIT">				</span><span class="NAME">this.templateURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3418</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3419</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.templateURL</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3420</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.component</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3421</span> </span><span class="WHIT">					</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">'XF.View "component" linkage lost'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3422</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3423</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3424</span> </span><span class="WHIT">				</span><span class="NAME">this.lastDeviceType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Device.getNextType</span><span class="PUNC">(</span><span class="NAME">this.lastDeviceType</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3425</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3426</span> </span><span class="WHIT">				</span><span class="COMM">// preventing from infinit cycle</span><span class="WHIT">
<span class='line'>3427</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.lastDeviceType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3428</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3429</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3430</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3431</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">templatePath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3432</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.lastDeviceType</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.lastDeviceType.templatePath</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3433</span> </span><span class="WHIT">					</span><span class="NAME">templatePath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.lastDeviceType.templatePath</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3434</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3435</span> </span><span class="WHIT">				</span><span class="NAME">this.templateURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'templateUrlFormatter'</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">this.component.name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">templatePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3436</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3437</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.templateURL</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3438</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3439</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3440</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3441</span> 			HOOK: override to add logic before template load
<span class='line'>3442</span> 		*/</span><span class="WHIT">
<span class='line'>3443</span> </span><span class="WHIT">		</span><span class="NAME">beforeLoadTemplate</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3444</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3445</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3446</span> 			A flag that indicates whether the template loading failed
<span class='line'>3447</span> 			@type Boolean
<span class='line'>3448</span> 			@private
<span class='line'>3449</span> 		*/</span><span class="WHIT">
<span class='line'>3450</span> </span><span class="WHIT">		</span><span class="NAME">loadTemplateFailed</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3451</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3452</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3453</span> 			Loads template
<span class='line'>3454</span> 			@private
<span class='line'>3455</span> 		*/</span><span class="WHIT">
<span class='line'>3456</span> </span><span class="WHIT">		</span><span class="NAME">loadTemplate</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3457</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3458</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getTemplateURL</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3459</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3460</span> </span><span class="WHIT">				</span><span class="NAME">this.loadTemplateFailed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3461</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3462</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3463</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3464</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3465</span> </span><span class="WHIT">			</span><span class="COMM">// trying to get template from cache</span><span class="WHIT">
<span class='line'>3466</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.useCache</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3467</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cachedTemplate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Cache.get</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3468</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">cachedTemplate</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3469</span> </span><span class="WHIT">					</span><span class="NAME">this.component.constructor.template</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cachedTemplate</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3470</span> </span><span class="WHIT">					</span><span class="NAME">this.component.constructor.templateLoaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3471</span> </span><span class="WHIT">					</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3472</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3473</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3474</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3475</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3476</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.component.constructor.templateLoaded</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.component.constructor.templateLoading</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3477</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3478</span> </span><span class="WHIT">				</span><span class="NAME">this.component.constructor.templateURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3479</span> </span><span class="WHIT">				</span><span class="NAME">this.component.constructor.templateLoading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3480</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3481</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3482</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3483</span> </span><span class="WHIT">				</span><span class="NAME">$.ajax</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3484</span> </span><span class="WHIT">					</span><span class="NAME">complete</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jqXHR</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">textStatus</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3485</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">$this.component</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3486</span> </span><span class="WHIT">							</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">'XF.View "component" linkage lost'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3487</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3488</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">textStatus</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'success'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3489</span> </span><span class="WHIT">							</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">template</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqXHR.responseText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3490</span> </span><span class="WHIT">							</span><span class="WHIT">
<span class='line'>3491</span> </span><span class="WHIT">							</span><span class="COMM">// saving template into cache if the option is turned on</span><span class="WHIT">
<span class='line'>3492</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$this.useCache</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3493</span> </span><span class="WHIT">								</span><span class="NAME">XF.Cache.set</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">template</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3494</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3495</span> </span><span class="WHIT">							</span><span class="WHIT">
<span class='line'>3496</span> </span><span class="WHIT">							</span><span class="NAME">$this.component.constructor.template</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqXHR.responseText</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3497</span> </span><span class="WHIT">							</span><span class="NAME">$this.component.constructor.templateLoading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3498</span> </span><span class="WHIT">							</span><span class="NAME">$this.component.constructor.templateLoaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3499</span> </span><span class="WHIT">							</span><span class="NAME">$this.trigger</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3500</span> </span><span class="WHIT">							</span><span class="NAME">XF.Controller.trigger</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">template</span><span class="PUNC">:</span><span class="NAME">template</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3501</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3502</span> </span><span class="WHIT">							</span><span class="NAME">$this.component.constructor.template</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3503</span> </span><span class="WHIT">							</span><span class="NAME">$this.component.constructor.templateLoading</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3504</span> </span><span class="WHIT">							</span><span class="NAME">$this.component.constructor.templateLoaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3505</span> </span><span class="WHIT">							</span><span class="NAME">$this.trigger</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3506</span> </span><span class="WHIT">							</span><span class="NAME">XF.Controller.trigger</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">template</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3507</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3508</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3509</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3510</span> 
<span class='line'>3511</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.component.constructor.templateLoading</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3512</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3513</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3514</span> </span><span class="WHIT">				</span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.component.constructor.templateURL</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3515</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3516</span> </span><span class="WHIT">				</span><span class="COMM">/** ignore */</span><span class="WHIT">
<span class='line'>3517</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">templateLoadedAsync</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3518</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">params.url</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3519</span> </span><span class="WHIT">						</span><span class="NAME">XF.Controller.unbind</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">templateLoadedAsync</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3520</span> </span><span class="WHIT">						</span><span class="NAME">$this.trigger</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3521</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3522</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3523</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3524</span> </span><span class="WHIT">				</span><span class="NAME">XF.Controller.bind</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">templateLoadedAsync</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3525</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3526</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3527</span> </span><span class="WHIT">				</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'templateLoaded'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3528</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3529</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3530</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3531</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3532</span> 			HOOK: override to add logic after template load
<span class='line'>3533</span> 		*/</span><span class="WHIT">
<span class='line'>3534</span> </span><span class="WHIT">		</span><span class="NAME">afterLoadTemplate</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3535</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3536</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3537</span> 			HOOK: override to add logic for the case when it's impossible to load template
<span class='line'>3538</span> 		*/</span><span class="WHIT">
<span class='line'>3539</span> </span><span class="WHIT">		</span><span class="NAME">afterLoadTemplateFailed</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3540</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.View :: afterLoadTemplateFailed - could not load template for "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.component.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3541</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.View :: afterLoadTemplateFailed - @dev: verify XF.Device.types settings & XF.View :: getTemplate URL overrides'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3542</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3543</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3544</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3545</span> 			HOOK: override to add custom logic on init
<span class='line'>3546</span> 		*/</span><span class="WHIT">
<span class='line'>3547</span> </span><span class="WHIT">		</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3548</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3549</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3550</span> 			Renders component into placeholder + calling all the necessary hooks & events
<span class='line'>3551</span> 		*/</span><span class="WHIT">
<span class='line'>3552</span> </span><span class="WHIT">		</span><span class="NAME">refresh</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3553</span> </span><span class="WHIT">			</span><span class="NAME">this.preRender</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3554</span> </span><span class="WHIT">			</span><span class="NAME">this.render</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3555</span> </span><span class="WHIT">			</span><span class="NAME">this.postRender</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3556</span> </span><span class="WHIT">			</span><span class="NAME">this.trigger</span><span class="PUNC">(</span><span class="STRN">'refresh'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3557</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3558</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3559</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3560</span> 			HOOK: override to add logic before render
<span class='line'>3561</span> 		*/</span><span class="WHIT">
<span class='line'>3562</span> </span><span class="WHIT">		</span><span class="NAME">preRender</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3563</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3564</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3565</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3566</span> 			Identifies current render vesion
<span class='line'>3567</span> 			@private
<span class='line'>3568</span> 		*/</span><span class="WHIT">
<span class='line'>3569</span> </span><span class="WHIT">		</span><span class="NAME">renderVersion</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3570</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3571</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3572</span> 			Renders component into placeholder
<span class='line'>3573</span> 			@private
<span class='line'>3574</span> 		*/</span><span class="WHIT">
<span class='line'>3575</span> </span><span class="WHIT">		</span><span class="NAME">render</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3576</span> </span><span class="WHIT">			</span><span class="NAME">this.renderVersion</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3577</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">DOMObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'[data-id='</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.component.id</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3578</span> </span><span class="WHIT">			</span><span class="NAME">DOMObject.html</span><span class="PUNC">(</span><span class="NAME">this.getMarkup</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3579</span> </span><span class="WHIT">			</span><span class="NAME">loadChildComponents</span><span class="PUNC">(</span><span class="NAME">DOMObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3580</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3581</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3582</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3583</span> 			HOOK: override to add logic after render
<span class='line'>3584</span> 		*/</span><span class="WHIT">
<span class='line'>3585</span> </span><span class="WHIT">		</span><span class="NAME">postRender</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3586</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3587</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3588</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3589</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3590</span> 		This method allows to extend XF.View with saving the whole prototype chain
<span class='line'>3591</span> 		@function
<span class='line'>3592</span> 		@static
<span class='line'>3593</span> 	*/</span><span class="WHIT">
<span class='line'>3594</span> </span><span class="WHIT">	</span><span class="NAME">XF.View.extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">extend</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3595</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3596</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3597</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>3598</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3599</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3600</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3601</span> 		Instance of {@link XF.RootComponent}
<span class='line'>3602</span> 		@static
<span class='line'>3603</span> 		@private
<span class='line'>3604</span> 		@type {XF.RootComponent}
<span class='line'>3605</span> 	*/</span><span class="WHIT">
<span class='line'>3606</span> </span><span class="WHIT">	</span><span class="NAME">XF.RootComponentInstance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3607</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3608</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3609</span> 		Root Component.
<span class='line'>3610</span> 		@class
<span class='line'>3611</span> 		@static
<span class='line'>3612</span> 		@augments XF.Component
<span class='line'>3613</span> 	*/</span><span class="WHIT">
<span class='line'>3614</span> </span><span class="WHIT">	</span><span class="NAME">XF.RootComponent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Component.extend</span><span class="PUNC">(</span><span class="COMM">/** @lends XF.RootComponent.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3615</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3616</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3617</span> 			HOOK: override to add logic before starting routing
<span class='line'>3618</span> 		*/</span><span class="WHIT">
<span class='line'>3619</span> </span><span class="WHIT">		</span><span class="NAME">beforeStart</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3620</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3621</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3622</span> 			Launches Routing & automated PageSwitcher
<span class='line'>3623</span> 			@private
<span class='line'>3624</span> 		*/</span><span class="WHIT">
<span class='line'>3625</span> </span><span class="WHIT">		</span><span class="NAME">start</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3626</span> </span><span class="WHIT">			</span><span class="NAME">XF.Router.start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3627</span> </span><span class="WHIT">			</span><span class="NAME">XF.PageSwitcher.start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3628</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3629</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3630</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3631</span> 			HOOK: override to add logic after starting routing
<span class='line'>3632</span> 		*/</span><span class="WHIT">
<span class='line'>3633</span> </span><span class="WHIT">		</span><span class="NAME">afterStart</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3634</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3635</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3636</span> 			Overrides {@link XF.Component} constructor in order to add Routing start call
<span class='line'>3637</span> 			@param {String} name Name of the component
<span class='line'>3638</span> 			@param {String} id ID of the component instance
<span class='line'>3639</span> 			@private
<span class='line'>3640</span> 		*/</span><span class="WHIT">
<span class='line'>3641</span> </span><span class="WHIT">		</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3642</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.RootComponentInstance</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3643</span> </span><span class="WHIT">				</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="STRN">'XF.RootComponent can be only ONE!'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3644</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3645</span> </span><span class="WHIT">			</span><span class="NAME">XF.RootComponentInstance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3646</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3647</span> </span><span class="WHIT">			</span><span class="NAME">this.ready</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3648</span> </span><span class="WHIT">				</span><span class="NAME">XF.RootComponentInstance.beforeStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3649</span> </span><span class="WHIT">				</span><span class="NAME">XF.RootComponentInstance.start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3650</span> </span><span class="WHIT">				</span><span class="NAME">XF.RootComponentInstance.afterStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3651</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3652</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3653</span> </span><span class="WHIT">			</span><span class="NAME">XF.Component.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3654</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3655</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3656</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3657</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3658</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>3659</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3660</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3661</span> 		Instance of {@link XF.PageSwitcherClass}
<span class='line'>3662</span> 		@static
<span class='line'>3663</span> 		@private
<span class='line'>3664</span> 		@type {XF.PageSwitcherClass}
<span class='line'>3665</span> 	*/</span><span class="WHIT">
<span class='line'>3666</span> </span><span class="WHIT">	</span><span class="NAME">XF.PageSwitcher</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3667</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3668</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3669</span> 		Root Component.
<span class='line'>3670</span> 		@class
<span class='line'>3671</span> 		@static
<span class='line'>3672</span> 	*/</span><span class="WHIT">
<span class='line'>3673</span> </span><span class="WHIT">	</span><span class="NAME">XF.PageSwitcherClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3674</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3675</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.PageSwitcherClass.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.PageSwitcherClass.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3676</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3677</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3678</span> 			CSS class used to identify pages
<span class='line'>3679</span> 			@type String
<span class='line'>3680</span> 			@default 'xf-page'
<span class='line'>3681</span> 		*/</span><span class="WHIT">
<span class='line'>3682</span> </span><span class="WHIT">		</span><span class="NAME">pageClass</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'xf-page'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3683</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3684</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3685</span> 			CSS class used to identify active page
<span class='line'>3686</span> 			@type String
<span class='line'>3687</span> 			@default 'xf-page-active'
<span class='line'>3688</span> 		*/</span><span class="WHIT">
<span class='line'>3689</span> </span><span class="WHIT">		</span><span class="NAME">activePageClass</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'xf-page-active'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3690</span> 
<span class='line'>3691</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3692</span> 			Animation type for page switching ('fade', 'slide', 'none')
<span class='line'>3693</span> 			@type String
<span class='line'>3694</span> 			@default 'fade'
<span class='line'>3695</span> 		*/</span><span class="WHIT">
<span class='line'>3696</span> </span><span class="WHIT">		</span><span class="NAME">animationType</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'fade'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3697</span> 
<span class='line'>3698</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3699</span> 			Saves current active page
<span class='line'>3700</span> 			@type JQuery
<span class='line'>3701</span> 			@private
<span class='line'>3702</span> 		*/</span><span class="WHIT">
<span class='line'>3703</span> </span><span class="WHIT">		</span><span class="NAME">activePage</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3704</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3705</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3706</span> 			Initialises PageSwitcher: get current active page and binds necessary routes handling
<span class='line'>3707</span> 			@private
<span class='line'>3708</span> 		*/</span><span class="WHIT">
<span class='line'>3709</span> </span><span class="WHIT">		</span><span class="NAME">start</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3710</span> 
<span class='line'>3711</span> </span><span class="WHIT">            </span><span class="NAME">$.fn.animationComplete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3712</span> </span><span class="WHIT">          		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="STRN">"WebKitTransitionEvent"</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">window</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"transitionEvent"</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">window</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3713</span> </span><span class="WHIT">          			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">one</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="STRN">'webkitAnimationEnd animationend'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3714</span> </span><span class="WHIT">          		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3715</span> </span><span class="WHIT">          		</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3716</span> </span><span class="WHIT">          			</span><span class="COMM">// defer execution for consistency between webkit/non webkit</span><span class="WHIT">
<span class='line'>3717</span> </span><span class="WHIT">          			</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3718</span> </span><span class="WHIT">          			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3719</span> </span><span class="WHIT">          		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3720</span> </span><span class="WHIT">          	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3721</span> 
<span class='line'>3722</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">pages</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">XF.RootComponentInstance.selector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' .'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.pageClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3723</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pages.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3724</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">preselectedAP</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pages.filter</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.activePageClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3725</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">preselectedAP.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3726</span> </span><span class="WHIT">					</span><span class="NAME">this.activePage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">preselectedAP</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3727</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3728</span> </span><span class="WHIT">					</span><span class="COMM">//this.activePage = pages.first();</span><span class="WHIT">
<span class='line'>3729</span> </span><span class="WHIT">					</span><span class="COMM">//this.activePage.addClass(this.activePageClass);</span><span class="WHIT">
<span class='line'>3730</span> </span><span class="WHIT">					</span><span class="NAME">this.switchToPage</span><span class="PUNC">(</span><span class="NAME">pages.first</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3731</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3732</span> </span><span class="WHIT">				</span><span class="NAME">XF.Router.bindAnyRoute</span><span class="PUNC">(</span><span class="NAME">this.routeHandler</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3733</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3734</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3735</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3736</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3737</span> 			Handles every XF.Router 'route:*' event and invokes page switching if necessary
<span class='line'>3738</span> 			@param String eventName
<span class='line'>3739</span> 			@private
<span class='line'>3740</span> 		*/</span><span class="WHIT">
<span class='line'>3741</span> </span><span class="WHIT">		</span><span class="NAME">routeHandler</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3742</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">routeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Router.getRouteByEventName</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3743</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jqPage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">XF.PageSwitcher.pageClass</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'#'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">routeName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3744</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">jqPage.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3745</span> </span><span class="WHIT">				</span><span class="NAME">XF.PageSwitcher.switchToPage</span><span class="PUNC">(</span><span class="NAME">jqPage</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3746</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3747</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3748</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3749</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3750</span> 			Executes animation sequence for switching 
<span class='line'>3751</span> 			@param JQuery jqPage
<span class='line'>3752</span> 		*/</span><span class="WHIT">
<span class='line'>3753</span> </span><span class="WHIT">		</span><span class="NAME">switchToPage</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">jqPage</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3754</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3755</span> </span><span class="WHIT">			</span><span class="COMM">// preventing animation when the page is already shown</span><span class="WHIT">
<span class='line'>3756</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.activePage</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">jqPage.attr</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this.activePage.attr</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3757</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3758</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3759</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3760</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">viewport</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Device.getViewport</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3761</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">screenHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.Device.getScreenHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3762</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3763</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">animationName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.animationType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3764</span> </span><span class="COMM">//			var reverseClass = this.animationReverseClass;</span><span class="WHIT">
<span class='line'>3765</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">activePageClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.activePageClass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3766</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3767</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fromPage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.activePage</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3768</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">toPage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">jqPage</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3769</span> 
<span class='line'>3770</span> </span><span class="WHIT">			</span><span class="NAME">this.activePage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">toPage</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3771</span> 
<span class='line'>3772</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fromPage</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3773</span> </span><span class="WHIT">				</span><span class="COMM">// start transition</span><span class="WHIT">
<span class='line'>3774</span> </span><span class="WHIT">				</span><span class="NAME">viewport.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-viewport-transitioning'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3775</span> 
<span class='line'>3776</span> </span><span class="WHIT">                </span><span class="NAME">fromPage.height</span><span class="PUNC">(</span><span class="NAME">screenHeight</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">scrollTop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'out '</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">animationName</span><span class="WHIT"> </span><span class="COMM">/*+ ' ' + reverseClass*/</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3777</span> </span><span class="WHIT">                </span><span class="NAME">toPage.height</span><span class="PUNC">(</span><span class="NAME">screenHeight</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">scrollTop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'in '</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">animationName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">activePageClass</span><span class="WHIT"> </span><span class="COMM">/*+ ' ' + reverseClass*/</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3778</span> </span><span class="WHIT">                </span><span class="NAME">fromPage.animationComplete</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3779</span> </span><span class="WHIT">                    </span><span class="NAME">fromPage.height</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">removeClass</span><span class="PUNC">(</span><span class="NAME">animationName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' out in reverse'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3780</span> </span><span class="WHIT">                    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fromPage.attr</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">XF.PageSwitcher.activePage.attr</span><span class="PUNC">(</span><span class="STRN">'id'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3781</span> </span><span class="WHIT">                        </span><span class="NAME">fromPage.removeClass</span><span class="PUNC">(</span><span class="NAME">activePageClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3782</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3783</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3784</span> 
<span class='line'>3785</span> </span><span class="WHIT">                </span><span class="NAME">toPage.animationComplete</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3786</span> </span><span class="WHIT">                    </span><span class="NAME">toPage.height</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">removeClass</span><span class="PUNC">(</span><span class="NAME">animationName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' out in reverse'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3787</span> </span><span class="WHIT">                    </span><span class="NAME">viewport.removeClass</span><span class="PUNC">(</span><span class="STRN">'xf-viewport-transitioning'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3788</span> 
<span class='line'>3789</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3790</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3791</span> </span><span class="WHIT">				</span><span class="COMM">// just making it active</span><span class="WHIT">
<span class='line'>3792</span> </span><span class="WHIT">				</span><span class="NAME">this.activePage.addClass</span><span class="PUNC">(</span><span class="NAME">activePageClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3793</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3794</span> 
<span class='line'>3795</span> 
<span class='line'>3796</span> </span><span class="WHIT">            </span><span class="COMM">// scroll to top of page ofter page switch</span><span class="WHIT">
<span class='line'>3797</span> </span><span class="WHIT">            </span><span class="NAME">window.scrollTo</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3798</span> 
<span class='line'>3799</span> </span><span class="WHIT">			</span><span class="COMM">// looking for components inside the page</span><span class="WHIT">
<span class='line'>3800</span> </span><span class="WHIT">			</span><span class="NAME">loadChildComponents</span><span class="PUNC">(</span><span class="NAME">this.activePage</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3801</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3802</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3803</span> 
<span class='line'>3804</span> 
<span class='line'>3805</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>3806</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3807</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3808</span> </span><span class="WHIT">	</span><span class="COMM">/* adding touchable functionality as jQuery plugin */</span><span class="WHIT">
<span class='line'>3809</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3810</span> </span><span class="WHIT">	</span><span class="COMM">/** @ignore */</span><span class="WHIT">
<span class='line'>3811</span> </span><span class="WHIT">	</span><span class="NAME">$.fn.touchable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3812</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.each</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3813</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">(</span><span class="STRN">'touchable'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3814</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">(</span><span class="STRN">'touchable'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.Touchable</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3815</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3816</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">(</span><span class="STRN">'touchable'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3817</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3818</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3819</span> 
<span class='line'>3820</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>3821</span> 		Incapsulates one finger workaround logic.
<span class='line'>3822</span> 		@class
<span class='line'>3823</span> 		@static
<span class='line'>3824</span> 		@param {XF.Touchable} touchable Reference to the instance of {@link XF.Touchable} created for target DOM element
<span class='line'>3825</span> 		@param {String} fingerID Unique finger indentifier
<span class='line'>3826</span> 		@param {Object} startPosition Initial finger position coordinates
<span class='line'>3827</span> 	*/</span><span class="WHIT">
<span class='line'>3828</span> </span><span class="WHIT">	</span><span class="NAME">XF.TouchGesture</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">touchable</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fingerID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">startPosition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3829</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3830</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3831</span> 			Reference to the instance of {@link XF.Touchable} created for target DOM element
<span class='line'>3832</span> 			@type XF.Touchable
<span class='line'>3833</span> 			@private
<span class='line'>3834</span> 		*/</span><span class="WHIT">
<span class='line'>3835</span> </span><span class="WHIT">		</span><span class="NAME">this.touchable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">touchable</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3836</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3837</span> 			Unique finger indentifier
<span class='line'>3838</span> 			@type String
<span class='line'>3839</span> 		*/</span><span class="WHIT">
<span class='line'>3840</span> </span><span class="WHIT">		</span><span class="NAME">this.fingerID</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fingerID</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3841</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3842</span> 			Initial finger position coordinates
<span class='line'>3843</span> 			@type Object
<span class='line'>3844</span> 		*/</span><span class="WHIT">
<span class='line'>3845</span> </span><span class="WHIT">		</span><span class="NAME">this.startPosition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">startPosition</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3846</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3847</span> 			Current finger position coordinates
<span class='line'>3848</span> 			@type Object
<span class='line'>3849</span> 		*/</span><span class="WHIT">
<span class='line'>3850</span> </span><span class="WHIT">		</span><span class="NAME">this.currentPosition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">startPosition</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3851</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3852</span> 			Previous finger position coordinates
<span class='line'>3853</span> 			@type Object
<span class='line'>3854</span> 		*/</span><span class="WHIT">
<span class='line'>3855</span> </span><span class="WHIT">		</span><span class="NAME">this.previousPosition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">startPosition</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3856</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3857</span> 			Delta (x, y) between current and previous finger position
<span class='line'>3858</span> 			@type Object
<span class='line'>3859</span> 		*/</span><span class="WHIT">
<span class='line'>3860</span> </span><span class="WHIT">		</span><span class="NAME">this.previousDelta</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3861</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3862</span> 			Delta (x, y) between current and initial finger position
<span class='line'>3863</span> 			@type Object
<span class='line'>3864</span> 		*/</span><span class="WHIT">
<span class='line'>3865</span> </span><span class="WHIT">		</span><span class="NAME">this.startDelta</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3866</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3867</span> 			Angle of a vector represented by delta between current and initial finger position
<span class='line'>3868</span> 			@type Number
<span class='line'>3869</span> 		*/</span><span class="WHIT">
<span class='line'>3870</span> </span><span class="WHIT">		</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3871</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3872</span> 			Length of a vector represented by delta between current and initial finger position
<span class='line'>3873</span> 			@type Number
<span class='line'>3874</span> 		*/</span><span class="WHIT">
<span class='line'>3875</span> </span><span class="WHIT">		</span><span class="NAME">this.swipeLength</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3876</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3877</span> 			Calculated direction of swipe gesture (XF.TouchGesture.SWIPE_DIRECTION_*)
<span class='line'>3878</span> 			@type String
<span class='line'>3879</span> 		*/</span><span class="WHIT">
<span class='line'>3880</span> </span><span class="WHIT">		</span><span class="NAME">this.swipeDirection</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture.SWIPE_DIRECTION_LEFT</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3881</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3882</span> 			Long touch timeout handler
<span class='line'>3883</span> 			@type Function
<span class='line'>3884</span> 			@private
<span class='line'>3885</span> 		*/</span><span class="WHIT">
<span class='line'>3886</span> </span><span class="WHIT">		</span><span class="NAME">this.longTouchHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="NAME">this.longTouchHandlerF</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3887</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3888</span> 			Long touch timeout identifier
<span class='line'>3889</span> 			@private
<span class='line'>3890</span> 		*/</span><span class="WHIT">
<span class='line'>3891</span> </span><span class="WHIT">		</span><span class="NAME">this.longTouchTimeout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">this.longTouchHandler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchable.options.longTapInterval</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3892</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3893</span> 			A flag witch defined whether the {@link XF.TouchGesture.TOUCH_START_EVENT} has alreay bee dispatched (used to skip {@link XF.TouchGesture.TAP_EVENT} dispatching if 'true')
<span class='line'>3894</span> 			@type Boolean
<span class='line'>3895</span> 			@default false
<span class='line'>3896</span> 			@private
<span class='line'>3897</span> 		*/</span><span class="WHIT">
<span class='line'>3898</span> </span><span class="WHIT">		</span><span class="NAME">this.longTouchDispatched</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3899</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3900</span> 			A flag witch defined whether the gesture has already been complete and should not be calculated further
<span class='line'>3901</span> 			@type Boolean
<span class='line'>3902</span> 			@default false
<span class='line'>3903</span> 			@private
<span class='line'>3904</span> 		*/</span><span class="WHIT">
<span class='line'>3905</span> </span><span class="WHIT">		</span><span class="NAME">this.gestureComplete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3906</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3907</span> </span><span class="WHIT">		</span><span class="COMM">// dispatching TOUCH_START_EVENT</span><span class="WHIT">
<span class='line'>3908</span> </span><span class="WHIT">		</span><span class="NAME">this.dispatch</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture.TOUCH_START_EVENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3909</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3910</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3911</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.TouchGesture.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3912</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>3913</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3914</span> 			Calculate everything related to touchmove
<span class='line'>3915</span> 			@param {Object} newPosition New finger coordinates
<span class='line'>3916</span> 			@private
<span class='line'>3917</span> 		*/</span><span class="WHIT">
<span class='line'>3918</span> </span><span class="WHIT">		</span><span class="NAME">move</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">newPosition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3919</span> </span><span class="WHIT">			</span><span class="NAME">this.previousPosition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.currentPosition</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3920</span> </span><span class="WHIT">			</span><span class="NAME">this.currentPosition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newPosition</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3921</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3922</span> </span><span class="WHIT">			</span><span class="NAME">this.previousDelta.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.currentPosition.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.previousPosition.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3923</span> </span><span class="WHIT">			</span><span class="NAME">this.previousDelta.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.currentPosition.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.previousPosition.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3924</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3925</span> </span><span class="WHIT">			</span><span class="NAME">this.startDelta.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.currentPosition.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.startPosition.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3926</span> </span><span class="WHIT">			</span><span class="NAME">this.startDelta.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.currentPosition.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.startPosition.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3927</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3928</span> </span><span class="WHIT">			</span><span class="NAME">this.checkSwipe</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3929</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3930</span> </span><span class="WHIT">			</span><span class="NAME">this.dispatch</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture.TOUCH_MOVE_EVENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3931</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3932</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3933</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3934</span> 			Checks whether SWIPE_EVENT should be dispatched
<span class='line'>3935</span> 			@param {Object} newPosition New finger coordinates
<span class='line'>3936</span> 			@private
<span class='line'>3937</span> 		*/</span><span class="WHIT">
<span class='line'>3938</span> </span><span class="WHIT">		</span><span class="NAME">checkSwipe</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3939</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3940</span> </span><span class="WHIT">			</span><span class="NAME">this.swipeLength</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.startDelta.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.startDelta.y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3941</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3942</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.swipeLength</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.touchable.options.swipeLength</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3943</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>3944</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">radians</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">this.startDelta.y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.startDelta.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3945</span> </span><span class="WHIT">				</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">radians</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3946</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3947</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3948</span> </span><span class="WHIT">					</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">360</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3949</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3950</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3951</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">45</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3952</span> </span><span class="WHIT">					</span><span class="NAME">this.swipeDirection</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture.SWIPE_DIRECTION_RIGHT</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3953</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">360</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">315</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3954</span> </span><span class="WHIT">					</span><span class="NAME">this.swipeDirection</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture.SWIPE_DIRECTION_RIGHT</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3955</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">135</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">225</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3956</span> </span><span class="WHIT">					</span><span class="NAME">this.swipeDirection</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture.SWIPE_DIRECTION_LEFT</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3957</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">45</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.swipeAngle</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">135</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3958</span> </span><span class="WHIT">					</span><span class="NAME">this.swipeDirection</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture.SWIPE_DIRECTION_DOWN</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3959</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3960</span> </span><span class="WHIT">					</span><span class="NAME">this.swipeDirection</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture.SWIPE_DIRECTION_UP</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3961</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3962</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3963</span> </span><span class="WHIT">				</span><span class="NAME">this.dispatch</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture.SWIPE_EVENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3964</span> </span><span class="WHIT">				</span><span class="NAME">this.touchable.destroyGesture</span><span class="PUNC">(</span><span class="NAME">this.fingerID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3965</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3966</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3967</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3968</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3969</span> 			Long tap timeout handler function. Dispatches {@link XF.TouchGesture.LONG_TAP_EVENT}
<span class='line'>3970</span> 			@param {Object} newPosition New finger coordinates
<span class='line'>3971</span> 			@private
<span class='line'>3972</span> 		*/</span><span class="WHIT">
<span class='line'>3973</span> </span><span class="WHIT">		</span><span class="NAME">longTouchHandlerF</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3974</span> </span><span class="WHIT">			</span><span class="NAME">this.dispatch</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture.LONG_TAP_EVENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3975</span> </span><span class="WHIT">			</span><span class="NAME">this.longTouchDispatched</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3976</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3977</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>3978</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>3979</span> 			Calculate everything related to touchend
<span class='line'>3980</span> 			@private
<span class='line'>3981</span> 		*/</span><span class="WHIT">
<span class='line'>3982</span> </span><span class="WHIT">		</span><span class="NAME">release</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3983</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.gestureComplete</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3984</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.longTouchDispatched</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3985</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3986</span> </span><span class="WHIT">					</span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.longTouchTimeout</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3987</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>3988</span> </span><span class="WHIT">					</span><span class="NAME">this.dispatch</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture.TAP_EVENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3989</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>3990</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.touchable.lastTapTimestamp</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.touchable.options.doubleTapInterval</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture.getTimeStamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3991</span> </span><span class="WHIT">						</span><span class="NAME">this.dispatch</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture.DOUBLE_TAP_EVENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3992</span> </span><span class="WHIT">						</span><span class="NAME">this.touchable.lastTapTimestamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3993</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3994</span> </span><span class="WHIT">						</span><span class="NAME">this.touchable.lastTapTimestamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture.getTimeStamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3995</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3996</span> </span><span class="WHIT">					</span><span class="WHIT">
<span class='line'>3997</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3998</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3999</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4000</span> </span><span class="WHIT">			</span><span class="NAME">this.gestureComplete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4001</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4002</span> </span><span class="WHIT">			</span><span class="NAME">this.dispatch</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture.TOUCH_END_EVENT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4003</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4004</span> </span><span class="WHIT">			</span><span class="NAME">this.touchable.destroyGesture</span><span class="PUNC">(</span><span class="NAME">this.fingerID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4005</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4006</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4007</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4008</span> 			Dispatches an event passing this {@link XF.TouchGesture} instance as second parameter
<span class='line'>4009</span> 			@param {String} eventName Name of event to be dispatched
<span class='line'>4010</span> 			@private
<span class='line'>4011</span> 		*/</span><span class="WHIT">
<span class='line'>4012</span> </span><span class="WHIT">		</span><span class="NAME">dispatch</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4013</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.TouchGesture :: dispatch - '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">eventName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' ('</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.fingerID</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">')'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4014</span> </span><span class="WHIT">			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">this.touchable.elem</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">trigger</span><span class="PUNC">(</span><span class="NAME">eventName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4015</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4016</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4017</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4018</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.TouchGesture</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.TouchGesture */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4019</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4020</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4021</span> 			Touch Event name (use this static property instead of direct string for better compatibility)
<span class='line'>4022</span> 			@type Sting
<span class='line'>4023</span> 			@static
<span class='line'>4024</span> 		*/</span><span class="WHIT">
<span class='line'>4025</span> </span><span class="WHIT">		</span><span class="NAME">TOUCH_START_EVENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'TOUCH_START'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4026</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4027</span> 			Touch Event name (use this static property instead of direct string for better compatibility)
<span class='line'>4028</span> 			@type Sting
<span class='line'>4029</span> 			@static
<span class='line'>4030</span> 		*/</span><span class="WHIT">
<span class='line'>4031</span> </span><span class="WHIT">		</span><span class="NAME">TOUCH_MOVE_EVENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'TOUCH_MOVE'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4032</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4033</span> 			Touch Event name (use this static property instead of direct string for better compatibility)
<span class='line'>4034</span> 			@type Sting
<span class='line'>4035</span> 			@static
<span class='line'>4036</span> 		*/</span><span class="WHIT">
<span class='line'>4037</span> </span><span class="WHIT">		</span><span class="NAME">TOUCH_END_EVENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'TOUCH_END'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4038</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4039</span> 			Gesture Event name (use this static property instead of direct string for better compatibility)
<span class='line'>4040</span> 			@type Sting
<span class='line'>4041</span> 			@static
<span class='line'>4042</span> 		*/</span><span class="WHIT">
<span class='line'>4043</span> </span><span class="WHIT">		</span><span class="NAME">TAP_EVENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'TAP'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4044</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4045</span> 			Gesture Event name (use this static property instead of direct string for better compatibility)
<span class='line'>4046</span> 			@type Sting
<span class='line'>4047</span> 			@static
<span class='line'>4048</span> 		*/</span><span class="WHIT">
<span class='line'>4049</span> </span><span class="WHIT">		</span><span class="NAME">SWIPE_EVENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'SWIPE'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4050</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4051</span> 			Gesture Event name (use this static property instead of direct string for better compatibility)
<span class='line'>4052</span> 			@type Sting
<span class='line'>4053</span> 			@static
<span class='line'>4054</span> 		*/</span><span class="WHIT">
<span class='line'>4055</span> </span><span class="WHIT">		</span><span class="NAME">LONG_TAP_EVENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'LONG_TAP'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4056</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4057</span> 			Gesture Event name (use this static property instead of direct string for better compatibility)
<span class='line'>4058</span> 			@type Sting
<span class='line'>4059</span> 			@static
<span class='line'>4060</span> 		*/</span><span class="WHIT">
<span class='line'>4061</span> </span><span class="WHIT">		</span><span class="NAME">DOUBLE_TAP_EVENT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'DOUBLE_TAP'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4062</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4063</span> 			Unique indentifier for Swipe direction gesture (use this static property instead of direct string for better compatibility)
<span class='line'>4064</span> 			@type Sting
<span class='line'>4065</span> 			@static
<span class='line'>4066</span> 		*/</span><span class="WHIT">
<span class='line'>4067</span> </span><span class="WHIT">		</span><span class="NAME">SWIPE_DIRECTION_LEFT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'LEFT'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4068</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4069</span> 			Unique indentifier for Swipe direction gesture (use this static property instead of direct string for better compatibility)
<span class='line'>4070</span> 			@type Sting
<span class='line'>4071</span> 			@static
<span class='line'>4072</span> 		*/</span><span class="WHIT">
<span class='line'>4073</span> </span><span class="WHIT">		</span><span class="NAME">SWIPE_DIRECTION_RIGHT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'RIGHT'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4074</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4075</span> 			Unique indentifier for Swipe direction gesture (use this static property instead of direct string for better compatibility)
<span class='line'>4076</span> 			@type Sting
<span class='line'>4077</span> 			@static
<span class='line'>4078</span> 		*/</span><span class="WHIT">
<span class='line'>4079</span> </span><span class="WHIT">		</span><span class="NAME">SWIPE_DIRECTION_UP</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'UP'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4080</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4081</span> 			Unique indentifier for Swipe direction gesture (use this static property instead of direct string for better compatibility)
<span class='line'>4082</span> 			@type Sting
<span class='line'>4083</span> 			@static
<span class='line'>4084</span> 		*/</span><span class="WHIT">
<span class='line'>4085</span> </span><span class="WHIT">		</span><span class="NAME">SWIPE_DIRECTION_DOWN</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'DOWN'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4086</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4087</span> 			Returns current timestamp in milliseconds
<span class='line'>4088</span> 			@return {Number}
<span class='line'>4089</span> 			@static
<span class='line'>4090</span> 		*/</span><span class="WHIT">
<span class='line'>4091</span> </span><span class="WHIT">		</span><span class="NAME">getTimeStamp</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4092</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4093</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4094</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4095</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4096</span> 
<span class='line'>4097</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>4098</span> 		Incapsulates one finger workaround logic.
<span class='line'>4099</span> 		@class
<span class='line'>4100</span> 		@static
<span class='line'>4101</span> 		@param {Object} elem Reference to the target DOM element
<span class='line'>4102</span> 		@param {Object} options Hash-map with custom instance options
<span class='line'>4103</span> 	*/</span><span class="WHIT">
<span class='line'>4104</span> </span><span class="WHIT">	</span><span class="NAME">XF.Touchable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4105</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4106</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4107</span> 			Reference to the target DOM element
<span class='line'>4108</span> 			@type Object
<span class='line'>4109</span> 			@private
<span class='line'>4110</span> 		*/</span><span class="WHIT">
<span class='line'>4111</span> </span><span class="WHIT">		</span><span class="NAME">this.elem</span><span class="PUNC">=</span><span class="NAME">elem</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4112</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4113</span> 			Reference to the jQuery element
<span class='line'>4114</span> 			@type Object
<span class='line'>4115</span> 			@private
<span class='line'>4116</span> 		*/</span><span class="WHIT">
<span class='line'>4117</span> </span><span class="WHIT">		</span><span class="NAME">this.$elem</span><span class="PUNC">=</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4118</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4119</span> </span><span class="WHIT">		</span><span class="COMM">// merging custom options with defauls & global opnes</span><span class="WHIT">
<span class='line'>4120</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4121</span> </span><span class="WHIT">			</span><span class="NAME">this.options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.clone</span><span class="PUNC">(</span><span class="NAME">options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4122</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4123</span> </span><span class="WHIT">			</span><span class="NAME">this.options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4124</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4125</span> </span><span class="WHIT">		</span><span class="NAME">_.defaults</span><span class="PUNC">(</span><span class="NAME">this.options</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4126</span> </span><span class="WHIT">			</span><span class="NAME">swipeLength</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'touchableSwipeLength'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4127</span> </span><span class="WHIT">			</span><span class="NAME">doubleTapInterval</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'touchableDoubleTapInterval'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4128</span> </span><span class="WHIT">			</span><span class="NAME">longTapInterval</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">XF.Settings.property</span><span class="PUNC">(</span><span class="STRN">'touchableLongTapInterval'</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>4129</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4130</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4131</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4132</span> 			Hash-map of all gestures currently being tracked
<span class='line'>4133</span> 			@type Object
<span class='line'>4134</span> 			@private
<span class='line'>4135</span> 		*/</span><span class="WHIT">
<span class='line'>4136</span> </span><span class="WHIT">		</span><span class="NAME">this.gestures</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4137</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4138</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4139</span> 			Stores last tap timestamp, witch is used to detect {@link XF.TouchGesture.DOUBLE_TAP_EVENT}
<span class='line'>4140</span> 			@type Number
<span class='line'>4141</span> 			@private
<span class='line'>4142</span> 		*/</span><span class="WHIT">
<span class='line'>4143</span> </span><span class="WHIT">		</span><span class="NAME">this.lastTapTimestamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4144</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4145</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4146</span> 			'touchstart' handler bind to {@link XF.Touchable} context
<span class='line'>4147</span> 			@type Function
<span class='line'>4148</span> 			@private
<span class='line'>4149</span> 		*/</span><span class="WHIT">
<span class='line'>4150</span> </span><span class="WHIT">		</span><span class="NAME">this.touchstart</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="NAME">this.touchstartF</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4151</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4152</span> 			'touchmove' handler bind to {@link XF.Touchable} context
<span class='line'>4153</span> 			@type Function
<span class='line'>4154</span> 			@private
<span class='line'>4155</span> 		*/</span><span class="WHIT">
<span class='line'>4156</span> </span><span class="WHIT">		</span><span class="NAME">this.touchmove</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="NAME">this.touchmoveF</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4157</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4158</span> 			'touchend' handler bind to {@link XF.Touchable} context
<span class='line'>4159</span> 			@type Function
<span class='line'>4160</span> 			@private
<span class='line'>4161</span> 		*/</span><span class="WHIT">
<span class='line'>4162</span> </span><span class="WHIT">		</span><span class="NAME">this.touchend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_.bind</span><span class="PUNC">(</span><span class="NAME">this.touchendF</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4163</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4164</span> </span><span class="WHIT">		</span><span class="COMM">// ading listeners for 'touchstart' & 'mousedown' events</span><span class="WHIT">
<span class='line'>4165</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.Device.isTouchable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4166</span> </span><span class="WHIT">			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'touchstart'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchstart</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4167</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4168</span> </span><span class="WHIT">			</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">elem</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchstart</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4169</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4170</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4171</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4172</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.Touchable.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.Touchable.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4173</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4174</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4175</span> 			Returns a {@link XF.TouchGesture} instance by finger indentifier
<span class='line'>4176</span> 			@param {String} fingerID Finger unique identifier
<span class='line'>4177</span> 			@return {XF.TouchGesture}
<span class='line'>4178</span> 		*/</span><span class="WHIT">
<span class='line'>4179</span> </span><span class="WHIT">		</span><span class="NAME">getGestureByID</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fingerID</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4180</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.gestures</span><span class="PUNC">[</span><span class="NAME">fingerID</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4181</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4182</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4183</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4184</span> 			Creates new {@link XF.TouchGesture} instance
<span class='line'>4185</span> 			@param {String} fingerID Finger unique identifier
<span class='line'>4186</span> 			@param {Object} startPosition Initial touch coordinates
<span class='line'>4187</span> 			@return {XF.TouchGesture}
<span class='line'>4188</span> 		*/</span><span class="WHIT">
<span class='line'>4189</span> </span><span class="WHIT">		</span><span class="NAME">createGesture</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fingerID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">startPosition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4190</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.gestures</span><span class="PUNC">[</span><span class="NAME">fingerID</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XF.TouchGesture</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fingerID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">startPosition</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4191</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4192</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4193</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4194</span> 			Destroys an instance of {@link XF.TouchGesture} by finger indentifier
<span class='line'>4195</span> 			@param {String} fingerID Finger unique identifier
<span class='line'>4196</span> 		*/</span><span class="WHIT">
<span class='line'>4197</span> </span><span class="WHIT">		</span><span class="NAME">destroyGesture</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fingerID</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4198</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4199</span> </span><span class="WHIT">			</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.gestures</span><span class="PUNC">[</span><span class="NAME">fingerID</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4200</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4201</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_.size</span><span class="PUNC">(</span><span class="NAME">this.gestures</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4202</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">XF.Device.isTouchable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4203</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">unbind</span><span class="PUNC">(</span><span class="STRN">'touchmove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchmove</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4204</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">unbind</span><span class="PUNC">(</span><span class="STRN">'touchend'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchend</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4205</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4206</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">unbind</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchmove</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4207</span> </span><span class="WHIT">					</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">unbind</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchend</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4208</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4209</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4210</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4211</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4212</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4213</span> 			'touchstart' handler
<span class='line'>4214</span> 			@param {Object} e Javascript event object
<span class='line'>4215</span> 			@private
<span class='line'>4216</span> 		*/</span><span class="WHIT">
<span class='line'>4217</span> </span><span class="WHIT">		</span><span class="NAME">touchstartF</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4218</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4219</span> </span><span class="WHIT">			</span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e.originalEvent</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4220</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4221</span> </span><span class="WHIT">			</span><span class="COMM">// touch device</span><span class="WHIT">
<span class='line'>4222</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.changedTouches</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4223</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4224</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4225</span> </span><span class="WHIT">				</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">e.changedTouches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">changedTouch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4226</span> </span><span class="WHIT">					</span><span class="NAME">self.createGesture</span><span class="PUNC">(</span><span class="NAME">changedTouch.identifier</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">changedTouch.clientX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">changedTouch.clientY</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4227</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4228</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4229</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'touchmove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchmove</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4230</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'touchend'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchend</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4231</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4232</span> </span><span class="WHIT">			</span><span class="COMM">// desktop</span><span class="WHIT">
<span class='line'>4233</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4234</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4235</span> </span><span class="WHIT">				</span><span class="NAME">this.createGesture</span><span class="PUNC">(</span><span class="STRN">'mouse'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.pageX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.pageY</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4236</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4237</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchmove</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4238</span> </span><span class="WHIT">				</span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bind</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.touchend</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4239</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4240</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4241</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4242</span> </span><span class="WHIT">			</span><span class="COMM">// NOTE: XF.Device.isTouchable should fix double click (real touch+mouse click) problem</span><span class="WHIT">
<span class='line'>4243</span> </span><span class="WHIT">			</span><span class="COMM">//e.preventDefault();</span><span class="WHIT">
<span class='line'>4244</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4245</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4246</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4247</span> 			'touchmove' handler
<span class='line'>4248</span> 			@param {Object} e Javascript event object
<span class='line'>4249</span> 			@private
<span class='line'>4250</span> 		*/</span><span class="WHIT">
<span class='line'>4251</span> </span><span class="WHIT">		</span><span class="NAME">touchmoveF</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4252</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4253</span> </span><span class="WHIT">			</span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e.originalEvent</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4254</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4255</span> </span><span class="WHIT">			</span><span class="COMM">// touch device</span><span class="WHIT">
<span class='line'>4256</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.changedTouches</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4257</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4258</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4259</span> </span><span class="WHIT">				</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">e.changedTouches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">changedTouch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4260</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gesture</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">self.getGestureByID</span><span class="PUNC">(</span><span class="NAME">changedTouch.identifier</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4261</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">gesture</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4262</span> </span><span class="WHIT">						</span><span class="NAME">gesture.move</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">changedTouch.clientX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">changedTouch.clientY</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4263</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4264</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4265</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4266</span> </span><span class="WHIT">			</span><span class="COMM">// desktop</span><span class="WHIT">
<span class='line'>4267</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4268</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4269</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gesture</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getGestureByID</span><span class="PUNC">(</span><span class="STRN">'mouse'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4270</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">gesture</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4271</span> </span><span class="WHIT">					</span><span class="NAME">gesture.move</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.pageX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">e.pageY</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4272</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4273</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4274</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4275</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4276</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4277</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4278</span> 			'touchend' handler
<span class='line'>4279</span> 			@param {Object} e Javascript event object
<span class='line'>4280</span> 			@private
<span class='line'>4281</span> 		*/</span><span class="WHIT">
<span class='line'>4282</span> </span><span class="WHIT">		</span><span class="NAME">touchendF</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4283</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4284</span> </span><span class="WHIT">			</span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e.originalEvent</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4285</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4286</span> </span><span class="WHIT">			</span><span class="COMM">// touch device</span><span class="WHIT">
<span class='line'>4287</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">e.changedTouches</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4288</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4289</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4290</span> </span><span class="WHIT">				</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">e.changedTouches</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">changedTouch</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4291</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gesture</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">self.getGestureByID</span><span class="PUNC">(</span><span class="NAME">changedTouch.identifier</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4292</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">gesture</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4293</span> </span><span class="WHIT">						</span><span class="NAME">gesture.release</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4294</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4295</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4296</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4297</span> </span><span class="WHIT">			</span><span class="COMM">// desktop</span><span class="WHIT">
<span class='line'>4298</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4299</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4300</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">gesture</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getGestureByID</span><span class="PUNC">(</span><span class="STRN">'mouse'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4301</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">gesture</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4302</span> </span><span class="WHIT">					</span><span class="NAME">gesture.release</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4303</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4304</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4305</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4306</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4307</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4308</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4309</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4310</span> </span><span class="WHIT">	</span><span class="COMM">/////////////////////////////////////////////////////////////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>4311</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4312</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>4313</span> 		Instance of {@link XF.DeviceClass}
<span class='line'>4314</span> 		@static
<span class='line'>4315</span> 		@private
<span class='line'>4316</span> 		@type {XF.DeviceClass}
<span class='line'>4317</span> 	*/</span><span class="WHIT">
<span class='line'>4318</span> </span><span class="WHIT">	</span><span class="NAME">XF.Device</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4319</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4320</span> </span><span class="WHIT">	</span><span class="COMM">/**
<span class='line'>4321</span> 		Represents some basic testing/verification api letting you know what device the app is started on.
<span class='line'>4322</span> 		@class
<span class='line'>4323</span> 		@static
<span class='line'>4324</span> 	*/</span><span class="WHIT">
<span class='line'>4325</span> </span><span class="WHIT">	</span><span class="NAME">XF.DeviceClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4326</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4327</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4328</span> 			Contains device viewport size: {width; height}
<span class='line'>4329</span> 			@type Object
<span class='line'>4330</span> 		*/</span><span class="WHIT">
<span class='line'>4331</span> </span><span class="WHIT">		</span><span class="NAME">this.size</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4332</span> </span><span class="WHIT">			</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4333</span> </span><span class="WHIT">			</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT">
<span class='line'>4334</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4335</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4336</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4337</span> 			Array of device types to be chosen from (can be set via {@link XF.start} options)
<span class='line'>4338</span> 			@type Object
<span class='line'>4339</span> 			@private
<span class='line'>4340</span> 		*/</span><span class="WHIT">
<span class='line'>4341</span> </span><span class="WHIT">		</span><span class="NAME">this.types</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span class='line'>4342</span> </span><span class="WHIT">			</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4343</span> </span><span class="WHIT">				</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'desktop'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4344</span> </span><span class="WHIT">				</span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4345</span> </span><span class="WHIT">					</span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4346</span> </span><span class="WHIT">					</span><span class="NAME">min</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1024</span><span class="WHIT">
<span class='line'>4347</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4348</span> </span><span class="WHIT">				</span><span class="NAME">templatePath</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'desktop/'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4349</span> </span><span class="WHIT">				</span><span class="NAME">fallBackTo</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tablet'</span><span class="WHIT">
<span class='line'>4350</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4351</span> </span><span class="WHIT">				</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tablet'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4352</span> </span><span class="WHIT">				</span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4353</span> </span><span class="WHIT">					</span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1024</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4354</span> </span><span class="WHIT">					</span><span class="NAME">min</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">480</span><span class="WHIT">
<span class='line'>4355</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4356</span> </span><span class="WHIT">				</span><span class="NAME">templatePath</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tablet/'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4357</span> </span><span class="WHIT">				</span><span class="NAME">fallBackTo</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'mobile'</span><span class="WHIT">
<span class='line'>4358</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4359</span> </span><span class="WHIT">				</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'mobile'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4360</span> </span><span class="WHIT">				</span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4361</span> </span><span class="WHIT">					</span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">480</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4362</span> </span><span class="WHIT">					</span><span class="NAME">min</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT">
<span class='line'>4363</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4364</span> </span><span class="WHIT">				</span><span class="NAME">templatePath</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'mobile/'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4365</span> </span><span class="WHIT">				</span><span class="NAME">fallBackTo</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'default'</span><span class="WHIT">
<span class='line'>4366</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4367</span> </span><span class="WHIT">		</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4368</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4369</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4370</span> 			Default device type that would be used when none other worked (covers all the viewport sizes)
<span class='line'>4371</span> 			@type Object
<span class='line'>4372</span> 			@private
<span class='line'>4373</span> 		*/</span><span class="WHIT">
<span class='line'>4374</span> </span><span class="WHIT">		</span><span class="NAME">this.defaultType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4375</span> </span><span class="WHIT">			</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'default'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4376</span> </span><span class="WHIT">			</span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4377</span> </span><span class="WHIT">				</span><span class="NAME">min</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4378</span> </span><span class="WHIT">				</span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT">
<span class='line'>4379</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4380</span> </span><span class="WHIT">			</span><span class="NAME">templatePath</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4381</span> </span><span class="WHIT">			</span><span class="NAME">fallBackTo</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT">
<span class='line'>4382</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4383</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4384</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4385</span> 			Detected device type that would be used to define template path
<span class='line'>4386</span> 			@type Object
<span class='line'>4387</span> 			@private
<span class='line'>4388</span> 		*/</span><span class="WHIT">
<span class='line'>4389</span> </span><span class="WHIT">		</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.defaultType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4390</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4391</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4392</span> 			A flag indicates whether the device is supporting Touch events or not
<span class='line'>4393</span> 			@type Boolean
<span class='line'>4394</span> 		*/</span><span class="WHIT">
<span class='line'>4395</span> </span><span class="WHIT">		</span><span class="NAME">this.isTouchable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4396</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4397</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4398</span> </span><span class="WHIT">	</span><span class="NAME">_.extend</span><span class="PUNC">(</span><span class="NAME">XF.DeviceClass.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">/** @lends XF.DeviceClass.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4399</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4400</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4401</span> 			Initializes {@link XF.Device} instance (runs detection methods)
<span class='line'>4402</span> 			@param {Array} types rray of device types to be choosen from
<span class='line'>4403</span> 		*/</span><span class="WHIT">
<span class='line'>4404</span> </span><span class="WHIT">		</span><span class="NAME">init</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">types</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4405</span> </span><span class="WHIT">			</span><span class="NAME">this.types</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">types</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.types</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4406</span> </span><span class="WHIT">			</span><span class="NAME">this.detectType</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4407</span> </span><span class="WHIT">			</span><span class="NAME">this.detectTouchable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4408</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4409</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4410</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4411</span> 			Detectes device type (basicaly, chooses most applicable type from the {@link XF.DeviceClass#types} list)
<span class='line'>4412</span> 			@private
<span class='line'>4413</span> 		*/</span><span class="WHIT">
<span class='line'>4414</span> </span><span class="WHIT">		</span><span class="NAME">detectType</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4415</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4416</span> </span><span class="WHIT">			</span><span class="NAME">this.size.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4417</span> </span><span class="WHIT">			</span><span class="NAME">this.size.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4418</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4419</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - width = "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.size.width</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4420</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - height = "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.size.height</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4421</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4422</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">maxSide</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this.size.width</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.size.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4423</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4424</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - maxSide = "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">maxSide</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4425</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4426</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4427</span> </span><span class="WHIT">			</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">this.types</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4428</span> </span><span class="WHIT">				</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4429</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>4430</span> </span><span class="WHIT">						</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">type.range.min</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type.range.min</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">maxSide</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">type.range.min</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>4431</span> </span><span class="WHIT">						</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">type.range.max</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type.range.max</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">maxSide</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">type.range.max</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>4432</span> </span><span class="WHIT">					</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4433</span> </span><span class="WHIT">						</span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4434</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4435</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4436</span> </span><span class="WHIT">					</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - bad type detected - skipping'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4437</span> </span><span class="WHIT">					</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - @dev: plz verify types list'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4438</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4439</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4440</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4441</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">res</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4442</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4443</span> </span><span class="WHIT">				</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4444</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4445</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4446</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4447</span> </span><span class="WHIT">				</span><span class="NAME">this.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.defaultType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4448</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4449</span> </span><span class="WHIT">				</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - could not choose any of device type'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4450</span> </span><span class="WHIT">				</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - drop back to this.defaultType'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4451</span> </span><span class="WHIT">				</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - @dev: plz verify types list'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4452</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4453</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4454</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: detectType - selected type "'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.type.name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4455</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4456</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4457</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4458</span> 			Chooses the next applicable type in case when previous one's templatePath could not be loaded
<span class='line'>4459</span> 			@param {Object} fallBackFrom If passed, the return type would be taken as dropDown from it (optional) 
<span class='line'>4460</span> 			@return {Object} Device type
<span class='line'>4461</span> 		*/</span><span class="WHIT">
<span class='line'>4462</span> </span><span class="WHIT">		</span><span class="NAME">getNextType</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fallBackFrom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4463</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">aimType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.type</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4464</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fallBackFrom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4465</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fallBackFrom.fallBackTo</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4466</span> </span><span class="WHIT">					</span><span class="NAME">aimType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getTypeByName</span><span class="PUNC">(</span><span class="NAME">fallBackFrom.fallBackTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4467</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4468</span> </span><span class="WHIT">					</span><span class="NAME">aimType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.defaultType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4469</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4470</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4471</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4472</span> </span><span class="WHIT">			</span><span class="COMM">// just checking if type is ok</span><span class="WHIT">
<span class='line'>4473</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aimType</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">aimType.templatePath</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4474</span> </span><span class="WHIT">				</span><span class="COMM">// type is ok</span><span class="WHIT">
<span class='line'>4475</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4476</span> </span><span class="WHIT">				</span><span class="NAME">aimType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.defaultType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4477</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4478</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4479</span> </span><span class="WHIT">			</span><span class="COMM">// prevent looping the same type again & again</span><span class="WHIT">
<span class='line'>4480</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aimType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">fallBackFrom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4481</span> </span><span class="WHIT">				</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: getNextType - infinit cycle of drop down logic detected'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4482</span> </span><span class="WHIT">				</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: getNextType - stop trying, no template is available'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4483</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4484</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4485</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4486</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aimType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4487</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4488</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4489</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4490</span> 			Chooses device type by ot's name
<span class='line'>4491</span> 			@param {String} typeName Value of 'name' property of the type that should be returnd
<span class='line'>4492</span> 			@return {Object} Device type
<span class='line'>4493</span> 		*/</span><span class="WHIT">
<span class='line'>4494</span> </span><span class="WHIT">		</span><span class="NAME">getTypeByName</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4495</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4496</span> </span><span class="WHIT">			</span><span class="NAME">_.each</span><span class="PUNC">(</span><span class="NAME">this.types</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4497</span> </span><span class="WHIT">				</span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4498</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">type.name</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">typeName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4499</span> </span><span class="WHIT">						</span><span class="NAME">res</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4500</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4501</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4502</span> </span><span class="WHIT">					</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: getTypeByName - bad type name - skipping'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4503</span> </span><span class="WHIT">					</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.DeviceClass :: getTypeByName - @dev: plz verify types list'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4504</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4505</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4506</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4507</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">res</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4508</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4509</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4510</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4511</span> 			Detectes whether the device is supporting Touch events or not
<span class='line'>4512</span> 			@private
<span class='line'>4513</span> 		*/</span><span class="WHIT">
<span class='line'>4514</span> </span><span class="WHIT">		</span><span class="NAME">detectTouchable</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4515</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4516</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">prefixes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">' -webkit- -moz- -o- -ms- '</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4517</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'@media ('</span><span class="PUNC">,</span><span class="NAME">prefixes.join</span><span class="PUNC">(</span><span class="STRN">'touch-enabled),('</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">'app_device_test'</span><span class="PUNC">,</span><span class="STRN">')'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'{#touch{top:9px;position:absolute}}'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4518</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4519</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">$this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4520</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4521</span> </span><span class="WHIT">			</span><span class="NAME">this.injectElementWithStyles</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">node</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">rule</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4522</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.styleSheets</span><span class="PUNC">[</span><span class="NAME">document.styleSheets.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4523</span> </span><span class="WHIT">					</span><span class="COMM">// IE8 will bork if you create a custom build that excludes both fontface and generatedcontent tests.</span><span class="WHIT">
<span class='line'>4524</span> </span><span class="WHIT">					</span><span class="COMM">// So we check for cssRules and that there is a rule available</span><span class="WHIT">
<span class='line'>4525</span> </span><span class="WHIT">					</span><span class="COMM">// More here: github.com/Modernizr/Modernizr/issues/288 & github.com/Modernizr/Modernizr/issues/293</span><span class="WHIT">
<span class='line'>4526</span> </span><span class="WHIT">					</span><span class="NAME">cssText</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style.cssRules</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">style.cssRules</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">style.cssRules</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">cssText</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">style.cssText</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4527</span> </span><span class="WHIT">					</span><span class="NAME">children</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">node.childNodes</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4528</span> </span><span class="WHIT">					</span><span class="NAME">hashTouch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">children</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4529</span> </span><span class="WHIT">				</span><span class="WHIT">
<span class='line'>4530</span> </span><span class="WHIT">				</span><span class="NAME">$this.isTouchable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'ontouchstart'</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.DocumentTouch</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">document</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">DocumentTouch</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">hashTouch</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">hashTouch.offsetTop</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">9</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>4531</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4532</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'touch'</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4533</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4534</span> </span><span class="WHIT">			</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">'XF.Device :: detectTouchable - device IS '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isTouchable</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'NOT '</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'touchable'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4535</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4536</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4537</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4538</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4539</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4540</span> 			Inject element with style element and some CSS rules. Used for some detect* methods
<span class='line'>4541</span> 			@param String rule Node styles to be applied
<span class='line'>4542</span> 			@param Function callback Test validation Function
<span class='line'>4543</span> 			@param Number nodes Nodes Number
<span class='line'>4544</span> 			@param Array testnames Array with test names
<span class='line'>4545</span> 			@private
<span class='line'>4546</span> 		*/</span><span class="WHIT">
<span class='line'>4547</span> </span><span class="WHIT">		</span><span class="NAME">injectElementWithStyles</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">rule</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">nodes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">testnames</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4548</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4549</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">node</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4550</span> </span><span class="WHIT">				</span><span class="NAME">div</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4551</span> </span><span class="WHIT">				</span><span class="COMM">// After page load injecting a fake body doesn't work so check if body exists</span><span class="WHIT">
<span class='line'>4552</span> </span><span class="WHIT">				</span><span class="NAME">body</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span class='line'>4553</span> </span><span class="WHIT">				</span><span class="COMM">// IE6 and 7 won't return offsetWidth or offsetHeight unless it's in the body element, so we fake it.</span><span class="WHIT">
<span class='line'>4554</span> </span><span class="WHIT">				</span><span class="NAME">fakeBody</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">body</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">body</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'body'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4555</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4556</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">nodes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4557</span> </span><span class="WHIT">				</span><span class="COMM">// In order not to give false positives we create a node for each test</span><span class="WHIT">
<span class='line'>4558</span> </span><span class="WHIT">				</span><span class="COMM">// This also allows the method to scale for unspecified uses</span><span class="WHIT">
<span class='line'>4559</span> </span><span class="WHIT">				</span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nodes</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4560</span> </span><span class="WHIT">					</span><span class="NAME">node</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4561</span> </span><span class="WHIT">					</span><span class="NAME">node.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">testnames</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">testnames</span><span class="PUNC">[</span><span class="NAME">nodes</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'app_device_test'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nodes</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4562</span> </span><span class="WHIT">					</span><span class="NAME">div.appendChild</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4563</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4564</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4565</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4566</span> </span><span class="WHIT">			</span><span class="COMM">// &lt;style> elements in IE6-9 are considered 'NoScope' elements and therefore will be removed</span><span class="WHIT">
<span class='line'>4567</span> </span><span class="WHIT">			</span><span class="COMM">// when injected with innerHTML. To get around this you need to prepend the 'NoScope' element</span><span class="WHIT">
<span class='line'>4568</span> </span><span class="WHIT">			</span><span class="COMM">// with a 'scoped' element, in our case the soft-hyphen entity as it won't mess with our measurements.</span><span class="WHIT">
<span class='line'>4569</span> </span><span class="WHIT">			</span><span class="COMM">// msdn.microsoft.com/en-us/library/ms533897%28VS.85%29.aspx</span><span class="WHIT">
<span class='line'>4570</span> </span><span class="WHIT">			</span><span class="COMM">// Documents served as xml will throw if using &shy; so use xml friendly encoded version. See issue #277</span><span class="WHIT">
<span class='line'>4571</span> </span><span class="WHIT">			</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'&#173;'</span><span class="PUNC">,</span><span class="STRN">'&lt;style>'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">rule</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'&lt;/style>'</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4572</span> </span><span class="WHIT">			</span><span class="NAME">div.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'app_device_test'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4573</span> </span><span class="WHIT">			</span><span class="COMM">// IE6 will false positive on some tests due to the style element inside the test div somehow interfering offsetHeight, so insert it into body or fakebody.</span><span class="WHIT">
<span class='line'>4574</span> </span><span class="WHIT">			</span><span class="COMM">// Opera will act all quirky when injecting elements in documentElement when page is served as xml, needs fakebody too. #270</span><span class="WHIT">
<span class='line'>4575</span> </span><span class="WHIT">			</span><span class="NAME">fakeBody.innerHTML</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4576</span> </span><span class="WHIT">			</span><span class="NAME">fakeBody.appendChild</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4577</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">body</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4578</span> </span><span class="WHIT">				</span><span class="COMM">//avoid crashing IE8, if background image is used</span><span class="WHIT">
<span class='line'>4579</span> </span><span class="WHIT">				</span><span class="NAME">fakeBody.style.background</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4580</span> </span><span class="WHIT">				</span><span class="NAME">docElement.appendChild</span><span class="PUNC">(</span><span class="NAME">fakeBody</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4581</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4582</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4583</span> </span><span class="WHIT">			</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">rule</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4584</span> </span><span class="WHIT">			</span><span class="COMM">// If this is done after page load we don't want to remove the body so check if body exists</span><span class="WHIT">
<span class='line'>4585</span> </span><span class="WHIT">			</span><span class="PUNC">!</span><span class="NAME">body</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">fakeBody.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">fakeBody</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">div.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4586</span> </span><span class="WHIT">			</span><span class="WHIT">
<span class='line'>4587</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4588</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4589</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4590</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4591</span> 			Stores identifier for portrait orientation
<span class='line'>4592</span> 			@constant
<span class='line'>4593</span> 			@type String
<span class='line'>4594</span> 		*/</span><span class="WHIT">
<span class='line'>4595</span> </span><span class="WHIT">		</span><span class="NAME">ORIENTATION_PORTRAIT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'portrait'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4596</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4597</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4598</span> 			Stores identifier for landscape orientation
<span class='line'>4599</span> 			@constant
<span class='line'>4600</span> 			@type String
<span class='line'>4601</span> 		*/</span><span class="WHIT">
<span class='line'>4602</span> </span><span class="WHIT">		</span><span class="NAME">ORIENTATION_LANDSCAPE</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'landscape'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4603</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4604</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4605</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4606</span> 			Returns current orientation of the device (ORIENTATION_PORTRAIT | ORIENTATION_LANDSCAPE)
<span class='line'>4607</span> 			@return String
<span class='line'>4608</span> 		*/</span><span class="WHIT">
<span class='line'>4609</span> </span><span class="WHIT">		</span><span class="NAME">getOrientation</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4610</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">isPortrait</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.documentElement</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4611</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">$.support.orientation</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4612</span> </span><span class="WHIT">				</span><span class="NAME">isPortrait</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">portrait_map</span><span class="PUNC">[</span><span class="WHIT"> </span><span class="NAME">window.orientation</span><span class="WHIT"> </span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4613</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4614</span> </span><span class="WHIT">				</span><span class="NAME">isPortrait</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">elem.clientWidth</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">elem.clientHeight</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">1.1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4615</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4616</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">isPortrait</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ORIENTATION_PORTRAIT</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.ORIENTATION_LANDSCAPE</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4617</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4618</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4619</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4620</span> 			Returns current screen height
<span class='line'>4621</span> 			@return Number
<span class='line'>4622</span> 		*/</span><span class="WHIT">
<span class='line'>4623</span> </span><span class="WHIT">		</span><span class="NAME">getScreenHeight</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4624</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">orientation</span><span class="WHIT"> 	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getOrientation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4625</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">port</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">orientation</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">this.ORIENTATION_PORTRAIT</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4626</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT">	</span><span class="NAME">winMin</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">port</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">480</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">320</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4627</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT">	</span><span class="NAME">screenHeight</span><span class="WHIT">	</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">port</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">screen.availHeight</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">screen.availWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4628</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT">	</span><span class="NAME">winHeight</span><span class="WHIT">		</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">winMin</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">window</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4629</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT">	</span><span class="NAME">pageMin</span><span class="WHIT">			</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">screenHeight</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">winHeight</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4630</span> 
<span class='line'>4631</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">pageMin</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4632</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4633</span> </span><span class="WHIT">		</span><span class="WHIT">
<span class='line'>4634</span> </span><span class="WHIT">		</span><span class="COMM">/**
<span class='line'>4635</span> 			Returns viewport jQuery object
<span class='line'>4636</span> 			@return JQuery
<span class='line'>4637</span> 		*/</span><span class="WHIT">
<span class='line'>4638</span> </span><span class="WHIT">		</span><span class="NAME">getViewport</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4639</span> </span><span class="WHIT">            </span><span class="COMM">// if there's no explicit viewport make body the viewport</span><span class="WHIT">
<span class='line'>4640</span> </span><span class="WHIT">            </span><span class="COMM">//var vp = $('.xf-viewport, .viewport') ;</span><span class="WHIT">
<span class='line'>4641</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">vp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'body'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addClass</span><span class="PUNC">(</span><span class="STRN">'xf-viewport'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4642</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">vp</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4643</span> </span><span class="WHIT">                </span><span class="NAME">vp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'.xf-page'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">eq</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4644</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">vp.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4645</span> </span><span class="WHIT">                    </span><span class="NAME">vp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'body'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4646</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4647</span> </span><span class="WHIT">                    </span><span class="NAME">vp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">vp.parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4648</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4649</span> </span><span class="WHIT">                </span><span class="NAME">vp.addClass</span><span class="PUNC">(</span><span class="STRN">'xf-viewport'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4650</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4651</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">vp.eq</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>4652</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4653</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4654</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4655</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4656</span> </span><span class="WHIT">	</span><span class="COMM">// TBDeleted : temp stuff for testApp.html</span><span class="WHIT">
<span class='line'>4657</span> </span><span class="WHIT">	</span><span class="NAME">XF.trace</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">message</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4658</span> </span><span class="WHIT">		</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'#tracer'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'&lt;br/>'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'#tracer'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">html</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4659</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4660</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4661</span> </span><span class="WHIT">	</span><span class="NAME">window.XF</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">XF</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4662</span> </span><span class="WHIT">	</span><span class="WHIT">
<span class='line'>4663</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">;</span></pre></body></html>